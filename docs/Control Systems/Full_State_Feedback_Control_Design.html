<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Optimal LQR control for drone landing using MATLAB, emphasizing strategic pole placement for precise descent">

<title>Portfolio - Full State Feedback Control Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/NB_logo.webp" rel="icon">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 10,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Portfolio - Full State Feedback Control Design">
<meta property="og:description" content="Optimal LQR control for drone landing using MATLAB, emphasizing strategic pole placement for precise descent">
<meta property="og:image" content="https://www.nishantkb.info/Control Systems/Simulation_animation.gif">
<meta property="og:site-name" content="Nishant Bharali's Portfolio">
<meta name="twitter:title" content="Portfolio - Full State Feedback Control Design">
<meta name="twitter:description" content="Optimal LQR control for drone landing using MATLAB, emphasizing strategic pole placement for precise descent">
<meta name="twitter:image" content="https://www.nishantkb.info/Control Systems/images/Nishant.jpg">
<meta name="twitter:creator" content="@NishantBharali">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="../blog.html" rel="" target="">
 <span class="dropdown-text">Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../control_systems.html" rel="" target="">
 <span class="dropdown-text">Control Systems</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../robotics.html" rel="" target="">
 <span class="dropdown-text">Robotics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../Vision.html" rel="" target="">
 <span class="dropdown-text">Machine Vision</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link active" href="../about.html" rel="" target="" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Work_Experience.html" rel="" target="">
 <span class="menu-text">Work Experience</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-resources" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Resources</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-resources">    
        <li>
    <a class="dropdown-item" href="../resources.html" rel="" target="">
 <span class="dropdown-text">My Recommendations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://drive.google.com/file/d/1TjYOeJ2PO4z16hSjQkF8PNFojcGU9IYz/view" rel="" target="_blank">
 <span class="dropdown-text">Modern Robotics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://drive.google.com/file/d/1lkGRqrfiMyiOY6Ct4ihws7DEymHVjtjC/view" rel="" target="_blank">
 <span class="dropdown-text">Robot Modelling and Control</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://r4ds.hadley.nz/" rel="" target="_blank">
 <span class="dropdown-text">Python for Data Science</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-contact" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Contact</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-contact">    
        <li>
    <a class="dropdown-item" href="https://www.linkedin.com/in/nishant-kumar-bharali/" rel="" target="_blank"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="dropdown-text">LinkedIn</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/NishantBharali" rel="" target="_blank"><i class="bi bi-github" role="img">
</i> 
 <span class="dropdown-text">GitHub</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://stackoverflow.com/users/18371927/nishant" rel="" target="_blank"><i class="bi bi-stack-overflow" role="img">
</i> 
 <span class="dropdown-text">Stack Overflow</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="mailto:nishantkb@vt.edu" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="dropdown-text">Gmail</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../cv/cv.html" rel="" target=""><i class="bi bi-file-earmark-person-fill" role="img">
</i> 
 <span class="dropdown-text">Curriculum Vitae</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Projects.html">Projects</a></li><li class="breadcrumb-item"><a href="../control_systems.html#category=Control">Control System</a></li><li class="breadcrumb-item"><a href="../Control Systems/Full_State_Feedback_Control_Design.html">Control Design</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../Projects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../robotics.html#category=Robotics" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Robotics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Robotics/Inverse_kinematics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inverse Kinematics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Robotics/Potential_trajectory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trajectory Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Robotics/Dynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dynamics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Robotics/Control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Robotics/RRT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RRT</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../control_systems.html#category=Control" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Control System</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Control Systems/Full_State_Feedback_Control_Design.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Control Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Control Systems/Linearized_LTI_Modeling_Feedback_Control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LTI Modeling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Control Systems/Bode_freqresp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bode Estimation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../blog.html#category=Machine Learning" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/Random Processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/Linear and Non Linear Regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/Clustering/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/Classification/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/Anomaly-Outlier Detection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anamoly</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../Vision.html#category=Vision" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine Vision</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../CV_Project/CV_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fire Detection</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About Me</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../tool.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tools</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Tools/git/git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Git</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Tools/quarto/quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">My Recommendations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://drive.google.com/file/d/1TjYOeJ2PO4z16hSjQkF8PNFojcGU9IYz/view" class="sidebar-item-text sidebar-link" target="&quot;_blank&quot;">
 <span class="menu-text">Modern Robotics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://drive.google.com/file/d/1lkGRqrfiMyiOY6Ct4ihws7DEymHVjtjC/view" class="sidebar-item-text sidebar-link" target="&quot;_blank&quot;">
 <span class="menu-text">Robot Modelling and Control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://r4ds.hadley.nz/" class="sidebar-item-text sidebar-link" target="&quot;_blank&quot;">
 <span class="menu-text">Python for Data Science</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Full State Feedback Control Design</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Control</div>
  </div>
  </div>

<div>
  <div class="description">
    Optimal LQR control for drone landing using MATLAB, emphasizing strategic pole placement for precise descent
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="me5554aoe5754ece5754-applied-linear-systems---project-ii" class="level1">
<h1><span style="color:rgb(213,80,0)">ME5554/AOE5754/ECE5754 Applied Linear Systems - Project II</span></h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">clear</span><span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="fl">0</span><span class="op">,</span><span class="ss">'defaultlinelinewidth'</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="va">format</span> <span class="va">short</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="va">sympref</span>(<span class="ss">'FloatingPointOutput'</span><span class="op">,</span><span class="va">true</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="case-1.-prepare-the-open-loop-plant" class="level1">
<h1>CASE 1. Prepare the Open-Loop Plant</h1>
<p>The state-space LTI object we developed in the Project I for the open-loop plant should have been saved in a .mat file.</p>
<p><br></p>
<p>Note: Before we proceed with the implementation, one should be responsible for correcting any errors they have in their open-loop plant! In this case, the plant is provided in my GitHub. One should NOT regenerate the open-loop LTI state-space plant in this LiveScript!!! The open-loop plant MUST be loaded from a .mat file (created in ME5554/AOE5754/ECE5754 Applied Linear Systems - Project I - Linearized LTI Modeling Feedback Control) to avoid discrepancies.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="va">load</span>(<span class="st">"MP_nishant_ss_model.mat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>After loading the .mat file, display the open-loop numerical state-space model. This model MUST display appropriately chosen statenames, inputnames (ok to use defaults here), and outputnames.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="va">OL_sys</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>OL_sys =
 
  A = 
                   X Position    X Velocity    Y Position    Y Velocity  Angular Posi  Angular Velo
   X Position               0             1             0             0             0             0
   X Velocity               0            -1             0             0         -9.81             0
   Y Position               0             0             0             1             0             0
   Y Velocity               0             0             0            -3             0             0
   Angular Posi             0             0             0             0             0             1
   Angular Velo             0             0             0             0             0          -1.6
 
  B = 
                 Varitional F  Varitional F
   X Position               0             0
   X Velocity               0             0
   Y Position               0             0
   Y Velocity             0.1           0.1
   Angular Posi             0             0
   Angular Velo        0.1302       -0.0898
 
  C = 
                   X Position    X Velocity    Y Position    Y Velocity  Angular Posi  Angular Velo
   X Position               1             0             0             0             0             0
   Y Position               0             0             1             0             0             0
   Angular Posi             0             0             0             0             1             0
 
  D = 
                 Varitional F  Varitional F
   X Position               0             0
   Y Position               0             0
   Angular Posi             0             0
 
Continuous-time state-space model.
Model Properties</code></pre>
<p>Next, extract the Aol, Bol, Col, and Dol matrices, but do not display these results (because we already displayed them in the previous step).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="va">Aol</span> <span class="op">=</span> <span class="va">OL_sys</span>.<span class="va">A</span><span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="va">Bol</span> <span class="op">=</span> <span class="va">OL_sys</span>.<span class="va">B</span><span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="va">Col</span> <span class="op">=</span> <span class="va">OL_sys</span>.<span class="va">C</span><span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="va">Dol</span> <span class="op">=</span> <span class="va">OL_sys</span>.<span class="va">D</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Compute the open-loop eigenvalues (ol_poles), and the system dimensions (N, M, P). Assign these quantities to variables for use later in the LiveScript, but do not display them here.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="va">ol_poles</span> <span class="op">=</span> <span class="va">eig</span>(<span class="va">Aol</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ol_poles = 6x1    
         0
   -1.0000
         0
   -3.0000
         0
   -1.6000</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="va">N</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">Aol</span><span class="op">,</span><span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>N = 6</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="va">M</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">Bol</span><span class="op">,</span><span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>M = 2</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="va">P</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">Col</span><span class="op">,</span><span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>P = 3</code></pre>
</section>
<section id="case-2.-simulate-closed-loop-control" class="level1">
<h1>CASE 2. Simulate Closed-Loop Control</h1>
<p>We are given the following set of desired closed-loop poles which are known to result in 5% settling times (transient times) that are less than 3 seconds without saturating any of the control signals.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="va">cl_poles</span> <span class="op">=</span> [</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">29</span> <span class="op">+</span> <span class="fl">15i</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">29</span> <span class="op">-</span> <span class="fl">15i</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">32</span> <span class="op">+</span> <span class="fl">0i</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">1.6</span> <span class="op">+</span> <span class="fl">0.76i</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">1.6</span> <span class="op">-</span> <span class="fl">0.76i</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">1.2</span> <span class="op">+</span> <span class="fl">0i</span>]<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Use the <code>PLACE</code> function to compute the full state feedback control gain matrix, and display our result.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="va">G</span> <span class="op">=</span> <span class="va">place</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Bol</span><span class="op">,</span><span class="va">cl_poles</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>G = 2x6    
1.0e+03 *

   -1.1332   -0.8551    0.0362    0.1151    4.2932    0.2707
    2.4067    1.7537    0.4483    0.1343   -8.6992   -0.3186</code></pre>
<p>Assume that the actual plant starts with the following initial conditions (NOTE: These are NEW ICâ€™s!!!):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="va">x0</span> <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">;</span>            <span class="co">% meters</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="va">x0dot</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span>        <span class="co">% meters/sec</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="va">y0</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span>             <span class="co">% meters</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="va">y0dot</span> <span class="op">=</span> <span class="fl">0</span><span class="op">;</span>          <span class="co">% meters/sec</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="va">theta0</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">;</span>      <span class="co">% radians</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="va">theta0dot</span> <span class="op">=</span> <span class="fl">0.1</span><span class="op">;</span>    <span class="co">% radians/sec</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Assume that we have access to the full state vector, then construct a closed-loop state-space LTI object using the feedback gains from above.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="va">Acl</span> <span class="op">=</span> <span class="va">Aol</span> <span class="op">-</span> <span class="va">Bol</span><span class="op">*</span><span class="va">G</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>Acl = 6x6    
1.0e+03 *

         0    0.0010         0         0         0         0
         0   -0.0010         0         0   -0.0098         0
         0         0         0    0.0010         0         0
   -0.1273   -0.0899   -0.0484   -0.0279    0.4406    0.0048
         0         0         0         0         0    0.0010
    0.3637    0.2688    0.0355   -0.0029   -1.3402   -0.0655</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="va">Ccl</span> <span class="op">=</span> <span class="va">Col</span> <span class="op">-</span> <span class="va">Dol</span><span class="op">*</span><span class="va">G</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>Ccl = 3x6    
     1     0     0     0     0     0
     0     0     1     0     0     0
     0     0     0     0     1     0</code></pre>
<p>We must augment the output equation to output the original outputs as well as the control signals.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="va">Ccl</span> <span class="op">=</span> [<span class="va">Ccl</span><span class="op">;</span> <span class="op">-</span><span class="va">G</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>Ccl = 5x6    
1.0e+03 *

    0.0010         0         0         0         0         0
         0         0    0.0010         0         0         0
         0         0         0         0    0.0010         0
    1.1332    0.8551   -0.0362   -0.1151   -4.2932   -0.2707
   -2.4067   -1.7537   -0.4483   -0.1343    8.6992    0.3186</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="va">CL_sys</span> <span class="op">=</span> <span class="va">ss</span>(<span class="va">Acl</span><span class="op">,</span>[]<span class="op">,</span><span class="va">Ccl</span><span class="op">,</span>[])<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Simulate the initial value response using <code>INITIAL</code>. Choose a final simulation time of 4 seconds for this simulation.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="va">t_final</span> <span class="op">=</span> <span class="fl">4</span><span class="op">;</span> <span class="co">% seconds</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="va">xinit</span> <span class="op">=</span> [<span class="va">x0</span><span class="op">;</span><span class="va">x0dot</span><span class="op">;</span><span class="va">y0</span><span class="op">;</span><span class="va">y0dot</span><span class="op">;</span><span class="va">theta0</span><span class="op">;</span><span class="va">theta0dot</span>]<span class="op">;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>[<span class="va">y_ivr</span><span class="op">,</span><span class="va">t_ivr</span>] <span class="op">=</span> <span class="va">initial</span>(<span class="va">CL_sys</span><span class="op">,</span><span class="va">xinit</span><span class="op">,</span><span class="va">t_final</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Estimate the 5% settling times for each output.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="va">S</span> <span class="op">=</span> <span class="va">lsiminfo</span>(<span class="va">y_ivr</span><span class="op">,</span><span class="va">t_ivr</span><span class="op">,</span><span class="st">"SettlingTimeThreshold"</span><span class="op">,</span><span class="fl">0.05</span>)<span class="op">;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="va">S</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>).<span class="va">TransientTime</span> <span class="co">% Settling times in seconds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ans = 2.4134
ans = 2.6797
ans = 0.9707</code></pre>
<p>Generate a plot like what was required for the Midterm Project with the three outputs on the left-hand side (separate axes for each output), and the control signals on the right-hand side of the figure (separate axes for each control signal). Annotate each plot with some kind of marker for the 5% settling times, the min and max allowable control signals, grid lines, axis labels, and units.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="va">figure</span>()<span class="op">;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="va">u1_min</span> <span class="op">=</span> <span class="op">-</span><span class="fl">2039</span><span class="op">;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="va">u1_max</span> <span class="op">=</span> <span class="fl">1959</span><span class="op">;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="va">u2_min</span> <span class="op">=</span> <span class="op">-</span><span class="fl">2057.1</span><span class="op">;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="va">u2_max</span> <span class="op">=</span> <span class="fl">1940.9</span><span class="op">;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="va">outputNames</span> <span class="op">=</span> {<span class="ss">'x'</span><span class="op">,</span> <span class="ss">'y'</span><span class="op">,</span> <span class="ss">'\theta'</span><span class="op">,</span> <span class="ss">'u1'</span><span class="op">,</span><span class="ss">'u2'</span>}<span class="op">;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="va">outputUnits</span> <span class="op">=</span> {<span class="ss">'m'</span><span class="op">,</span> <span class="ss">'m'</span><span class="op">,</span> <span class="ss">'rad'</span><span class="op">,</span><span class="ss">'N'</span><span class="op">,</span> <span class="ss">'N'</span>}<span class="op">;</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="va">inputNames</span> <span class="op">=</span> {<span class="ss">'u1'</span><span class="op">,</span> <span class="ss">'u2'</span>}<span class="op">;</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="va">inputUnits</span> <span class="op">=</span> {<span class="ss">'N'</span><span class="op">,</span> <span class="ss">'N'</span>}<span class="op">;</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">subplot</span>(<span class="fl">3</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span> <span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">i</span>)<span class="op">;</span> <span class="co">% odd numbers for left side</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span> <span class="va">i</span>))<span class="op">;</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    <span class="va">index</span> <span class="op">=</span> <span class="va">find</span>((<span class="va">t_ivr</span><span class="op">-</span><span class="va">S</span>(<span class="va">i</span>).<span class="va">TransientTime</span>)<span class="op">&gt;</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">index</span><span class="op">&lt;=</span><span class="va">size</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="fl">1</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">xline</span>(<span class="va">t_ivr</span>(<span class="va">index</span>)<span class="op">,</span><span class="ss">'--r'</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="va">clear</span> <span class="va">index</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span>(<span class="va">sprintf</span>(<span class="ss">'%s'</span><span class="op">,</span> <span class="va">outputNames</span>{<span class="va">i</span>}))<span class="op">;</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="va">xlabel</span>(<span class="ss">'Time (s)'</span>)<span class="op">;</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>    <span class="va">ylabel</span>(<span class="va">sprintf</span>(<span class="ss">'%s'</span><span class="op">,</span> <span class="va">outputUnits</span>{<span class="va">i</span>}))<span class="op">;</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="va">grid</span> <span class="va">on</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="va">subplot</span>(<span class="fl">2</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span> <span class="va">i</span><span class="op">*</span><span class="fl">2</span>)<span class="op">;</span> <span class="co">% even numbers for right side</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>    <span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span> <span class="va">i</span><span class="op">+</span><span class="fl">3</span>))<span class="op">;</span> <span class="co">% 4 and 5 for u1 and u2</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="va">ylim</span>([<span class="op">-</span><span class="fl">2500</span><span class="op">,</span><span class="fl">2500</span>])</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">i</span> <span class="op">==</span> <span class="fl">1</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>        <span class="va">yline</span>(<span class="va">double</span>(<span class="va">u1_max</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>        <span class="va">yline</span>(<span class="va">double</span>(<span class="va">u1_min</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">i</span> <span class="op">==</span> <span class="fl">2</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>        <span class="va">yline</span>(<span class="va">double</span>(<span class="va">u2_max</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">yline</span>(<span class="va">double</span>(<span class="va">u2_min</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span>(<span class="va">sprintf</span>(<span class="ss">'%s'</span><span class="op">,</span> <span class="va">inputNames</span>{(<span class="va">i</span>)}))<span class="op">;</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>    <span class="va">xlabel</span>(<span class="ss">'Time (s)'</span>)<span class="op">;</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>    <span class="va">ylabel</span>(<span class="va">sprintf</span>(<span class="ss">'%s'</span><span class="op">,</span> <span class="va">inputUnits</span>{(<span class="va">i</span>)}))<span class="op">;</span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>    <span class="va">grid</span> <span class="va">on</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a><span class="co">% Adjust the overall plot title</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a><span class="va">sgtitle</span>(<span class="ss">'Initial Response for Outputs (left) &amp; Inputs (right)'</span>)<span class="op">;</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="va">f</span><span class="op">,</span><span class="st">"Position"</span><span class="op">,</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">800</span> <span class="fl">800</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Full_State_Feedback_Control_Design_media/figure_0.png" class="img-fluid"></p>
<p>In addition to the normal five subplot figure, we must also include the animation plot in the LiveScript as documentation of the performance.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="va">als_f23_animate</span>( <span class="va">t_ivr</span><span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">2</span>)<span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">3</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="case-3.-evaluate-observability" class="level1">
<h1>CASE 3. Evaluate Observability</h1>
<p>First show that this system is completely observable using all three outputs.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="va">Ob</span> <span class="op">=</span> <span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>)<span class="op">;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">Ob</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ans = 6</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="va">N</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>N = 6</code></pre>
<p>Rank of observability matrix is equal to number of states.</p>
<p>Then we determine whether this system is completely observable using any subset of outputs and justify our answers.</p>
<p>For individual outputs</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>(<span class="fl">1</span><span class="op">,:</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ans = 4</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>(<span class="fl">2</span><span class="op">,:</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ans = 2</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>(<span class="fl">3</span><span class="op">,:</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ans = 2</code></pre>
<p>None of the individual outputs obs matrices are full rank</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>([<span class="fl">1</span> <span class="fl">2</span>]<span class="op">,:</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ans = 6</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>([<span class="fl">1</span> <span class="fl">3</span>]<span class="op">,:</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ans = 4</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>([<span class="fl">2</span> <span class="fl">3</span>]<span class="op">,:</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ans = 4</code></pre>
<p>We can see that the combination of ouput 1 &amp; 2 (x &amp; y), has a obs matrix which is full rank meaning the system is obervable using just there 2 outputs.</p>
</section>
<section id="case-4.-design-a-full-order-luenberger-observer" class="level1">
<h1>CASE 4. Design a Full-Order Luenberger Observer</h1>
<p>In this CASE, we will compute the gains for a state estimator using all three outputs. We must first choose appropriate pole locations for the state estimator (observer), and then compute and display the associated feedback gain matrix using the <code>PLACE</code> function.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="va">alpha</span> <span class="op">=</span> <span class="fl">1.5</span><span class="op">;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="va">obs_poles</span> <span class="op">=</span> <span class="va">alpha</span><span class="op">*</span><span class="va">cl_poles</span><span class="op">;</span><span class="co">% alpha &gt; 1 is faster observer than controller</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="va">K</span> <span class="op">=</span> <span class="va">place</span>(<span class="va">Aol</span><span class="op">.',</span><span class="va">Col</span><span class="op">.',</span><span class="va">obs_poles</span>)<span class="op">.'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>K = 6x3    
   47.0621   11.3921  -12.6548
   59.1867  -53.1150   13.2504
   -6.5959   78.7139  -41.1033
   63.5968    2.2363   -0.7294
   -5.7511   40.1340   10.2240
    1.9765   -0.8166    6.4001</code></pre>
<p>To document our design, we must generate a plot that includes the open-loop poles from CASE 1, the closed-loop poles from CASE 2, and observer poles from this CASE. Use common markers for each set of poles (i.e.&nbsp;all open-loop poles must use the same marker, etc.) so that it is easy to distinguish the poles on the figure. Include a legend that only has three entries in it (open-loop, closed-loop, observer), corresponding to the three sets of poles. We must use the <code>SGRID</code> function (read the Matlab help!!) to generate appropriate grid lines. We will also annotate our plot with axis labels. Making sure our legend does not cover up any of the poles!</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="va">figure</span><span class="op">;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="va">wmax</span> <span class="op">=</span> <span class="va">round</span>(<span class="va">max</span>(<span class="va">abs</span>([<span class="va">cl_poles</span><span class="op">;</span><span class="va">ol_poles</span><span class="op">;</span><span class="va">obs_poles</span>])))<span class="op">;</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="va">sgrid</span>(<span class="fl">0</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">0.9</span><span class="op">,</span><span class="fl">0</span><span class="op">:</span><span class="va">wmax</span><span class="op">/</span><span class="fl">5</span><span class="op">:</span><span class="va">wmax</span><span class="op">*</span><span class="fl">1.5</span><span class="op">,</span><span class="st">"new"</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="va">h1</span> <span class="op">=</span> <span class="va">plot</span>(<span class="va">real</span>(<span class="va">ol_poles</span>)<span class="op">,</span><span class="va">imag</span>(<span class="va">ol_poles</span>)<span class="op">,</span><span class="ss">'bx'</span><span class="op">,</span><span class="ss">'markersize'</span><span class="op">,</span><span class="fl">10</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="va">h2</span> <span class="op">=</span> <span class="va">plot</span>(<span class="va">real</span>(<span class="va">cl_poles</span>)<span class="op">,</span><span class="va">imag</span>(<span class="va">cl_poles</span>)<span class="op">,</span><span class="ss">'gs'</span><span class="op">,</span><span class="ss">'markersize'</span><span class="op">,</span><span class="fl">10</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="va">h3</span> <span class="op">=</span> <span class="va">plot</span>(<span class="va">real</span>(<span class="va">obs_poles</span>)<span class="op">,</span><span class="va">imag</span>(<span class="va">obs_poles</span>)<span class="op">,</span><span class="ss">'rd'</span><span class="op">,</span><span class="ss">'markersize'</span><span class="op">,</span><span class="fl">10</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="va">xlabel</span>(<span class="ss">'Real (s)'</span>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'Imag (s)'</span>)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="va">xline</span>(<span class="fl">0</span><span class="op">,</span><span class="ss">'m'</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="fl">0</span><span class="op">,</span><span class="ss">'m'</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>([<span class="va">h1</span><span class="op">,</span><span class="va">h2</span><span class="op">,</span><span class="va">h3</span>]<span class="op">,</span><span class="ss">'open loop'</span><span class="op">,</span><span class="ss">'closed loop'</span><span class="op">,</span><span class="ss">'estimator'</span>)<span class="op">;</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="va">f</span><span class="op">,</span><span class="st">"Position"</span><span class="op">,</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">600</span> <span class="fl">600</span>])</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="va">gca</span><span class="op">,</span><span class="ss">'yaxislocation'</span><span class="op">,</span><span class="ss">'right'</span>)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="va">axis</span> <span class="va">equal</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Full_State_Feedback_Control_Design_media/figure_1.png" class="img-fluid"></p>
</section>
<section id="case-5.-simulate-output-feedback-control" class="level1">
<h1>CASE 5. Simulate Output Feedback Control</h1>
<p>For this CASE, we must simulate the complete output feedback control system, which will include the state estimator and full state feedback using the estimated states.</p>
<p>Using the equations for obersever followed by controller we can find, (L14/S29)</p>
<p><span class="math display">\[
\left\lbrack \begin{array}{c}
\dot{x} \\
\dot{\hat{x} }
\end{array}\right\rbrack =\left\lbrack \begin{array}{cc}
A &amp; -B\;G\\
K\;C &amp; \hat{A} -K\hat{C} -\hat{B\;} G-K\left(D-\hat{D} \right)G
\end{array}\right\rbrack \left\lbrack \begin{array}{c}
x\\
\hat{x}
\end{array}\right\rbrack
\]</span></p>
<p><span class="math display">\[
\left\lbrack \begin{array}{c}
y\\
\hat{y}
\end{array}\right\rbrack =\left\lbrack \begin{array}{cc}
C &amp; -D\;G\\
0 &amp; \hat{C} -\hat{D} \;G
\end{array}\right\rbrack \left\lbrack \begin{array}{c}
x\\
\hat{x}
\end{array}\right\rbrack
\]</span></p>
<p>Assumuing,</p>
<p><span class="math display">\[
\hat{A} =A\;\;\;\;\;\;\;\;\;\;\;\;\hat{B} =B\;\;\;\;\;\;\;\;\;\;\;\;\hat{C} =C\;\;\;\;\;\;\;\;\;\;\;\;\hat{D} =D
\]</span></p>
<p>We can simplify as,</p>
<p><span class="math display">\[
\left\lbrack \begin{array}{c}
\dot{x} \\
\dot{\hat{x} }
\end{array}\right\rbrack =\left\lbrack \begin{array}{cc}
A &amp; -B\;G\\
K\;C &amp; A-K\;C-B\;G
\end{array}\right\rbrack \left\lbrack \begin{array}{c}
x\\
\hat{x}
\end{array}\right\rbrack
\]</span></p>
<p><span class="math display">\[
\left\lbrack \begin{array}{c}
y\\
\hat{y}
\end{array}\right\rbrack =\left\lbrack \begin{array}{cc}
C &amp; -D\;G\\
0 &amp; C-D\;G
\end{array}\right\rbrack \left\lbrack \begin{array}{c}
x\\
\hat{x}
\end{array}\right\rbrack
\]</span></p>
<p>Augmenting to get back u to plot,</p>
<p><span class="math display">\[
\begin{bmatrix}
y \\
\hat{y} \\
u
\end{bmatrix}
=
\begin{bmatrix}
C &amp; -DG \\
0 &amp; C-DG \\
0 &amp; -G
\end{bmatrix}
\begin{bmatrix}
x \\
\hat{x}
\end{bmatrix}
\]</span></p>
<p>In order to insure that the estimated states <span class="math inline">\(\hat{\mathbf{x}}\)</span> (and outputs <span class="math inline">\(\hat{\mathbf{y}}\)</span>) have converged before control is enabled, we will first need to generate an augmented LTI closed-loop output-feedback control model with the state feedback gain <span class="math inline">\(\mathbf{G}\)</span> set to zero (it is easier to just use <span class="math inline">\(\left(0*\mathbf{G}\right)\)</span> in the matrices). This first LTI object will be used for the first <strong>200 milliseconds</strong> of the response. We must use the same initial states on the plant as defined in CASE 2 above, but the initial observer states must be zero. Our closed-loop state-space output equation must also be augmented to output the following three vectors: <span class="math inline">\(\mathbf{y}\)</span>, <span class="math inline">\(\hat{\mathbf{y}}\)</span>, and <span class="math inline">\(\mathbf{u}\)</span>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="va">xinit_OFC</span> <span class="op">=</span> [<span class="va">xinit</span><span class="op">;</span><span class="va">zeros</span>(<span class="va">size</span>(<span class="va">xinit</span>))]<span class="op">;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="va">Aofc_G0</span> <span class="op">=</span> [<span class="va">Aol</span><span class="op">,</span> <span class="op">-</span><span class="va">Bol</span><span class="op">*</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">K</span><span class="op">*</span><span class="va">Col</span><span class="op">,</span> <span class="va">Aol</span><span class="op">-</span><span class="va">K</span><span class="op">*</span><span class="va">Col</span><span class="op">-</span><span class="va">Bol</span><span class="op">*</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="va">Cofc_G0</span> <span class="op">=</span> [<span class="va">Col</span><span class="op">,</span> <span class="op">-</span><span class="va">Dol</span><span class="op">*</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="va">size</span>(<span class="va">Col</span>))<span class="op">,</span> <span class="va">Col</span><span class="op">-</span><span class="va">Dol</span><span class="op">*</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="va">size</span>(<span class="va">G</span>))<span class="op">,</span> <span class="op">-</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="va">eye</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">6</span>)<span class="op">,</span><span class="va">zeros</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">6</span>)<span class="op">;</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">6</span>)<span class="op">,</span><span class="va">eye</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">6</span>)]<span class="op">;</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="va">OFC_sys_G0</span> <span class="op">=</span> <span class="va">ss</span>(<span class="va">Aofc_G0</span><span class="op">,</span>[]<span class="op">,</span><span class="va">Cofc_G0</span><span class="op">,</span>[])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>OFC_sys_G0 =
 
  A = 
             x1       x2       x3       x4       x5       x6       x7       x8       x9      x10      x11      x12
   x1         0        1        0        0        0        0        0        0        0        0        0        0
   x2         0       -1        0        0    -9.81        0        0        0        0        0        0        0
   x3         0        0        0        1        0        0        0        0        0        0        0        0
   x4         0        0        0       -3        0        0        0        0        0        0        0        0
   x5         0        0        0        0        0        1        0        0        0        0        0        0
   x6         0        0        0        0        0     -1.6        0        0        0        0        0        0
   x7     47.06        0    11.39        0   -12.65        0   -47.06        1   -11.39        0    12.65        0
   x8     59.19        0   -53.12        0    13.25        0   -59.19       -1    53.12        0   -23.06        0
   x9    -6.596        0    78.71        0    -41.1        0    6.596        0   -78.71        1     41.1        0
   x10     63.6        0    2.236        0  -0.7294        0    -63.6        0   -2.236       -3   0.7294        0
   x11   -5.751        0    40.13        0    10.22        0    5.751        0   -40.13        0   -10.22        1
   x12    1.976        0  -0.8166        0      6.4        0   -1.976        0   0.8166        0     -6.4     -1.6
 
  B = 
     Empty matrix: 12-by-0
 
  C = 
         x1   x2   x3   x4   x5   x6   x7   x8   x9  x10  x11  x12
   y1     1    0    0    0    0    0    0    0    0    0    0    0
   y2     0    0    1    0    0    0    0    0    0    0    0    0
   y3     0    0    0    0    1    0    0    0    0    0    0    0
   y4     0    0    0    0    0    0    1    0    0    0    0    0
   y5     0    0    0    0    0    0    0    0    1    0    0    0
   y6     0    0    0    0    0    0    0    0    0    0    1    0
   y7     0    0    0    0    0    0    0    0    0    0    0    0
   y8     0    0    0    0    0    0    0    0    0    0    0    0
   y9     1    0    0    0    0    0    0    0    0    0    0    0
   y10    0    1    0    0    0    0    0    0    0    0    0    0
   y11    0    0    1    0    0    0    0    0    0    0    0    0
   y12    0    0    0    1    0    0    0    0    0    0    0    0
   y13    0    0    0    0    1    0    0    0    0    0    0    0
   y14    0    0    0    0    0    1    0    0    0    0    0    0
   y15    0    0    0    0    0    0    1    0    0    0    0    0
   y16    0    0    0    0    0    0    0    1    0    0    0    0
   y17    0    0    0    0    0    0    0    0    1    0    0    0
   y18    0    0    0    0    0    0    0    0    0    1    0    0
   y19    0    0    0    0    0    0    0    0    0    0    1    0
   y20    0    0    0    0    0    0    0    0    0    0    0    1
 
  D = 
     Empty matrix: 20-by-0
 
Continuous-time state-space model.
Model Properties</code></pre>
<p>Next, we must generate a second augmented LTI closed-loop output-feedback control model that is identical to the first model except that the state-feedback control gains are not zero, i.e.&nbsp;the controller is enabled. This second LTI object will be used for the remainder of the simulation.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="va">Aofc</span> <span class="op">=</span> [<span class="va">Aol</span><span class="op">,</span> <span class="op">-</span><span class="va">Bol</span><span class="op">*</span><span class="va">G</span><span class="op">;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">K</span><span class="op">*</span><span class="va">Col</span><span class="op">,</span> <span class="va">Aol</span><span class="op">-</span><span class="va">K</span><span class="op">*</span><span class="va">Col</span><span class="op">-</span><span class="va">Bol</span><span class="op">*</span><span class="va">G</span>]<span class="op">;</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="va">Cofc</span> <span class="op">=</span> [<span class="va">Col</span><span class="op">,</span> <span class="op">-</span><span class="va">Dol</span><span class="op">*</span><span class="va">G</span><span class="op">;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="va">size</span>(<span class="va">Col</span>))<span class="op">,</span> <span class="va">Col</span><span class="op">-</span><span class="va">Dol</span><span class="op">*</span><span class="va">G</span><span class="op">;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="va">size</span>(<span class="va">G</span>))<span class="op">,</span> <span class="op">-</span><span class="va">G</span>]<span class="op">;</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="va">OFC_sys</span> <span class="op">=</span> <span class="va">ss</span>(<span class="va">Aofc</span><span class="op">,</span>[]<span class="op">,</span><span class="va">Cofc</span><span class="op">,</span>[])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>OFC_sys =
 
  A = 
             x1       x2       x3       x4       x5       x6       x7       x8       x9      x10      x11      x12
   x1         0        1        0        0        0        0        0        0        0        0        0        0
   x2         0       -1        0        0    -9.81        0        0        0        0        0        0        0
   x3         0        0        0        1        0        0        0        0        0        0        0        0
   x4         0        0        0       -3        0        0   -127.3   -89.85   -48.45   -24.94    440.6    4.792
   x5         0        0        0        0        0        1        0        0        0        0        0        0
   x6         0        0        0        0        0     -1.6    363.7    268.8    35.54   -2.918    -1340   -63.86
   x7     47.06        0    11.39        0   -12.65        0   -47.06        1   -11.39        0    12.65        0
   x8     59.19        0   -53.12        0    13.25        0   -59.19       -1    53.12        0   -23.06        0
   x9    -6.596        0    78.71        0    -41.1        0    6.596        0   -78.71        1     41.1        0
   x10     63.6        0    2.236        0  -0.7294        0   -190.9   -89.85   -50.68   -27.94    441.3    4.792
   x11   -5.751        0    40.13        0    10.22        0    5.751        0   -40.13        0   -10.22        1
   x12    1.976        0  -0.8166        0      6.4        0    361.7    268.8    36.36   -2.918    -1347   -65.46
 
  B = 
     Empty matrix: 12-by-0
 
  C = 
           x1      x2      x3      x4      x5      x6      x7      x8      x9     x10     x11     x12
   y1       1       0       0       0       0       0       0       0       0       0       0       0
   y2       0       0       1       0       0       0       0       0       0       0       0       0
   y3       0       0       0       0       1       0       0       0       0       0       0       0
   y4       0       0       0       0       0       0       1       0       0       0       0       0
   y5       0       0       0       0       0       0       0       0       1       0       0       0
   y6       0       0       0       0       0       0       0       0       0       0       1       0
   y7       0       0       0       0       0       0    1133   855.1   -36.2  -115.1   -4293  -270.7
   y8       0       0       0       0       0       0   -2407   -1754  -448.3  -134.3    8699   318.6
 
  D = 
     Empty matrix: 8-by-0
 
Continuous-time state-space model.
Model Properties</code></pre>
<p>We are now ready to simulate the closed-loop response, but it must happen in two separate simulation stages. In the first stage, we will use the INITIAL function to simulate for 200 milliseconds. At the end of this first simulation stage, we must capture the final state vector and use it as the initial state vector for the second simulation stage. The total simulation duration should be 4 seconds like above.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="va">t_break</span> <span class="op">=</span> <span class="fl">200e-03</span><span class="op">;</span> <span class="co">% seconds</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="va">t_final</span> <span class="op">=</span> <span class="fl">4</span><span class="op">;</span> <span class="co">% seconds</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="va">dt</span> <span class="op">=</span> <span class="fl">0.01</span><span class="op">;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="va">t_1</span> <span class="op">=</span> (<span class="fl">0</span><span class="op">:</span><span class="va">dt</span><span class="op">:</span><span class="va">t_break</span>)<span class="op">;</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="va">t_2</span> <span class="op">=</span> (<span class="va">t_break</span><span class="op">+</span><span class="va">dt</span>)<span class="op">:</span><span class="va">dt</span><span class="op">:</span><span class="va">t_final</span><span class="op">;</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>[<span class="va">y_1</span><span class="op">,</span><span class="va">t_1</span>] <span class="op">=</span> <span class="va">initial</span>(<span class="va">OFC_sys_G0</span><span class="op">,</span><span class="va">xinit_OFC</span><span class="op">,</span><span class="va">t_1</span>)<span class="op">;</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="va">xinit_OFC_break</span> <span class="op">=</span> <span class="va">y_1</span>(<span class="va">size</span>(<span class="va">y_1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">,</span><span class="fl">9</span><span class="op">:</span><span class="fl">20</span>)<span class="op">.';</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>[<span class="va">y_2</span><span class="op">,</span><span class="va">t_2</span>] <span class="op">=</span> <span class="va">initial</span>(<span class="va">OFC_sys</span><span class="op">,</span> <span class="va">xinit_OFC_break</span><span class="op">,</span><span class="va">t_2</span>)<span class="op">;</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="va">y_ivr</span> <span class="op">=</span> [<span class="va">y_1</span>(<span class="op">:,</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>)<span class="op">;</span><span class="va">y_2</span>(<span class="op">:,</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>)]<span class="op">;</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="va">t_ivr</span> <span class="op">=</span> [<span class="va">t_1</span><span class="op">;</span><span class="va">t_2</span>]<span class="op">;</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="va">S</span> <span class="op">=</span> <span class="va">lsiminfo</span>(<span class="va">y_ivr</span><span class="op">,</span><span class="va">t_ivr</span><span class="op">,</span><span class="st">"SettlingTimeThreshold"</span><span class="op">,</span><span class="fl">0.05</span>)<span class="op">;</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="va">S</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>).<span class="va">TransientTime</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>ans = 2.5721
ans = 1.6099
ans = 2.1822</code></pre>
<p>Generate the standard annotated plot (three output subplots on the left and two control signal subplots on the right), with appropriate annotations; but we must also plot the estimated output signals on top of the associated actual output signals. It must be clear from our plots that the estimated outputs all start from zero and converge to the actual outputs within 200 milliseconds. One must NOT try to get the observer states to converge too fast because it will be difficult to see the convergence on the plots. If we have done this step correctly, we should see 5% settling times that are comparable to the original design from CASE 2. The 5% settling times on the outputs must all be below 3 seconds, and we must not saturate either of the control signals.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="va">figure</span>()<span class="op">;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">,</span><span class="ss">'r'</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">4</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="va">xline</span>(<span class="va">S</span>(<span class="fl">1</span>).<span class="va">TransientTime</span><span class="op">,</span><span class="ss">'--r'</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>({<span class="ss">'${x}$'</span><span class="op">,</span><span class="ss">'$\hat{x}$'</span>}<span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'latex'</span><span class="op">,</span><span class="ss">'Location'</span><span class="op">,</span><span class="ss">'best'</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'m'</span>)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">3</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">2</span>)<span class="op">,</span><span class="ss">'g'</span>)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">5</span>)<span class="op">,</span><span class="ss">'--black'</span>)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="va">xline</span>(<span class="va">S</span>(<span class="fl">2</span>).<span class="va">TransientTime</span><span class="op">,</span><span class="ss">'--r'</span>)</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>({<span class="ss">'${y}$'</span><span class="op">,</span><span class="ss">'$\hat{y}$'</span>}<span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'latex'</span><span class="op">,</span><span class="ss">'Location'</span><span class="op">,</span><span class="ss">'best'</span>)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'m'</span>)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">5</span>)</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">3</span>)<span class="op">,</span><span class="ss">'m'</span>)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">6</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="va">xline</span>(<span class="va">S</span>(<span class="fl">3</span>).<span class="va">TransientTime</span><span class="op">,</span><span class="ss">'--r'</span>)</span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>({<span class="ss">'${\theta}$'</span><span class="op">,</span><span class="ss">'$\hat{\theta}$'</span>}<span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'latex'</span><span class="op">,</span><span class="ss">'Location'</span><span class="op">,</span><span class="ss">'best'</span>)</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="va">xlabel</span>(<span class="ss">'Time (s)'</span>)</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'rad'</span>)</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">2</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">7</span>)<span class="op">,</span><span class="ss">'r'</span>)</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="va">double</span>(<span class="va">u1_max</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="va">double</span>(<span class="va">u1_min</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>(<span class="ss">'u_1'</span>)</span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'N'</span>)</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">2</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">4</span>)</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">8</span>)<span class="op">,</span><span class="ss">'r'</span>)</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="va">double</span>(<span class="va">u2_max</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="va">double</span>(<span class="va">u2_min</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>(<span class="ss">'u_2'</span>)</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'N'</span>)</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a><span class="va">xlabel</span>(<span class="ss">'Time (s)'</span>)</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a><span class="va">sgtitle</span>(<span class="ss">'Initial Response for Outputs (left) &amp; Inputs (right)'</span>)<span class="op">;</span></span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="va">f</span><span class="op">,</span><span class="st">"Position"</span><span class="op">,</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">800</span> <span class="fl">800</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Full_State_Feedback_Control_Design_media/figure_2.png" class="img-fluid"></p>
<p>In addition to the normal five subplot figure, I have also included the animation plot in the LiveScript as documentation of the performance. The <code>als_f23_animate.p</code> MATLAB p-code file can be found in the GitHub repository of the project.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="va">als_f23_animate</span>( <span class="va">t_ivr</span><span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">2</span>)<span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">3</span>))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="Full_State_Feedback_Control_Design_media/Simulation_animation.gif" alt="Animated GIF" width="50%"></p>
<section id="for-cases-6-7-and-8-we-will-design-and-simulate-another-output-feedback-controller-i.e.-a-state-estimator-with-full-state-feedback-control-but-now-we-must-also-include-integral-control-for-reference-tracking-as-defined-in-the-notes." class="level2">
<h2 class="anchored" data-anchor-id="for-cases-6-7-and-8-we-will-design-and-simulate-another-output-feedback-controller-i.e.-a-state-estimator-with-full-state-feedback-control-but-now-we-must-also-include-integral-control-for-reference-tracking-as-defined-in-the-notes.">For cases 6, 7, and 8, we will design and simulate another Output Feedback Controller (i.e.&nbsp;a state estimator with full state feedback control), but now we must also include Integral Control for reference tracking as defined in the notes.</h2>

</section>
<section id="we-must-expect-to-iterate-on-cases-6-7-and-8-until-we-achieve-one-acceptable-design." class="level2">
<h2 class="anchored" data-anchor-id="we-must-expect-to-iterate-on-cases-6-7-and-8-until-we-achieve-one-acceptable-design.">We must expect to iterate on CASES 6, 7, and 8 until we achieve one acceptable design.</h2>
</section>
</section>
<section id="case-6.-design-an-lqi-compensator" class="level1">
<h1>CASE 6. Design an LQI compensator</h1>
<p>We must use LQR optimal control to design the state-feedback gains for this simulation. The MathWorks has provided a separate tool called <code>LQI</code> for computing the state-feedback gains when we are implementing state feedback with integral control. Note that <code>LQI</code> is identical to <code>LQR</code> except that <code>LQI</code> already knows that we are designing for reference tracking with an integral controller. We can NOT use <code>LQR</code> for this design, and we must use <code>LQI!</code> We must also use the LTI object for the open-loop system as input to the <code>LQI</code> function. Read the online help for <code>LQI</code> before starting this CASE!</p>
<p>First define the LQI cost function weighting matrices <span class="math inline">\(\mathbf{Q}\)</span> and <span class="math inline">\(\mathbf{R}\)</span>. Note that <code>LQI</code> also accepts a weighting matrix <span class="math inline">\(\mathbf{N}\)</span>, which allows cross-weighting between states and controls, but we should NOT use this weighting matrix for this CASE! Make sure we understand the dimensions of each of these weighting matrices.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="va">Q</span> <span class="op">=</span> <span class="va">diag</span>([<span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>Q = 9x9    
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="va">R</span> <span class="op">=</span> <span class="va">diag</span>([<span class="fl">1</span> <span class="fl">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>R = 2x2    
     1     0
     0     2</code></pre>
<p>Generate and display the optimal control gains and separate them into <span class="math inline">\({\mathbf{G}}_0\)</span> and <span class="math inline">\({\mathbf{G}}_I\)</span> matrices.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="va">OL_int_A</span> <span class="op">=</span> [<span class="va">Aol</span><span class="op">,</span> <span class="va">zeros</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">3</span>)<span class="op">;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="va">Col</span><span class="op">,</span> <span class="va">zeros</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">3</span>)]<span class="op">;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="va">OL_int_B</span> <span class="op">=</span> [<span class="va">Bol</span><span class="op">;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="va">Dol</span>]<span class="op">;</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="va">OL_int_sys</span> <span class="op">=</span> <span class="va">ss</span>(<span class="va">OL_int_A</span><span class="op">,</span><span class="va">OL_int_B</span><span class="op">,</span>[]<span class="op">,</span>[])<span class="op">;</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>[<span class="va">G</span><span class="op">,</span><span class="va">S</span><span class="op">,</span><span class="va">e</span>]<span class="op">=</span><span class="va">lqi</span>(<span class="va">OL_int_sys</span><span class="op">,</span><span class="va">Q</span><span class="op">,</span><span class="va">R</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre class="text:output"><code>G = 2x9    
   -3.2779   -2.4232    3.4413    1.1089   29.9386   11.5472    0.8981   -0.4397    0.0000
    1.1514    0.8555    5.0041    1.6054  -11.7328   -4.7892   -0.3109   -0.6351    0.0000

S = 9x9    
1.0e+08 *

    0.0507    0.0507    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.4976
    0.0507    0.0507    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.4976
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.4976   -0.4976    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    4.8816

e = 9x1 complex    
  -0.0000 + 0.0000i
  -0.1348 + 0.1327i
  -0.1348 - 0.1327i
  -0.5013 + 0.7953i
  -0.5013 - 0.7953i
  -0.9185 + 0.3250i
  -0.9185 - 0.3250i
  -1.6934 + 0.0000i
  -3.0023 + 0.0000i</code></pre>
</section>
<section id="case-7.-construct-the-ofc-with-reference-inputs" class="level1">
<h1>CASE 7. Construct the OFC with Reference Inputs</h1>
<p>Generate an augmented state-space system for the closed-loop Output Feedback Controller (state feedback with estimated states) and Reference Tracking. Our complete closed-loop state-space model must have:</p>
<p>{ State vector consisting of: <span class="math inline">\(\mathbf{x}\)</span>, <span class="math inline">\(\hat{\mathbf{x}}\)</span>, and <span class="math inline">\({\mathbf{x}}_I\)</span> }</p>
<p>{ Output vector consisting of: <span class="math inline">\(\mathbf{y}\)</span>, <span class="math inline">\(\hat{\mathit{\mathbf{y}}}\)</span>, and <span class="math inline">\(\mathbf{u}\)</span> }</p>
<p>{ Input vector consisting of: <span class="math inline">\(\mathbf{r}\)</span> }</p>
<p>{ State Feedback Control law: <span class="math inline">\(u=-\left\lbrack \begin{array}{cc} {\mathbf{G}}_0 &amp; {\mathbf{G}}_I \end{array}\right\rbrack \left\lbrack \begin{array}{c} \hat{\mathbf{x}} \\ {\mathbf{x}}_I \end{array}\right\rbrack\)</span> }</p>
<p>After generating the closed-loop output feedback control state-space model, compute and display the closed-loop eigenvalues.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="case-8.-simulate-the-output-feedback-controller-with-reference-inputs" class="level1">
<h1>CASE 8. Simulate the Output Feedback Controller with Reference Inputs</h1>
<p>For this CASE, we will simulate the closed-loop response of our control system using <code>LSIM()</code>; however, we must first generate a suitable reference profile as an input. Before we can generate a reference profile, we need to understand the initial position and the final desired position of the drone. These are new initial conditions, and a very different final position from any closed-loop simulation we have done before.</p>
<p><strong>Initial Plant Conditions:</strong> The plant (drone) must start with the following initial states:</p>
<p><span class="math inline">\(x\left(0\right)=-2\)</span> m, <span class="math inline">\(y\left(0\right)=1\)</span> m, and <span class="math inline">\(\theta \left(0\right)=0\)</span> rad.</p>
<p><span class="math inline">\(\dot{x} \left(0\right)=0\)</span> m/s, <span class="math inline">\(\dot{y} \left(0\right)=0\)</span> m/s, and <span class="math inline">\(\dot{\theta} \left(0\right)=0\)</span> rad/s.</p>
<p><strong>Initial Observer Conditions:</strong> We may assume that the initial observer states are identical to the initial plant states.</p>
<p><strong>Final Plant Conditions:</strong> The plant (drone) must reach the following final states:</p>
<p><span class="math inline">\(x\left(0\right)=+2\)</span> m, <span class="math inline">\(y\left(0\right)=0\)</span> m, and <span class="math inline">\(\theta \left(0\right)=0\)</span> rad.</p>
<p><span class="math inline">\(\dot{x} \left(0\right)=0\)</span> m/s, <span class="math inline">\(\dot{y} \left(0\right)=0\)</span> m/s, and <span class="math inline">\(\dot{\theta} \left(0\right)=0\)</span> rad/s.</p>
<p><strong>Evaluation Criteria:</strong></p>
<ul>
<li><p>Notice that the final state is on the opposite side of the 1.5m high red wall in the animation! The drone is NOT allowed to make contact with the wall at any point during the simulation.<br>
</p></li>
<li><p>The drone is NOT allowed to make contact with the ground at any point during the simulation except for the final time where the drone must sit on the ground.</p>
<p>{ The drone must reach the final state by 30 seconds (<span class="math inline">\(\textrm{tfinal}\le 30s\)</span>). }</p></li>
<li><p>The control signals <span class="math inline">\(u_1\)</span> and <span class="math inline">\(u_2\)</span> must remain within the saturation bounds established in the Midterm Project.</p>
<p>{ There is NO formal settling time requirement; however, our actual output responses <span class="math inline">\(\mathbf{y}\)</span> must track the reference responses <span class="math inline">\(\mathbf{r}\)</span>reasonably accurately. For example, if our reference profiles have dwell regions, then there should be zero steady-state error after transients have subsided. If our reference profiles have ramp regions, then we should expect to see a steady-state error during the ramp, which looks like a delayed response. How closely we track the references will depend on our choice of weighting coefficients in the Q matrix. Note that a steady-state error during the ramp is perfectly acceptable as long as we choose the reference profile such that the drone does not make contact with the wall! }</p></li>
<li><p>For this simulation, the observer and the controller must both be enabled at t=0 (i.e.&nbsp;do NOT attempt a two-stage simulation like CASE 5).</p></li>
<li><p>We MUST use <code>LSIM</code> to simulate the closed-loop time response</p>
<p>{ Before constructing the reference profiles, we must first construct a time vector for the simulation. I recommend choosing a uniform step size of <span class="math inline">\(\textrm{ts}=0\ldotp 002\)</span> seconds: }</p></li>
</ul>
<p><span class="math display">\[
t=\textrm{ts}*\left\lbrack 0:\textrm{round}\left(\frac{\textrm{tfinal}}{\left.\textrm{ts}\right)}\right)\right\rbrack
\]</span></p>
<ul>
<li>For each time step in the time vector, we must generate a reference vector for each of the outputs. We will need to generate a particular path vs.&nbsp;time profile for the desired x and y position; however, I recommend choosing the following reference profile for the angular position:</li>
</ul>
<p><span class="math display">\[
\theta_{\textrm{ref}} =\textrm{zeros}\left(\textrm{size}\left(t\right)\right)
\]</span></p>
<ul>
<li>I have used the same plot structure as before except that new signals that must be added. Each of the three output subplots on the left include the reference profile, the actual output, and the estimated output on the same axis.</li>
<li>Our main goal should be able to reach the final state in a minimum time.</li>
</ul>
<section id="simulation-result" class="level2">
<h2 class="anchored" data-anchor-id="simulation-result">SIMULATION RESULT</h2>
<p><img src="Simulation_animation.gif" style="display: block; margin: 0 auto;" alt="Animated GIF" loop="" width="50%" height="100%"></p>


<!-- -->

</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb64" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Full State Feedback Control Design"</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Optimal LQR control for drone landing using MATLAB, emphasizing strategic pole placement for precise descent"</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Control]</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> Simulation_animation.gif</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">    html: </span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="co">        code-fold: show</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co">        code-overflow: wrap</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="co">        code-tools: true</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="fu"># [ME5554/AOE5754/ECE5754 Applied Linear Systems - Project II]{style="color:rgb(213,80,0)"}</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="in">```matlab</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="va">clear</span><span class="op">;</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="fl">0</span><span class="op">,</span><span class="ss">'defaultlinelinewidth'</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="va">format</span> <span class="va">short</span><span class="op">;</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="va">sympref</span>(<span class="ss">'FloatingPointOutput'</span><span class="op">,</span><span class="va">true</span>)<span class="op">;</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a># <span class="va">CASE</span> <span class="fl">1</span>. <span class="va">Prepare</span> <span class="va">the</span> <span class="va">Open</span><span class="op">-</span><span class="va">Loop</span> <span class="va">Plant</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="va">The</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">LTI</span> <span class="va">object</span> <span class="va">we</span> <span class="va">developed</span> <span class="va">in</span> <span class="va">the</span> <span class="va">Project</span> <span class="va">I</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">open</span><span class="op">-</span><span class="va">loop</span> <span class="va">plant</span> <span class="va">should</span> <span class="va">have</span> <span class="va">been</span> <span class="va">saved</span> <span class="va">in</span> <span class="va">a</span> .<span class="va">mat</span> <span class="va">file</span>. </span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">br</span><span class="op">&gt;</span></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a><span class="va">Note</span><span class="op">:</span> <span class="va">Before</span> <span class="va">we</span> <span class="va">proceed</span> <span class="va">with</span> <span class="va">the</span> <span class="va">implementation</span><span class="op">,</span> <span class="va">one</span> <span class="va">should</span> <span class="va">be</span> <span class="va">responsible</span> <span class="kw">for</span> <span class="va">correcting</span> <span class="va">any</span> <span class="va">errors</span> <span class="va">they</span> <span class="va">have</span> <span class="va">in</span> <span class="va">their</span> <span class="va">open</span><span class="op">-</span><span class="va">loop</span> <span class="va">plant</span><span class="bn">! In this case, the plant is provided in my GitHub. One should NOT regenerate the open-loop LTI state-space plant in this LiveScript!!! The open-loop plant MUST be loaded from a .mat file (created in ME5554/AOE5754/ECE5754 Applied Linear Systems - Project I - Linearized LTI Modeling Feedback Control) to avoid discrepancies.</span></span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a><span class="va">load</span>(<span class="st">"MP_nishant_ss_model.mat"</span>)</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a><span class="va">After</span> <span class="va">loading</span> <span class="va">the</span> .<span class="va">mat</span> <span class="va">file</span><span class="op">,</span> <span class="va">display</span> <span class="va">the</span> <span class="va">open</span><span class="op">-</span><span class="va">loop</span> <span class="va">numerical</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">model</span>. <span class="va">This</span> <span class="va">model</span> <span class="va">MUST</span> <span class="va">display</span> <span class="va">appropriately</span> <span class="va">chosen</span> <span class="va">statenames</span><span class="op">,</span> <span class="va">inputnames</span> (<span class="va">ok</span> <span class="va">to</span> <span class="va">use</span> <span class="va">defaults</span> <span class="va">here</span>)<span class="op">,</span> <span class="va">and</span> <span class="va">outputnames</span>.</span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a><span class="va">OL_sys</span></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a><span class="va">OL_sys</span> <span class="op">=</span></span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>  <span class="va">A</span> <span class="op">=</span> </span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>                   <span class="va">X</span> <span class="va">Position</span>    <span class="va">X</span> <span class="va">Velocity</span>    <span class="va">Y</span> <span class="va">Position</span>    <span class="va">Y</span> <span class="va">Velocity</span>  <span class="va">Angular</span> <span class="va">Posi</span>  <span class="va">Angular</span> <span class="va">Velo</span></span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>   <span class="va">X</span> <span class="va">Position</span>               <span class="fl">0</span>             <span class="fl">1</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>   <span class="va">X</span> <span class="va">Velocity</span>               <span class="fl">0</span>            <span class="op">-</span><span class="fl">1</span>             <span class="fl">0</span>             <span class="fl">0</span>         <span class="op">-</span><span class="fl">9.81</span>             <span class="fl">0</span></span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a>   <span class="va">Y</span> <span class="va">Position</span>               <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">1</span>             <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>   <span class="va">Y</span> <span class="va">Velocity</span>               <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>            <span class="op">-</span><span class="fl">3</span>             <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>   <span class="va">Angular</span> <span class="va">Posi</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">1</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>   <span class="va">Angular</span> <span class="va">Velo</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>          <span class="op">-</span><span class="fl">1.6</span></span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>  <span class="va">B</span> <span class="op">=</span> </span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a>                 <span class="va">Varitional</span> <span class="va">F</span>  <span class="va">Varitional</span> <span class="va">F</span></span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>   <span class="va">X</span> <span class="va">Position</span>               <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>   <span class="va">X</span> <span class="va">Velocity</span>               <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a>   <span class="va">Y</span> <span class="va">Position</span>               <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>   <span class="va">Y</span> <span class="va">Velocity</span>             <span class="fl">0.1</span>           <span class="fl">0.1</span></span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a>   <span class="va">Angular</span> <span class="va">Posi</span>             <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a>   <span class="va">Angular</span> <span class="va">Velo</span>        <span class="fl">0.1302</span>       <span class="op">-</span><span class="fl">0.0898</span></span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a>  <span class="va">C</span> <span class="op">=</span> </span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a>                   <span class="va">X</span> <span class="va">Position</span>    <span class="va">X</span> <span class="va">Velocity</span>    <span class="va">Y</span> <span class="va">Position</span>    <span class="va">Y</span> <span class="va">Velocity</span>  <span class="va">Angular</span> <span class="va">Posi</span>  <span class="va">Angular</span> <span class="va">Velo</span></span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a>   <span class="va">X</span> <span class="va">Position</span>               <span class="fl">1</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a>   <span class="va">Y</span> <span class="va">Position</span>               <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">1</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a>   <span class="va">Angular</span> <span class="va">Posi</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">0</span>             <span class="fl">1</span>             <span class="fl">0</span></span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a>  <span class="va">D</span> <span class="op">=</span> </span>
<span id="cb64-69"><a href="#cb64-69" aria-hidden="true" tabindex="-1"></a>                 <span class="va">Varitional</span> <span class="va">F</span>  <span class="va">Varitional</span> <span class="va">F</span></span>
<span id="cb64-70"><a href="#cb64-70" aria-hidden="true" tabindex="-1"></a>   <span class="va">X</span> <span class="va">Position</span>               <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-71"><a href="#cb64-71" aria-hidden="true" tabindex="-1"></a>   <span class="va">Y</span> <span class="va">Position</span>               <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-72"><a href="#cb64-72" aria-hidden="true" tabindex="-1"></a>   <span class="va">Angular</span> <span class="va">Posi</span>             <span class="fl">0</span>             <span class="fl">0</span></span>
<span id="cb64-73"><a href="#cb64-73" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-74"><a href="#cb64-74" aria-hidden="true" tabindex="-1"></a><span class="va">Continuous</span><span class="op">-</span><span class="va">time</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">model</span>.</span>
<span id="cb64-75"><a href="#cb64-75" aria-hidden="true" tabindex="-1"></a><span class="va">Model</span> <span class="va">Properties</span></span>
<span id="cb64-76"><a href="#cb64-76" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-77"><a href="#cb64-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-78"><a href="#cb64-78" aria-hidden="true" tabindex="-1"></a><span class="va">Next</span><span class="op">,</span> <span class="va">extract</span> <span class="va">the</span> <span class="va">Aol</span><span class="op">,</span> <span class="va">Bol</span><span class="op">,</span> <span class="va">Col</span><span class="op">,</span> <span class="va">and</span> <span class="va">Dol</span> <span class="va">matrices</span><span class="op">,</span> <span class="va">but</span> <span class="va">do</span> <span class="va">not</span> <span class="va">display</span> <span class="va">these</span> <span class="va">results</span> (<span class="va">because</span> <span class="va">we</span> <span class="va">already</span> <span class="va">displayed</span> <span class="va">them</span> <span class="va">in</span> <span class="va">the</span> <span class="va">previous</span> <span class="va">step</span>).</span>
<span id="cb64-79"><a href="#cb64-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-80"><a href="#cb64-80" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-81"><a href="#cb64-81" aria-hidden="true" tabindex="-1"></a><span class="va">Aol</span> <span class="op">=</span> <span class="va">OL_sys</span>.<span class="va">A</span><span class="op">;</span></span>
<span id="cb64-82"><a href="#cb64-82" aria-hidden="true" tabindex="-1"></a><span class="va">Bol</span> <span class="op">=</span> <span class="va">OL_sys</span>.<span class="va">B</span><span class="op">;</span></span>
<span id="cb64-83"><a href="#cb64-83" aria-hidden="true" tabindex="-1"></a><span class="va">Col</span> <span class="op">=</span> <span class="va">OL_sys</span>.<span class="va">C</span><span class="op">;</span></span>
<span id="cb64-84"><a href="#cb64-84" aria-hidden="true" tabindex="-1"></a><span class="va">Dol</span> <span class="op">=</span> <span class="va">OL_sys</span>.<span class="va">D</span><span class="op">;</span></span>
<span id="cb64-85"><a href="#cb64-85" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-86"><a href="#cb64-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-87"><a href="#cb64-87" aria-hidden="true" tabindex="-1"></a><span class="va">Compute</span> <span class="va">the</span> <span class="va">open</span><span class="op">-</span><span class="va">loop</span> <span class="va">eigenvalues</span> (<span class="va">ol_poles</span>)<span class="op">,</span> <span class="va">and</span> <span class="va">the</span> <span class="va">system</span> <span class="va">dimensions</span> (<span class="va">N</span><span class="op">,</span> <span class="va">M</span><span class="op">,</span> <span class="va">P</span>). <span class="va">Assign</span> <span class="va">these</span> <span class="va">quantities</span> <span class="va">to</span> <span class="va">variables</span> <span class="kw">for</span> <span class="va">use</span> <span class="va">later</span> <span class="va">in</span> <span class="va">the</span> <span class="va">LiveScript</span><span class="op">,</span> <span class="va">but</span> <span class="va">do</span> <span class="va">not</span> <span class="va">display</span> <span class="va">them</span> <span class="va">here</span>.</span>
<span id="cb64-88"><a href="#cb64-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-89"><a href="#cb64-89" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-90"><a href="#cb64-90" aria-hidden="true" tabindex="-1"></a><span class="va">ol_poles</span> <span class="op">=</span> <span class="va">eig</span>(<span class="va">Aol</span>)</span>
<span id="cb64-91"><a href="#cb64-91" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-92"><a href="#cb64-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-93"><a href="#cb64-93" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-94"><a href="#cb64-94" aria-hidden="true" tabindex="-1"></a><span class="va">ol_poles</span> <span class="op">=</span> <span class="fl">6</span><span class="va">x1</span>    </span>
<span id="cb64-95"><a href="#cb64-95" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0</span></span>
<span id="cb64-96"><a href="#cb64-96" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">1.0000</span></span>
<span id="cb64-97"><a href="#cb64-97" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0</span></span>
<span id="cb64-98"><a href="#cb64-98" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">3.0000</span></span>
<span id="cb64-99"><a href="#cb64-99" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0</span></span>
<span id="cb64-100"><a href="#cb64-100" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">1.6000</span></span>
<span id="cb64-101"><a href="#cb64-101" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-102"><a href="#cb64-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-103"><a href="#cb64-103" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-104"><a href="#cb64-104" aria-hidden="true" tabindex="-1"></a><span class="va">N</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">Aol</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb64-105"><a href="#cb64-105" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-106"><a href="#cb64-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-107"><a href="#cb64-107" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-108"><a href="#cb64-108" aria-hidden="true" tabindex="-1"></a><span class="va">N</span> <span class="op">=</span> <span class="fl">6</span></span>
<span id="cb64-109"><a href="#cb64-109" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-110"><a href="#cb64-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-111"><a href="#cb64-111" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-112"><a href="#cb64-112" aria-hidden="true" tabindex="-1"></a><span class="va">M</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">Bol</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb64-113"><a href="#cb64-113" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-114"><a href="#cb64-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-115"><a href="#cb64-115" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-116"><a href="#cb64-116" aria-hidden="true" tabindex="-1"></a><span class="va">M</span> <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb64-117"><a href="#cb64-117" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-118"><a href="#cb64-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-119"><a href="#cb64-119" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-120"><a href="#cb64-120" aria-hidden="true" tabindex="-1"></a><span class="va">P</span> <span class="op">=</span> <span class="va">size</span>(<span class="va">Col</span><span class="op">,</span><span class="fl">1</span>)</span>
<span id="cb64-121"><a href="#cb64-121" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-122"><a href="#cb64-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-123"><a href="#cb64-123" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-124"><a href="#cb64-124" aria-hidden="true" tabindex="-1"></a><span class="va">P</span> <span class="op">=</span> <span class="fl">3</span></span>
<span id="cb64-125"><a href="#cb64-125" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-126"><a href="#cb64-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-127"><a href="#cb64-127" aria-hidden="true" tabindex="-1"></a># <span class="va">CASE</span> <span class="fl">2</span>. <span class="va">Simulate</span> <span class="va">Closed</span><span class="op">-</span><span class="va">Loop</span> <span class="va">Control</span></span>
<span id="cb64-128"><a href="#cb64-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-129"><a href="#cb64-129" aria-hidden="true" tabindex="-1"></a><span class="va">We</span> <span class="va">are</span> <span class="va">given</span> <span class="va">the</span> <span class="va">following</span> <span class="va">set</span> <span class="va">of</span> <span class="va">desired</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">poles</span> <span class="va">which</span> <span class="va">are</span> <span class="va">known</span> <span class="va">to</span> <span class="va">result</span> <span class="va">in</span> <span class="fl">5</span><span class="co">% settling times (transient times) that are less than 3 seconds without saturating any of the control signals.</span></span>
<span id="cb64-130"><a href="#cb64-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-131"><a href="#cb64-131" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-132"><a href="#cb64-132" aria-hidden="true" tabindex="-1"></a><span class="va">cl_poles</span> <span class="op">=</span> [</span>
<span id="cb64-133"><a href="#cb64-133" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">29</span> <span class="op">+</span> <span class="fl">15i</span></span>
<span id="cb64-134"><a href="#cb64-134" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">29</span> <span class="op">-</span> <span class="fl">15i</span></span>
<span id="cb64-135"><a href="#cb64-135" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">32</span> <span class="op">+</span> <span class="fl">0i</span></span>
<span id="cb64-136"><a href="#cb64-136" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">1.6</span> <span class="op">+</span> <span class="fl">0.76i</span></span>
<span id="cb64-137"><a href="#cb64-137" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">1.6</span> <span class="op">-</span> <span class="fl">0.76i</span></span>
<span id="cb64-138"><a href="#cb64-138" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">1.2</span> <span class="op">+</span> <span class="fl">0i</span>]<span class="op">;</span></span>
<span id="cb64-139"><a href="#cb64-139" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-140"><a href="#cb64-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-141"><a href="#cb64-141" aria-hidden="true" tabindex="-1"></a><span class="va">Use</span> <span class="va">the</span> `<span class="va">PLACE</span>` <span class="kw">function</span> <span class="va">to</span> <span class="va">compute</span> <span class="va">the</span> <span class="va">full</span> <span class="va">state</span> <span class="va">feedback</span> <span class="va">control</span> <span class="va">gain</span> <span class="va">matrix</span><span class="op">,</span> <span class="va">and</span> <span class="va">display</span> <span class="va">our</span> <span class="va">result</span>.</span>
<span id="cb64-142"><a href="#cb64-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-143"><a href="#cb64-143" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-144"><a href="#cb64-144" aria-hidden="true" tabindex="-1"></a><span class="va">G</span> <span class="op">=</span> <span class="va">place</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Bol</span><span class="op">,</span><span class="va">cl_poles</span>)</span>
<span id="cb64-145"><a href="#cb64-145" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-146"><a href="#cb64-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-147"><a href="#cb64-147" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-148"><a href="#cb64-148" aria-hidden="true" tabindex="-1"></a><span class="va">G</span> <span class="op">=</span> <span class="fl">2</span><span class="va">x6</span>    </span>
<span id="cb64-149"><a href="#cb64-149" aria-hidden="true" tabindex="-1"></a><span class="fl">1.0e+03</span> <span class="op">*</span></span>
<span id="cb64-150"><a href="#cb64-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-151"><a href="#cb64-151" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">1.1332</span>   <span class="op">-</span><span class="fl">0.8551</span>    <span class="fl">0.0362</span>    <span class="fl">0.1151</span>    <span class="fl">4.2932</span>    <span class="fl">0.2707</span></span>
<span id="cb64-152"><a href="#cb64-152" aria-hidden="true" tabindex="-1"></a>    <span class="fl">2.4067</span>    <span class="fl">1.7537</span>    <span class="fl">0.4483</span>    <span class="fl">0.1343</span>   <span class="op">-</span><span class="fl">8.6992</span>   <span class="op">-</span><span class="fl">0.3186</span></span>
<span id="cb64-153"><a href="#cb64-153" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-154"><a href="#cb64-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-155"><a href="#cb64-155" aria-hidden="true" tabindex="-1"></a><span class="va">Assume</span> <span class="va">that</span> <span class="va">the</span> <span class="va">actual</span> <span class="va">plant</span> <span class="va">starts</span> <span class="va">with</span> <span class="va">the</span> <span class="va">following</span> <span class="va">initial</span> <span class="va">conditions</span> (<span class="va">NOTE</span><span class="op">:</span> <span class="va">These</span> <span class="va">are</span> <span class="va">NEW</span> <span class="va">IC</span><span class="op">'</span><span class="va">s</span><span class="bn">!!!):</span></span>
<span id="cb64-156"><a href="#cb64-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-157"><a href="#cb64-157" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-158"><a href="#cb64-158" aria-hidden="true" tabindex="-1"></a><span class="va">x0</span> <span class="op">=</span> <span class="op">-</span><span class="fl">2</span><span class="op">;</span>            <span class="co">% meters</span></span>
<span id="cb64-159"><a href="#cb64-159" aria-hidden="true" tabindex="-1"></a><span class="va">x0dot</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span>        <span class="co">% meters/sec</span></span>
<span id="cb64-160"><a href="#cb64-160" aria-hidden="true" tabindex="-1"></a><span class="va">y0</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span>             <span class="co">% meters</span></span>
<span id="cb64-161"><a href="#cb64-161" aria-hidden="true" tabindex="-1"></a><span class="va">y0dot</span> <span class="op">=</span> <span class="fl">0</span><span class="op">;</span>          <span class="co">% meters/sec</span></span>
<span id="cb64-162"><a href="#cb64-162" aria-hidden="true" tabindex="-1"></a><span class="va">theta0</span> <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">;</span>      <span class="co">% radians</span></span>
<span id="cb64-163"><a href="#cb64-163" aria-hidden="true" tabindex="-1"></a><span class="va">theta0dot</span> <span class="op">=</span> <span class="fl">0.1</span><span class="op">;</span>    <span class="co">% radians/sec</span></span>
<span id="cb64-164"><a href="#cb64-164" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-165"><a href="#cb64-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-166"><a href="#cb64-166" aria-hidden="true" tabindex="-1"></a><span class="va">Assume</span> <span class="va">that</span> <span class="va">we</span> <span class="va">have</span> <span class="va">access</span> <span class="va">to</span> <span class="va">the</span> <span class="va">full</span> <span class="va">state</span> <span class="va">vector</span><span class="op">,</span> <span class="va">then</span> <span class="va">construct</span> <span class="va">a</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">LTI</span> <span class="va">object</span> <span class="va">using</span> <span class="va">the</span> <span class="va">feedback</span> <span class="va">gains</span> <span class="va">from</span> <span class="va">above</span>.</span>
<span id="cb64-167"><a href="#cb64-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-168"><a href="#cb64-168" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-169"><a href="#cb64-169" aria-hidden="true" tabindex="-1"></a><span class="va">Acl</span> <span class="op">=</span> <span class="va">Aol</span> <span class="op">-</span> <span class="va">Bol</span><span class="op">*</span><span class="va">G</span></span>
<span id="cb64-170"><a href="#cb64-170" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-171"><a href="#cb64-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-172"><a href="#cb64-172" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-173"><a href="#cb64-173" aria-hidden="true" tabindex="-1"></a><span class="va">Acl</span> <span class="op">=</span> <span class="fl">6</span><span class="va">x6</span>    </span>
<span id="cb64-174"><a href="#cb64-174" aria-hidden="true" tabindex="-1"></a><span class="fl">1.0e+03</span> <span class="op">*</span></span>
<span id="cb64-175"><a href="#cb64-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-176"><a href="#cb64-176" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0</span>    <span class="fl">0.0010</span>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span></span>
<span id="cb64-177"><a href="#cb64-177" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0</span>   <span class="op">-</span><span class="fl">0.0010</span>         <span class="fl">0</span>         <span class="fl">0</span>   <span class="op">-</span><span class="fl">0.0098</span>         <span class="fl">0</span></span>
<span id="cb64-178"><a href="#cb64-178" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span>    <span class="fl">0.0010</span>         <span class="fl">0</span>         <span class="fl">0</span></span>
<span id="cb64-179"><a href="#cb64-179" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">0.1273</span>   <span class="op">-</span><span class="fl">0.0899</span>   <span class="op">-</span><span class="fl">0.0484</span>   <span class="op">-</span><span class="fl">0.0279</span>    <span class="fl">0.4406</span>    <span class="fl">0.0048</span></span>
<span id="cb64-180"><a href="#cb64-180" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span>    <span class="fl">0.0010</span></span>
<span id="cb64-181"><a href="#cb64-181" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.3637</span>    <span class="fl">0.2688</span>    <span class="fl">0.0355</span>   <span class="op">-</span><span class="fl">0.0029</span>   <span class="op">-</span><span class="fl">1.3402</span>   <span class="op">-</span><span class="fl">0.0655</span></span>
<span id="cb64-182"><a href="#cb64-182" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-183"><a href="#cb64-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-184"><a href="#cb64-184" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-185"><a href="#cb64-185" aria-hidden="true" tabindex="-1"></a><span class="va">Ccl</span> <span class="op">=</span> <span class="va">Col</span> <span class="op">-</span> <span class="va">Dol</span><span class="op">*</span><span class="va">G</span></span>
<span id="cb64-186"><a href="#cb64-186" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-187"><a href="#cb64-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-188"><a href="#cb64-188" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-189"><a href="#cb64-189" aria-hidden="true" tabindex="-1"></a><span class="va">Ccl</span> <span class="op">=</span> <span class="fl">3</span><span class="va">x6</span>    </span>
<span id="cb64-190"><a href="#cb64-190" aria-hidden="true" tabindex="-1"></a>     <span class="fl">1</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span></span>
<span id="cb64-191"><a href="#cb64-191" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">1</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span></span>
<span id="cb64-192"><a href="#cb64-192" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">1</span>     <span class="fl">0</span></span>
<span id="cb64-193"><a href="#cb64-193" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-194"><a href="#cb64-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-195"><a href="#cb64-195" aria-hidden="true" tabindex="-1"></a><span class="va">We</span> <span class="va">must</span> <span class="va">augment</span> <span class="va">the</span> <span class="va">output</span> <span class="va">equation</span> <span class="va">to</span> <span class="va">output</span> <span class="va">the</span> <span class="va">original</span> <span class="va">outputs</span> <span class="va">as</span> <span class="va">well</span> <span class="va">as</span> <span class="va">the</span> <span class="va">control</span> <span class="va">signals</span>.</span>
<span id="cb64-196"><a href="#cb64-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-197"><a href="#cb64-197" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-198"><a href="#cb64-198" aria-hidden="true" tabindex="-1"></a><span class="va">Ccl</span> <span class="op">=</span> [<span class="va">Ccl</span><span class="op">;</span> <span class="op">-</span><span class="va">G</span>]</span>
<span id="cb64-199"><a href="#cb64-199" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-200"><a href="#cb64-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-201"><a href="#cb64-201" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-202"><a href="#cb64-202" aria-hidden="true" tabindex="-1"></a><span class="va">Ccl</span> <span class="op">=</span> <span class="fl">5</span><span class="va">x6</span>    </span>
<span id="cb64-203"><a href="#cb64-203" aria-hidden="true" tabindex="-1"></a><span class="fl">1.0e+03</span> <span class="op">*</span></span>
<span id="cb64-204"><a href="#cb64-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-205"><a href="#cb64-205" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0010</span>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span></span>
<span id="cb64-206"><a href="#cb64-206" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0</span>         <span class="fl">0</span>    <span class="fl">0.0010</span>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span></span>
<span id="cb64-207"><a href="#cb64-207" aria-hidden="true" tabindex="-1"></a>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span>         <span class="fl">0</span>    <span class="fl">0.0010</span>         <span class="fl">0</span></span>
<span id="cb64-208"><a href="#cb64-208" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.1332</span>    <span class="fl">0.8551</span>   <span class="op">-</span><span class="fl">0.0362</span>   <span class="op">-</span><span class="fl">0.1151</span>   <span class="op">-</span><span class="fl">4.2932</span>   <span class="op">-</span><span class="fl">0.2707</span></span>
<span id="cb64-209"><a href="#cb64-209" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">2.4067</span>   <span class="op">-</span><span class="fl">1.7537</span>   <span class="op">-</span><span class="fl">0.4483</span>   <span class="op">-</span><span class="fl">0.1343</span>    <span class="fl">8.6992</span>    <span class="fl">0.3186</span></span>
<span id="cb64-210"><a href="#cb64-210" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-211"><a href="#cb64-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-212"><a href="#cb64-212" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-213"><a href="#cb64-213" aria-hidden="true" tabindex="-1"></a><span class="va">CL_sys</span> <span class="op">=</span> <span class="va">ss</span>(<span class="va">Acl</span><span class="op">,</span>[]<span class="op">,</span><span class="va">Ccl</span><span class="op">,</span>[])<span class="op">;</span></span>
<span id="cb64-214"><a href="#cb64-214" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-215"><a href="#cb64-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-216"><a href="#cb64-216" aria-hidden="true" tabindex="-1"></a><span class="va">Simulate</span> <span class="va">the</span> <span class="va">initial</span> <span class="va">value</span> <span class="va">response</span> <span class="va">using</span> `<span class="va">INITIAL</span>`. <span class="va">Choose</span> <span class="va">a</span> <span class="va">final</span> <span class="va">simulation</span> <span class="va">time</span> <span class="va">of</span> <span class="fl">4</span> <span class="va">seconds</span> <span class="kw">for</span> <span class="va">this</span> <span class="va">simulation</span>.</span>
<span id="cb64-217"><a href="#cb64-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-218"><a href="#cb64-218" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-219"><a href="#cb64-219" aria-hidden="true" tabindex="-1"></a><span class="va">t_final</span> <span class="op">=</span> <span class="fl">4</span><span class="op">;</span> <span class="co">% seconds</span></span>
<span id="cb64-220"><a href="#cb64-220" aria-hidden="true" tabindex="-1"></a><span class="va">xinit</span> <span class="op">=</span> [<span class="va">x0</span><span class="op">;</span><span class="va">x0dot</span><span class="op">;</span><span class="va">y0</span><span class="op">;</span><span class="va">y0dot</span><span class="op">;</span><span class="va">theta0</span><span class="op">;</span><span class="va">theta0dot</span>]<span class="op">;</span></span>
<span id="cb64-221"><a href="#cb64-221" aria-hidden="true" tabindex="-1"></a>[<span class="va">y_ivr</span><span class="op">,</span><span class="va">t_ivr</span>] <span class="op">=</span> <span class="va">initial</span>(<span class="va">CL_sys</span><span class="op">,</span><span class="va">xinit</span><span class="op">,</span><span class="va">t_final</span>)<span class="op">;</span></span>
<span id="cb64-222"><a href="#cb64-222" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-223"><a href="#cb64-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-224"><a href="#cb64-224" aria-hidden="true" tabindex="-1"></a><span class="va">Estimate</span> <span class="va">the</span> <span class="fl">5</span><span class="co">% settling times for each output.</span></span>
<span id="cb64-225"><a href="#cb64-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-226"><a href="#cb64-226" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-227"><a href="#cb64-227" aria-hidden="true" tabindex="-1"></a><span class="va">S</span> <span class="op">=</span> <span class="va">lsiminfo</span>(<span class="va">y_ivr</span><span class="op">,</span><span class="va">t_ivr</span><span class="op">,</span><span class="st">"SettlingTimeThreshold"</span><span class="op">,</span><span class="fl">0.05</span>)<span class="op">;</span></span>
<span id="cb64-228"><a href="#cb64-228" aria-hidden="true" tabindex="-1"></a><span class="va">S</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>).<span class="va">TransientTime</span> <span class="co">% Settling times in seconds</span></span>
<span id="cb64-229"><a href="#cb64-229" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-230"><a href="#cb64-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-231"><a href="#cb64-231" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-232"><a href="#cb64-232" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">2.4134</span></span>
<span id="cb64-233"><a href="#cb64-233" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">2.6797</span></span>
<span id="cb64-234"><a href="#cb64-234" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">0.9707</span></span>
<span id="cb64-235"><a href="#cb64-235" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-236"><a href="#cb64-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-237"><a href="#cb64-237" aria-hidden="true" tabindex="-1"></a><span class="va">Generate</span> <span class="va">a</span> <span class="va">plot</span> <span class="va">like</span> <span class="va">what</span> <span class="va">was</span> <span class="va">required</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">Midterm</span> <span class="va">Project</span> <span class="va">with</span> <span class="va">the</span> <span class="va">three</span> <span class="va">outputs</span> <span class="va">on</span> <span class="va">the</span> <span class="va">left</span><span class="op">-</span><span class="va">hand</span> <span class="va">side</span> (<span class="va">separate</span> <span class="va">axes</span> <span class="kw">for</span> <span class="va">each</span> <span class="va">output</span>)<span class="op">,</span> <span class="va">and</span> <span class="va">the</span> <span class="va">control</span> <span class="va">signals</span> <span class="va">on</span> <span class="va">the</span> <span class="va">right</span><span class="op">-</span><span class="va">hand</span> <span class="va">side</span> <span class="va">of</span> <span class="va">the</span> <span class="va">figure</span> (<span class="va">separate</span> <span class="va">axes</span> <span class="kw">for</span> <span class="va">each</span> <span class="va">control</span> <span class="va">signal</span>). <span class="va">Annotate</span> <span class="va">each</span> <span class="va">plot</span> <span class="va">with</span> <span class="va">some</span> <span class="va">kind</span> <span class="va">of</span> <span class="va">marker</span> <span class="kw">for</span> <span class="va">the</span> <span class="fl">5</span><span class="co">% settling times, the min and max allowable control signals, grid lines, axis labels, and units.</span></span>
<span id="cb64-238"><a href="#cb64-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-239"><a href="#cb64-239" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-240"><a href="#cb64-240" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="va">figure</span>()<span class="op">;</span></span>
<span id="cb64-241"><a href="#cb64-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-242"><a href="#cb64-242" aria-hidden="true" tabindex="-1"></a><span class="va">u1_min</span> <span class="op">=</span> <span class="op">-</span><span class="fl">2039</span><span class="op">;</span></span>
<span id="cb64-243"><a href="#cb64-243" aria-hidden="true" tabindex="-1"></a><span class="va">u1_max</span> <span class="op">=</span> <span class="fl">1959</span><span class="op">;</span></span>
<span id="cb64-244"><a href="#cb64-244" aria-hidden="true" tabindex="-1"></a><span class="va">u2_min</span> <span class="op">=</span> <span class="op">-</span><span class="fl">2057.1</span><span class="op">;</span></span>
<span id="cb64-245"><a href="#cb64-245" aria-hidden="true" tabindex="-1"></a><span class="va">u2_max</span> <span class="op">=</span> <span class="fl">1940.9</span><span class="op">;</span></span>
<span id="cb64-246"><a href="#cb64-246" aria-hidden="true" tabindex="-1"></a><span class="va">outputNames</span> <span class="op">=</span> {<span class="ss">'x'</span><span class="op">,</span> <span class="ss">'y'</span><span class="op">,</span> <span class="ss">'\theta'</span><span class="op">,</span> <span class="ss">'u1'</span><span class="op">,</span><span class="ss">'u2'</span>}<span class="op">;</span></span>
<span id="cb64-247"><a href="#cb64-247" aria-hidden="true" tabindex="-1"></a><span class="va">outputUnits</span> <span class="op">=</span> {<span class="ss">'m'</span><span class="op">,</span> <span class="ss">'m'</span><span class="op">,</span> <span class="ss">'rad'</span><span class="op">,</span><span class="ss">'N'</span><span class="op">,</span> <span class="ss">'N'</span>}<span class="op">;</span></span>
<span id="cb64-248"><a href="#cb64-248" aria-hidden="true" tabindex="-1"></a><span class="va">inputNames</span> <span class="op">=</span> {<span class="ss">'u1'</span><span class="op">,</span> <span class="ss">'u2'</span>}<span class="op">;</span></span>
<span id="cb64-249"><a href="#cb64-249" aria-hidden="true" tabindex="-1"></a><span class="va">inputUnits</span> <span class="op">=</span> {<span class="ss">'N'</span><span class="op">,</span> <span class="ss">'N'</span>}<span class="op">;</span></span>
<span id="cb64-250"><a href="#cb64-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-251"><a href="#cb64-251" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb64-252"><a href="#cb64-252" aria-hidden="true" tabindex="-1"></a>    <span class="va">subplot</span>(<span class="fl">3</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span> <span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">i</span>)<span class="op">;</span> <span class="co">% odd numbers for left side</span></span>
<span id="cb64-253"><a href="#cb64-253" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-254"><a href="#cb64-254" aria-hidden="true" tabindex="-1"></a>    <span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span> <span class="va">i</span>))<span class="op">;</span></span>
<span id="cb64-255"><a href="#cb64-255" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-256"><a href="#cb64-256" aria-hidden="true" tabindex="-1"></a>    <span class="va">index</span> <span class="op">=</span> <span class="va">find</span>((<span class="va">t_ivr</span><span class="op">-</span><span class="va">S</span>(<span class="va">i</span>).<span class="va">TransientTime</span>)<span class="op">&gt;</span><span class="fl">0</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb64-257"><a href="#cb64-257" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">index</span><span class="op">&lt;=</span><span class="va">size</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="fl">1</span>)</span>
<span id="cb64-258"><a href="#cb64-258" aria-hidden="true" tabindex="-1"></a>        <span class="va">xline</span>(<span class="va">t_ivr</span>(<span class="va">index</span>)<span class="op">,</span><span class="ss">'--r'</span>)</span>
<span id="cb64-259"><a href="#cb64-259" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb64-260"><a href="#cb64-260" aria-hidden="true" tabindex="-1"></a>    <span class="va">clear</span> <span class="va">index</span></span>
<span id="cb64-261"><a href="#cb64-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-262"><a href="#cb64-262" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span>(<span class="va">sprintf</span>(<span class="ss">'%s'</span><span class="op">,</span> <span class="va">outputNames</span>{<span class="va">i</span>}))<span class="op">;</span></span>
<span id="cb64-263"><a href="#cb64-263" aria-hidden="true" tabindex="-1"></a>    <span class="va">xlabel</span>(<span class="ss">'Time (s)'</span>)<span class="op">;</span></span>
<span id="cb64-264"><a href="#cb64-264" aria-hidden="true" tabindex="-1"></a>    <span class="va">ylabel</span>(<span class="va">sprintf</span>(<span class="ss">'%s'</span><span class="op">,</span> <span class="va">outputUnits</span>{<span class="va">i</span>}))<span class="op">;</span></span>
<span id="cb64-265"><a href="#cb64-265" aria-hidden="true" tabindex="-1"></a>    <span class="va">grid</span> <span class="va">on</span></span>
<span id="cb64-266"><a href="#cb64-266" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb64-267"><a href="#cb64-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-268"><a href="#cb64-268" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span></span>
<span id="cb64-269"><a href="#cb64-269" aria-hidden="true" tabindex="-1"></a>    <span class="va">subplot</span>(<span class="fl">2</span><span class="op">,</span> <span class="fl">2</span><span class="op">,</span> <span class="va">i</span><span class="op">*</span><span class="fl">2</span>)<span class="op">;</span> <span class="co">% even numbers for right side</span></span>
<span id="cb64-270"><a href="#cb64-270" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-271"><a href="#cb64-271" aria-hidden="true" tabindex="-1"></a>    <span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span> <span class="va">i</span><span class="op">+</span><span class="fl">3</span>))<span class="op">;</span> <span class="co">% 4 and 5 for u1 and u2</span></span>
<span id="cb64-272"><a href="#cb64-272" aria-hidden="true" tabindex="-1"></a>    <span class="va">ylim</span>([<span class="op">-</span><span class="fl">2500</span><span class="op">,</span><span class="fl">2500</span>])</span>
<span id="cb64-273"><a href="#cb64-273" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">i</span> <span class="op">==</span> <span class="fl">1</span></span>
<span id="cb64-274"><a href="#cb64-274" aria-hidden="true" tabindex="-1"></a>        <span class="va">yline</span>(<span class="va">double</span>(<span class="va">u1_max</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-275"><a href="#cb64-275" aria-hidden="true" tabindex="-1"></a>        <span class="va">yline</span>(<span class="va">double</span>(<span class="va">u1_min</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-276"><a href="#cb64-276" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb64-277"><a href="#cb64-277" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">i</span> <span class="op">==</span> <span class="fl">2</span></span>
<span id="cb64-278"><a href="#cb64-278" aria-hidden="true" tabindex="-1"></a>        <span class="va">yline</span>(<span class="va">double</span>(<span class="va">u2_max</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-279"><a href="#cb64-279" aria-hidden="true" tabindex="-1"></a>        <span class="va">yline</span>(<span class="va">double</span>(<span class="va">u2_min</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-280"><a href="#cb64-280" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb64-281"><a href="#cb64-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-282"><a href="#cb64-282" aria-hidden="true" tabindex="-1"></a>    <span class="va">title</span>(<span class="va">sprintf</span>(<span class="ss">'%s'</span><span class="op">,</span> <span class="va">inputNames</span>{(<span class="va">i</span>)}))<span class="op">;</span></span>
<span id="cb64-283"><a href="#cb64-283" aria-hidden="true" tabindex="-1"></a>    <span class="va">xlabel</span>(<span class="ss">'Time (s)'</span>)<span class="op">;</span></span>
<span id="cb64-284"><a href="#cb64-284" aria-hidden="true" tabindex="-1"></a>    <span class="va">ylabel</span>(<span class="va">sprintf</span>(<span class="ss">'%s'</span><span class="op">,</span> <span class="va">inputUnits</span>{(<span class="va">i</span>)}))<span class="op">;</span></span>
<span id="cb64-285"><a href="#cb64-285" aria-hidden="true" tabindex="-1"></a>    <span class="va">grid</span> <span class="va">on</span></span>
<span id="cb64-286"><a href="#cb64-286" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-287"><a href="#cb64-287" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb64-288"><a href="#cb64-288" aria-hidden="true" tabindex="-1"></a><span class="co">% Adjust the overall plot title</span></span>
<span id="cb64-289"><a href="#cb64-289" aria-hidden="true" tabindex="-1"></a><span class="va">sgtitle</span>(<span class="ss">'Initial Response for Outputs (left) &amp; Inputs (right)'</span>)<span class="op">;</span></span>
<span id="cb64-290"><a href="#cb64-290" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="va">f</span><span class="op">,</span><span class="st">"Position"</span><span class="op">,</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">800</span> <span class="fl">800</span>])</span>
<span id="cb64-291"><a href="#cb64-291" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-292"><a href="#cb64-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-293"><a href="#cb64-293" aria-hidden="true" tabindex="-1"></a><span class="bn">![](Full_State_Feedback_Control_Design_media/figure_0.png)</span></span>
<span id="cb64-294"><a href="#cb64-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-295"><a href="#cb64-295" aria-hidden="true" tabindex="-1"></a><span class="va">In</span> <span class="va">addition</span> <span class="va">to</span> <span class="va">the</span> <span class="va">normal</span> <span class="va">five</span> <span class="va">subplot</span> <span class="va">figure</span><span class="op">,</span> <span class="va">we</span> <span class="va">must</span> <span class="va">also</span> <span class="va">include</span> <span class="va">the</span> <span class="va">animation</span> <span class="va">plot</span> <span class="va">in</span> <span class="va">the</span> <span class="va">LiveScript</span> <span class="va">as</span> <span class="va">documentation</span> <span class="va">of</span> <span class="va">the</span> <span class="va">performance</span>.</span>
<span id="cb64-296"><a href="#cb64-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-297"><a href="#cb64-297" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-298"><a href="#cb64-298" aria-hidden="true" tabindex="-1"></a><span class="va">als_f23_animate</span>( <span class="va">t_ivr</span><span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">2</span>)<span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">3</span>))<span class="op">;</span></span>
<span id="cb64-299"><a href="#cb64-299" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-300"><a href="#cb64-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-301"><a href="#cb64-301" aria-hidden="true" tabindex="-1"></a># <span class="va">CASE</span> <span class="fl">3</span>. <span class="va">Evaluate</span> <span class="va">Observability</span></span>
<span id="cb64-302"><a href="#cb64-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-303"><a href="#cb64-303" aria-hidden="true" tabindex="-1"></a><span class="va">First</span> <span class="va">show</span> <span class="va">that</span> <span class="va">this</span> <span class="va">system</span> <span class="va">is</span> <span class="va">completely</span> <span class="va">observable</span> <span class="va">using</span> <span class="va">all</span> <span class="va">three</span> <span class="va">outputs</span>.</span>
<span id="cb64-304"><a href="#cb64-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-305"><a href="#cb64-305" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-306"><a href="#cb64-306" aria-hidden="true" tabindex="-1"></a><span class="va">Ob</span> <span class="op">=</span> <span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>)<span class="op">;</span></span>
<span id="cb64-307"><a href="#cb64-307" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">Ob</span>)</span>
<span id="cb64-308"><a href="#cb64-308" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-309"><a href="#cb64-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-310"><a href="#cb64-310" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-311"><a href="#cb64-311" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">6</span></span>
<span id="cb64-312"><a href="#cb64-312" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-313"><a href="#cb64-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-314"><a href="#cb64-314" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-315"><a href="#cb64-315" aria-hidden="true" tabindex="-1"></a><span class="va">N</span></span>
<span id="cb64-316"><a href="#cb64-316" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-317"><a href="#cb64-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-318"><a href="#cb64-318" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-319"><a href="#cb64-319" aria-hidden="true" tabindex="-1"></a><span class="va">N</span> <span class="op">=</span> <span class="fl">6</span></span>
<span id="cb64-320"><a href="#cb64-320" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-321"><a href="#cb64-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-322"><a href="#cb64-322" aria-hidden="true" tabindex="-1"></a><span class="va">Rank</span> <span class="va">of</span> <span class="va">observability</span> <span class="va">matrix</span> <span class="va">is</span> <span class="va">equal</span> <span class="va">to</span> <span class="va">number</span> <span class="va">of</span> <span class="va">states</span>.</span>
<span id="cb64-323"><a href="#cb64-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-324"><a href="#cb64-324" aria-hidden="true" tabindex="-1"></a><span class="va">Then</span> <span class="va">we</span> <span class="va">determine</span> <span class="va">whether</span> <span class="va">this</span> <span class="va">system</span> <span class="va">is</span> <span class="va">completely</span> <span class="va">observable</span> <span class="va">using</span> <span class="va">any</span> <span class="va">subset</span> <span class="va">of</span> <span class="va">outputs</span> <span class="va">and</span> <span class="va">justify</span> <span class="va">our</span> <span class="va">answers</span>.</span>
<span id="cb64-325"><a href="#cb64-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-326"><a href="#cb64-326" aria-hidden="true" tabindex="-1"></a><span class="va">For</span> <span class="va">individual</span> <span class="va">outputs</span></span>
<span id="cb64-327"><a href="#cb64-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-328"><a href="#cb64-328" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-329"><a href="#cb64-329" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>(<span class="fl">1</span><span class="op">,:</span>)))</span>
<span id="cb64-330"><a href="#cb64-330" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-331"><a href="#cb64-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-332"><a href="#cb64-332" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-333"><a href="#cb64-333" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb64-334"><a href="#cb64-334" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-335"><a href="#cb64-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-336"><a href="#cb64-336" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-337"><a href="#cb64-337" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>(<span class="fl">2</span><span class="op">,:</span>)))</span>
<span id="cb64-338"><a href="#cb64-338" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-339"><a href="#cb64-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-340"><a href="#cb64-340" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-341"><a href="#cb64-341" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb64-342"><a href="#cb64-342" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-343"><a href="#cb64-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-344"><a href="#cb64-344" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-345"><a href="#cb64-345" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>(<span class="fl">3</span><span class="op">,:</span>)))</span>
<span id="cb64-346"><a href="#cb64-346" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-347"><a href="#cb64-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-348"><a href="#cb64-348" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-349"><a href="#cb64-349" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">2</span></span>
<span id="cb64-350"><a href="#cb64-350" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-351"><a href="#cb64-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-352"><a href="#cb64-352" aria-hidden="true" tabindex="-1"></a><span class="va">None</span> <span class="va">of</span> <span class="va">the</span> <span class="va">individual</span> <span class="va">outputs</span> <span class="va">obs</span> <span class="va">matrices</span> <span class="va">are</span> <span class="va">full</span> <span class="va">rank</span></span>
<span id="cb64-353"><a href="#cb64-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-354"><a href="#cb64-354" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-355"><a href="#cb64-355" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>([<span class="fl">1</span> <span class="fl">2</span>]<span class="op">,:</span>)))</span>
<span id="cb64-356"><a href="#cb64-356" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-357"><a href="#cb64-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-358"><a href="#cb64-358" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-359"><a href="#cb64-359" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">6</span></span>
<span id="cb64-360"><a href="#cb64-360" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-361"><a href="#cb64-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-362"><a href="#cb64-362" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-363"><a href="#cb64-363" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>([<span class="fl">1</span> <span class="fl">3</span>]<span class="op">,:</span>)))</span>
<span id="cb64-364"><a href="#cb64-364" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-365"><a href="#cb64-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-366"><a href="#cb64-366" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-367"><a href="#cb64-367" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb64-368"><a href="#cb64-368" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-369"><a href="#cb64-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-370"><a href="#cb64-370" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-371"><a href="#cb64-371" aria-hidden="true" tabindex="-1"></a><span class="va">rank</span>(<span class="va">obsv</span>(<span class="va">Aol</span><span class="op">,</span><span class="va">Col</span>([<span class="fl">2</span> <span class="fl">3</span>]<span class="op">,:</span>)))</span>
<span id="cb64-372"><a href="#cb64-372" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-373"><a href="#cb64-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-374"><a href="#cb64-374" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-375"><a href="#cb64-375" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb64-376"><a href="#cb64-376" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-377"><a href="#cb64-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-378"><a href="#cb64-378" aria-hidden="true" tabindex="-1"></a><span class="va">We</span> <span class="va">can</span> <span class="va">see</span> <span class="va">that</span> <span class="va">the</span> <span class="va">combination</span> <span class="va">of</span> <span class="va">ouput</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="fl">2</span> (<span class="va">x</span> <span class="op">&amp;</span> <span class="va">y</span>)<span class="op">,</span> <span class="va">has</span> <span class="va">a</span> <span class="va">obs</span> <span class="va">matrix</span> <span class="va">which</span> <span class="va">is</span> <span class="va">full</span> <span class="va">rank</span> <span class="va">meaning</span> <span class="va">the</span> <span class="va">system</span> <span class="va">is</span> <span class="va">obervable</span> <span class="va">using</span> <span class="va">just</span> <span class="va">there</span> <span class="fl">2</span> <span class="va">outputs</span>.</span>
<span id="cb64-379"><a href="#cb64-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-380"><a href="#cb64-380" aria-hidden="true" tabindex="-1"></a># <span class="va">CASE</span> <span class="fl">4</span>. <span class="va">Design</span> <span class="va">a</span> <span class="va">Full</span><span class="op">-</span><span class="va">Order</span> <span class="va">Luenberger</span> <span class="va">Observer</span></span>
<span id="cb64-381"><a href="#cb64-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-382"><a href="#cb64-382" aria-hidden="true" tabindex="-1"></a><span class="va">In</span> <span class="va">this</span> <span class="va">CASE</span><span class="op">,</span> <span class="va">we</span> <span class="va">will</span> <span class="va">compute</span> <span class="va">the</span> <span class="va">gains</span> <span class="kw">for</span> <span class="va">a</span> <span class="va">state</span> <span class="va">estimator</span> <span class="va">using</span> <span class="va">all</span> <span class="va">three</span> <span class="va">outputs</span>. <span class="va">We</span> <span class="va">must</span> <span class="va">first</span> <span class="va">choose</span> <span class="va">appropriate</span> <span class="va">pole</span> <span class="va">locations</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">state</span> <span class="va">estimator</span> (<span class="va">observer</span>)<span class="op">,</span> <span class="va">and</span> <span class="va">then</span> <span class="va">compute</span> <span class="va">and</span> <span class="va">display</span> <span class="va">the</span> <span class="va">associated</span> <span class="va">feedback</span> <span class="va">gain</span> <span class="va">matrix</span> <span class="va">using</span> <span class="va">the</span> `<span class="va">PLACE</span>` <span class="kw">function</span>.</span>
<span id="cb64-383"><a href="#cb64-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-384"><a href="#cb64-384" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-385"><a href="#cb64-385" aria-hidden="true" tabindex="-1"></a><span class="va">alpha</span> <span class="op">=</span> <span class="fl">1.5</span><span class="op">;</span></span>
<span id="cb64-386"><a href="#cb64-386" aria-hidden="true" tabindex="-1"></a><span class="va">obs_poles</span> <span class="op">=</span> <span class="va">alpha</span><span class="op">*</span><span class="va">cl_poles</span><span class="op">;</span><span class="co">% alpha &gt; 1 is faster observer than controller</span></span>
<span id="cb64-387"><a href="#cb64-387" aria-hidden="true" tabindex="-1"></a><span class="va">K</span> <span class="op">=</span> <span class="va">place</span>(<span class="va">Aol</span><span class="op">.',</span><span class="va">Col</span><span class="op">.',</span><span class="va">obs_poles</span>)<span class="op">.'</span></span>
<span id="cb64-388"><a href="#cb64-388" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-389"><a href="#cb64-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-390"><a href="#cb64-390" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-391"><a href="#cb64-391" aria-hidden="true" tabindex="-1"></a><span class="va">K</span> <span class="op">=</span> <span class="fl">6</span><span class="va">x3</span>    </span>
<span id="cb64-392"><a href="#cb64-392" aria-hidden="true" tabindex="-1"></a>   <span class="fl">47.0621</span>   <span class="fl">11.3921</span>  <span class="op">-</span><span class="fl">12.6548</span></span>
<span id="cb64-393"><a href="#cb64-393" aria-hidden="true" tabindex="-1"></a>   <span class="fl">59.1867</span>  <span class="op">-</span><span class="fl">53.1150</span>   <span class="fl">13.2504</span></span>
<span id="cb64-394"><a href="#cb64-394" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">6.5959</span>   <span class="fl">78.7139</span>  <span class="op">-</span><span class="fl">41.1033</span></span>
<span id="cb64-395"><a href="#cb64-395" aria-hidden="true" tabindex="-1"></a>   <span class="fl">63.5968</span>    <span class="fl">2.2363</span>   <span class="op">-</span><span class="fl">0.7294</span></span>
<span id="cb64-396"><a href="#cb64-396" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">5.7511</span>   <span class="fl">40.1340</span>   <span class="fl">10.2240</span></span>
<span id="cb64-397"><a href="#cb64-397" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.9765</span>   <span class="op">-</span><span class="fl">0.8166</span>    <span class="fl">6.4001</span></span>
<span id="cb64-398"><a href="#cb64-398" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-399"><a href="#cb64-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-400"><a href="#cb64-400" aria-hidden="true" tabindex="-1"></a><span class="va">To</span> <span class="va">document</span> <span class="va">our</span> <span class="va">design</span><span class="op">,</span> <span class="va">we</span> <span class="va">must</span> <span class="va">generate</span> <span class="va">a</span> <span class="va">plot</span> <span class="va">that</span> <span class="va">includes</span> <span class="va">the</span> <span class="va">open</span><span class="op">-</span><span class="va">loop</span> <span class="va">poles</span> <span class="va">from</span> <span class="va">CASE</span> <span class="fl">1</span><span class="op">,</span> <span class="va">the</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">poles</span> <span class="va">from</span> <span class="va">CASE</span> <span class="fl">2</span><span class="op">,</span> <span class="va">and</span> <span class="va">observer</span> <span class="va">poles</span> <span class="va">from</span> <span class="va">this</span> <span class="va">CASE</span>. <span class="va">Use</span> <span class="va">common</span> <span class="va">markers</span> <span class="kw">for</span> <span class="va">each</span> <span class="va">set</span> <span class="va">of</span> <span class="va">poles</span> (<span class="va">i</span>.<span class="va">e</span>. <span class="va">all</span> <span class="va">open</span><span class="op">-</span><span class="va">loop</span> <span class="va">poles</span> <span class="va">must</span> <span class="va">use</span> <span class="va">the</span> <span class="va">same</span> <span class="va">marker</span><span class="op">,</span> <span class="va">etc</span>.) <span class="va">so</span> <span class="va">that</span> <span class="va">it</span> <span class="va">is</span> <span class="va">easy</span> <span class="va">to</span> <span class="va">distinguish</span> <span class="va">the</span> <span class="va">poles</span> <span class="va">on</span> <span class="va">the</span> <span class="va">figure</span>. <span class="va">Include</span> <span class="va">a</span> <span class="va">legend</span> <span class="va">that</span> <span class="va">only</span> <span class="va">has</span> <span class="va">three</span> <span class="va">entries</span> <span class="va">in</span> <span class="va">it</span> (<span class="va">open</span><span class="op">-</span><span class="va">loop</span><span class="op">,</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span><span class="op">,</span> <span class="va">observer</span>)<span class="op">,</span> <span class="va">corresponding</span> <span class="va">to</span> <span class="va">the</span> <span class="va">three</span> <span class="va">sets</span> <span class="va">of</span> <span class="va">poles</span>. <span class="va">We</span> <span class="va">must</span> <span class="va">use</span> <span class="va">the</span> `<span class="va">SGRID</span>` <span class="kw">function</span> (<span class="va">read</span> <span class="va">the</span> <span class="va">Matlab</span> <span class="va">help</span><span class="bn">!!) to generate appropriate grid lines. We will also annotate our plot with axis labels. Making sure our legend does not cover up any of the poles!</span></span>
<span id="cb64-401"><a href="#cb64-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-402"><a href="#cb64-402" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-403"><a href="#cb64-403" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="va">figure</span><span class="op">;</span></span>
<span id="cb64-404"><a href="#cb64-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-405"><a href="#cb64-405" aria-hidden="true" tabindex="-1"></a><span class="va">wmax</span> <span class="op">=</span> <span class="va">round</span>(<span class="va">max</span>(<span class="va">abs</span>([<span class="va">cl_poles</span><span class="op">;</span><span class="va">ol_poles</span><span class="op">;</span><span class="va">obs_poles</span>])))<span class="op">;</span></span>
<span id="cb64-406"><a href="#cb64-406" aria-hidden="true" tabindex="-1"></a><span class="va">sgrid</span>(<span class="fl">0</span><span class="op">:</span><span class="fl">0.1</span><span class="op">:</span><span class="fl">0.9</span><span class="op">,</span><span class="fl">0</span><span class="op">:</span><span class="va">wmax</span><span class="op">/</span><span class="fl">5</span><span class="op">:</span><span class="va">wmax</span><span class="op">*</span><span class="fl">1.5</span><span class="op">,</span><span class="st">"new"</span>)</span>
<span id="cb64-407"><a href="#cb64-407" aria-hidden="true" tabindex="-1"></a><span class="va">h1</span> <span class="op">=</span> <span class="va">plot</span>(<span class="va">real</span>(<span class="va">ol_poles</span>)<span class="op">,</span><span class="va">imag</span>(<span class="va">ol_poles</span>)<span class="op">,</span><span class="ss">'bx'</span><span class="op">,</span><span class="ss">'markersize'</span><span class="op">,</span><span class="fl">10</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb64-408"><a href="#cb64-408" aria-hidden="true" tabindex="-1"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb64-409"><a href="#cb64-409" aria-hidden="true" tabindex="-1"></a><span class="va">h2</span> <span class="op">=</span> <span class="va">plot</span>(<span class="va">real</span>(<span class="va">cl_poles</span>)<span class="op">,</span><span class="va">imag</span>(<span class="va">cl_poles</span>)<span class="op">,</span><span class="ss">'gs'</span><span class="op">,</span><span class="ss">'markersize'</span><span class="op">,</span><span class="fl">10</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb64-410"><a href="#cb64-410" aria-hidden="true" tabindex="-1"></a><span class="va">h3</span> <span class="op">=</span> <span class="va">plot</span>(<span class="va">real</span>(<span class="va">obs_poles</span>)<span class="op">,</span><span class="va">imag</span>(<span class="va">obs_poles</span>)<span class="op">,</span><span class="ss">'rd'</span><span class="op">,</span><span class="ss">'markersize'</span><span class="op">,</span><span class="fl">10</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb64-411"><a href="#cb64-411" aria-hidden="true" tabindex="-1"></a><span class="va">xlabel</span>(<span class="ss">'Real (s)'</span>)</span>
<span id="cb64-412"><a href="#cb64-412" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'Imag (s)'</span>)</span>
<span id="cb64-413"><a href="#cb64-413" aria-hidden="true" tabindex="-1"></a><span class="va">xline</span>(<span class="fl">0</span><span class="op">,</span><span class="ss">'m'</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb64-414"><a href="#cb64-414" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="fl">0</span><span class="op">,</span><span class="ss">'m'</span><span class="op">,</span><span class="ss">'linewidth'</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb64-415"><a href="#cb64-415" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>([<span class="va">h1</span><span class="op">,</span><span class="va">h2</span><span class="op">,</span><span class="va">h3</span>]<span class="op">,</span><span class="ss">'open loop'</span><span class="op">,</span><span class="ss">'closed loop'</span><span class="op">,</span><span class="ss">'estimator'</span>)<span class="op">;</span></span>
<span id="cb64-416"><a href="#cb64-416" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="va">f</span><span class="op">,</span><span class="st">"Position"</span><span class="op">,</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">600</span> <span class="fl">600</span>])</span>
<span id="cb64-417"><a href="#cb64-417" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="va">gca</span><span class="op">,</span><span class="ss">'yaxislocation'</span><span class="op">,</span><span class="ss">'right'</span>)</span>
<span id="cb64-418"><a href="#cb64-418" aria-hidden="true" tabindex="-1"></a><span class="va">axis</span> <span class="va">equal</span></span>
<span id="cb64-419"><a href="#cb64-419" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-420"><a href="#cb64-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-421"><a href="#cb64-421" aria-hidden="true" tabindex="-1"></a><span class="bn">![](Full_State_Feedback_Control_Design_media/figure_1.png)</span></span>
<span id="cb64-422"><a href="#cb64-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-423"><a href="#cb64-423" aria-hidden="true" tabindex="-1"></a># <span class="va">CASE</span> <span class="fl">5</span>. <span class="va">Simulate</span> <span class="va">Output</span> <span class="va">Feedback</span> <span class="va">Control</span></span>
<span id="cb64-424"><a href="#cb64-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-425"><a href="#cb64-425" aria-hidden="true" tabindex="-1"></a><span class="va">For</span> <span class="va">this</span> <span class="va">CASE</span><span class="op">,</span> <span class="va">we</span> <span class="va">must</span> <span class="va">simulate</span> <span class="va">the</span> <span class="va">complete</span> <span class="va">output</span> <span class="va">feedback</span> <span class="va">control</span> <span class="va">system</span><span class="op">,</span> <span class="va">which</span> <span class="va">will</span> <span class="va">include</span> <span class="va">the</span> <span class="va">state</span> <span class="va">estimator</span> <span class="va">and</span> <span class="va">full</span> <span class="va">state</span> <span class="va">feedback</span> <span class="va">using</span> <span class="va">the</span> <span class="va">estimated</span> <span class="va">states</span>.</span>
<span id="cb64-426"><a href="#cb64-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-427"><a href="#cb64-427" aria-hidden="true" tabindex="-1"></a><span class="va">Using</span> <span class="va">the</span> <span class="va">equations</span> <span class="kw">for</span> <span class="va">obersever</span> <span class="va">followed</span> <span class="va">by</span> <span class="va">controller</span> <span class="va">we</span> <span class="va">can</span> <span class="va">find</span><span class="op">,</span> (<span class="va">L14</span><span class="op">/</span><span class="va">S29</span>)</span>
<span id="cb64-428"><a href="#cb64-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-429"><a href="#cb64-429" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-430"><a href="#cb64-430" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">c</span>}</span>
<span id="cb64-431"><a href="#cb64-431" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">dot</span>{<span class="va">x</span>} <span class="op">\\</span></span>
<span id="cb64-432"><a href="#cb64-432" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">dot</span>{<span class="op">\</span><span class="va">hat</span>{<span class="va">x</span>} } </span>
<span id="cb64-433"><a href="#cb64-433" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span> <span class="op">=\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">cc</span>}</span>
<span id="cb64-434"><a href="#cb64-434" aria-hidden="true" tabindex="-1"></a><span class="va">A</span> <span class="op">&amp;</span> <span class="op">-</span><span class="va">B</span><span class="op">\;</span><span class="va">G</span><span class="op">\\</span></span>
<span id="cb64-435"><a href="#cb64-435" aria-hidden="true" tabindex="-1"></a><span class="va">K</span><span class="op">\;</span><span class="va">C</span> <span class="op">&amp;</span> <span class="op">\</span><span class="va">hat</span>{<span class="va">A</span>} <span class="op">-</span><span class="va">K</span><span class="op">\</span><span class="va">hat</span>{<span class="va">C</span>} <span class="op">-\</span><span class="va">hat</span>{<span class="va">B</span><span class="op">\;</span>} <span class="va">G</span><span class="op">-</span><span class="va">K</span><span class="op">\</span><span class="va">left</span>(<span class="va">D</span><span class="op">-\</span><span class="va">hat</span>{<span class="va">D</span>} <span class="op">\</span><span class="va">right</span>)<span class="va">G</span></span>
<span id="cb64-436"><a href="#cb64-436" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span> <span class="op">\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">c</span>}</span>
<span id="cb64-437"><a href="#cb64-437" aria-hidden="true" tabindex="-1"></a><span class="va">x</span><span class="op">\\</span></span>
<span id="cb64-438"><a href="#cb64-438" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">hat</span>{<span class="va">x</span>} </span>
<span id="cb64-439"><a href="#cb64-439" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span></span>
<span id="cb64-440"><a href="#cb64-440" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-441"><a href="#cb64-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-442"><a href="#cb64-442" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-443"><a href="#cb64-443" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">c</span>}</span>
<span id="cb64-444"><a href="#cb64-444" aria-hidden="true" tabindex="-1"></a><span class="va">y</span><span class="op">\\</span></span>
<span id="cb64-445"><a href="#cb64-445" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">hat</span>{<span class="va">y</span>} </span>
<span id="cb64-446"><a href="#cb64-446" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span> <span class="op">=\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">cc</span>}</span>
<span id="cb64-447"><a href="#cb64-447" aria-hidden="true" tabindex="-1"></a><span class="va">C</span> <span class="op">&amp;</span> <span class="op">-</span><span class="va">D</span><span class="op">\;</span><span class="va">G</span><span class="op">\\</span></span>
<span id="cb64-448"><a href="#cb64-448" aria-hidden="true" tabindex="-1"></a><span class="fl">0</span> <span class="op">&amp;</span> <span class="op">\</span><span class="va">hat</span>{<span class="va">C</span>} <span class="op">-\</span><span class="va">hat</span>{<span class="va">D</span>} <span class="op">\;</span><span class="va">G</span></span>
<span id="cb64-449"><a href="#cb64-449" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span> <span class="op">\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">c</span>}</span>
<span id="cb64-450"><a href="#cb64-450" aria-hidden="true" tabindex="-1"></a><span class="va">x</span><span class="op">\\</span></span>
<span id="cb64-451"><a href="#cb64-451" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">hat</span>{<span class="va">x</span>} </span>
<span id="cb64-452"><a href="#cb64-452" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span></span>
<span id="cb64-453"><a href="#cb64-453" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-454"><a href="#cb64-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-455"><a href="#cb64-455" aria-hidden="true" tabindex="-1"></a><span class="va">Assumuing</span><span class="op">,</span></span>
<span id="cb64-456"><a href="#cb64-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-457"><a href="#cb64-457" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-458"><a href="#cb64-458" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">hat</span>{<span class="va">A</span>} <span class="op">=</span><span class="va">A</span><span class="op">\;\;\;\;\;\;\;\;\;\;\;\;\</span><span class="va">hat</span>{<span class="va">B</span>} <span class="op">=</span><span class="va">B</span><span class="op">\;\;\;\;\;\;\;\;\;\;\;\;\</span><span class="va">hat</span>{<span class="va">C</span>} <span class="op">=</span><span class="va">C</span><span class="op">\;\;\;\;\;\;\;\;\;\;\;\;\</span><span class="va">hat</span>{<span class="va">D</span>} <span class="op">=</span><span class="va">D</span></span>
<span id="cb64-459"><a href="#cb64-459" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-460"><a href="#cb64-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-461"><a href="#cb64-461" aria-hidden="true" tabindex="-1"></a><span class="va">We</span> <span class="va">can</span> <span class="va">simplify</span> <span class="va">as</span><span class="op">,</span></span>
<span id="cb64-462"><a href="#cb64-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-463"><a href="#cb64-463" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-464"><a href="#cb64-464" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">c</span>}</span>
<span id="cb64-465"><a href="#cb64-465" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">dot</span>{<span class="va">x</span>} <span class="op">\\</span></span>
<span id="cb64-466"><a href="#cb64-466" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">dot</span>{<span class="op">\</span><span class="va">hat</span>{<span class="va">x</span>} } </span>
<span id="cb64-467"><a href="#cb64-467" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span> <span class="op">=\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">cc</span>}</span>
<span id="cb64-468"><a href="#cb64-468" aria-hidden="true" tabindex="-1"></a><span class="va">A</span> <span class="op">&amp;</span> <span class="op">-</span><span class="va">B</span><span class="op">\;</span><span class="va">G</span><span class="op">\\</span></span>
<span id="cb64-469"><a href="#cb64-469" aria-hidden="true" tabindex="-1"></a><span class="va">K</span><span class="op">\;</span><span class="va">C</span> <span class="op">&amp;</span> <span class="va">A</span><span class="op">-</span><span class="va">K</span><span class="op">\;</span><span class="va">C</span><span class="op">-</span><span class="va">B</span><span class="op">\;</span><span class="va">G</span></span>
<span id="cb64-470"><a href="#cb64-470" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span> <span class="op">\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">c</span>}</span>
<span id="cb64-471"><a href="#cb64-471" aria-hidden="true" tabindex="-1"></a><span class="va">x</span><span class="op">\\</span></span>
<span id="cb64-472"><a href="#cb64-472" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">hat</span>{<span class="va">x</span>} </span>
<span id="cb64-473"><a href="#cb64-473" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span></span>
<span id="cb64-474"><a href="#cb64-474" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-475"><a href="#cb64-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-476"><a href="#cb64-476" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-477"><a href="#cb64-477" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">c</span>}</span>
<span id="cb64-478"><a href="#cb64-478" aria-hidden="true" tabindex="-1"></a><span class="va">y</span><span class="op">\\</span></span>
<span id="cb64-479"><a href="#cb64-479" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">hat</span>{<span class="va">y</span>} </span>
<span id="cb64-480"><a href="#cb64-480" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span> <span class="op">=\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">cc</span>}</span>
<span id="cb64-481"><a href="#cb64-481" aria-hidden="true" tabindex="-1"></a><span class="va">C</span> <span class="op">&amp;</span> <span class="op">-</span><span class="va">D</span><span class="op">\;</span><span class="va">G</span><span class="op">\\</span></span>
<span id="cb64-482"><a href="#cb64-482" aria-hidden="true" tabindex="-1"></a><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">C</span><span class="op">-</span><span class="va">D</span><span class="op">\;</span><span class="va">G</span></span>
<span id="cb64-483"><a href="#cb64-483" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span> <span class="op">\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">c</span>}</span>
<span id="cb64-484"><a href="#cb64-484" aria-hidden="true" tabindex="-1"></a><span class="va">x</span><span class="op">\\</span></span>
<span id="cb64-485"><a href="#cb64-485" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">hat</span>{<span class="va">x</span>} </span>
<span id="cb64-486"><a href="#cb64-486" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span></span>
<span id="cb64-487"><a href="#cb64-487" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-488"><a href="#cb64-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-489"><a href="#cb64-489" aria-hidden="true" tabindex="-1"></a><span class="va">Augmenting</span> <span class="va">to</span> <span class="va">get</span> <span class="va">back</span> <span class="va">u</span> <span class="va">to</span> <span class="va">plot</span><span class="op">,</span></span>
<span id="cb64-490"><a href="#cb64-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-491"><a href="#cb64-491" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-492"><a href="#cb64-492" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">begin</span>{<span class="va">bmatrix</span>}</span>
<span id="cb64-493"><a href="#cb64-493" aria-hidden="true" tabindex="-1"></a><span class="va">y</span> <span class="op">\\</span></span>
<span id="cb64-494"><a href="#cb64-494" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">hat</span>{<span class="va">y</span>} <span class="op">\\</span></span>
<span id="cb64-495"><a href="#cb64-495" aria-hidden="true" tabindex="-1"></a><span class="va">u</span></span>
<span id="cb64-496"><a href="#cb64-496" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">bmatrix</span>}</span>
<span id="cb64-497"><a href="#cb64-497" aria-hidden="true" tabindex="-1"></a><span class="op">=</span></span>
<span id="cb64-498"><a href="#cb64-498" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">begin</span>{<span class="va">bmatrix</span>}</span>
<span id="cb64-499"><a href="#cb64-499" aria-hidden="true" tabindex="-1"></a><span class="va">C</span> <span class="op">&amp;</span> <span class="op">-</span><span class="va">DG</span> <span class="op">\\</span></span>
<span id="cb64-500"><a href="#cb64-500" aria-hidden="true" tabindex="-1"></a><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">C</span><span class="op">-</span><span class="va">DG</span> <span class="op">\\</span></span>
<span id="cb64-501"><a href="#cb64-501" aria-hidden="true" tabindex="-1"></a><span class="fl">0</span> <span class="op">&amp;</span> <span class="op">-</span><span class="va">G</span></span>
<span id="cb64-502"><a href="#cb64-502" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">bmatrix</span>}</span>
<span id="cb64-503"><a href="#cb64-503" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">begin</span>{<span class="va">bmatrix</span>}</span>
<span id="cb64-504"><a href="#cb64-504" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> <span class="op">\\</span></span>
<span id="cb64-505"><a href="#cb64-505" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">hat</span>{<span class="va">x</span>}</span>
<span id="cb64-506"><a href="#cb64-506" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="kw">end</span>{<span class="va">bmatrix</span>}</span>
<span id="cb64-507"><a href="#cb64-507" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-508"><a href="#cb64-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-509"><a href="#cb64-509" aria-hidden="true" tabindex="-1"></a><span class="va">In</span> <span class="va">order</span> <span class="va">to</span> <span class="va">insure</span> <span class="va">that</span> <span class="va">the</span> <span class="va">estimated</span> <span class="va">states</span> $<span class="op">\</span><span class="va">hat</span>{<span class="op">\</span><span class="va">mathbf</span>{<span class="va">x</span>}}$ (<span class="va">and</span> <span class="va">outputs</span> $<span class="op">\</span><span class="va">hat</span>{<span class="op">\</span><span class="va">mathbf</span>{<span class="va">y</span>}}$) <span class="va">have</span> <span class="va">converged</span> <span class="va">before</span> <span class="va">control</span> <span class="va">is</span> <span class="va">enabled</span><span class="op">,</span> <span class="va">we</span> <span class="va">will</span> <span class="va">first</span> <span class="va">need</span> <span class="va">to</span> <span class="va">generate</span> <span class="va">an</span> <span class="va">augmented</span> <span class="va">LTI</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">output</span><span class="op">-</span><span class="va">feedback</span> <span class="va">control</span> <span class="va">model</span> <span class="va">with</span> <span class="va">the</span> <span class="va">state</span> <span class="va">feedback</span> <span class="va">gain</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">G</span>}$ <span class="va">set</span> <span class="va">to</span> <span class="va">zero</span> (<span class="va">it</span> <span class="va">is</span> <span class="va">easier</span> <span class="va">to</span> <span class="va">just</span> <span class="va">use</span> $<span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">*\</span><span class="va">mathbf</span>{<span class="va">G</span>}<span class="op">\</span><span class="va">right</span>)$ <span class="va">in</span> <span class="va">the</span> <span class="va">matrices</span>). <span class="va">This</span> <span class="va">first</span> <span class="va">LTI</span> <span class="va">object</span> <span class="va">will</span> <span class="va">be</span> <span class="va">used</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">first</span> <span class="op">**</span><span class="fl">200</span> <span class="va">milliseconds</span><span class="op">**</span> <span class="va">of</span> <span class="va">the</span> <span class="va">response</span>. <span class="va">We</span> <span class="va">must</span> <span class="va">use</span> <span class="va">the</span> <span class="va">same</span> <span class="va">initial</span> <span class="va">states</span> <span class="va">on</span> <span class="va">the</span> <span class="va">plant</span> <span class="va">as</span> <span class="va">defined</span> <span class="va">in</span> <span class="va">CASE</span> <span class="fl">2</span> <span class="va">above</span><span class="op">,</span> <span class="va">but</span> <span class="va">the</span> <span class="va">initial</span> <span class="va">observer</span> <span class="va">states</span> <span class="va">must</span> <span class="va">be</span> <span class="va">zero</span>. <span class="va">Our</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">output</span> <span class="va">equation</span> <span class="va">must</span> <span class="va">also</span> <span class="va">be</span> <span class="va">augmented</span> <span class="va">to</span> <span class="va">output</span> <span class="va">the</span> <span class="va">following</span> <span class="va">three</span> <span class="va">vectors</span><span class="op">:</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">y</span>}$<span class="op">,</span> $<span class="op">\</span><span class="va">hat</span>{<span class="op">\</span><span class="va">mathbf</span>{<span class="va">y</span>}}$<span class="op">,</span> <span class="va">and</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">u</span>}$.</span>
<span id="cb64-510"><a href="#cb64-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-511"><a href="#cb64-511" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-512"><a href="#cb64-512" aria-hidden="true" tabindex="-1"></a><span class="va">xinit_OFC</span> <span class="op">=</span> [<span class="va">xinit</span><span class="op">;</span><span class="va">zeros</span>(<span class="va">size</span>(<span class="va">xinit</span>))]<span class="op">;</span></span>
<span id="cb64-513"><a href="#cb64-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-514"><a href="#cb64-514" aria-hidden="true" tabindex="-1"></a><span class="va">Aofc_G0</span> <span class="op">=</span> [<span class="va">Aol</span><span class="op">,</span> <span class="op">-</span><span class="va">Bol</span><span class="op">*</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb64-515"><a href="#cb64-515" aria-hidden="true" tabindex="-1"></a>    <span class="va">K</span><span class="op">*</span><span class="va">Col</span><span class="op">,</span> <span class="va">Aol</span><span class="op">-</span><span class="va">K</span><span class="op">*</span><span class="va">Col</span><span class="op">-</span><span class="va">Bol</span><span class="op">*</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span>]<span class="op">;</span></span>
<span id="cb64-516"><a href="#cb64-516" aria-hidden="true" tabindex="-1"></a><span class="va">Cofc_G0</span> <span class="op">=</span> [<span class="va">Col</span><span class="op">,</span> <span class="op">-</span><span class="va">Dol</span><span class="op">*</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb64-517"><a href="#cb64-517" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="va">size</span>(<span class="va">Col</span>))<span class="op">,</span> <span class="va">Col</span><span class="op">-</span><span class="va">Dol</span><span class="op">*</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb64-518"><a href="#cb64-518" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="va">size</span>(<span class="va">G</span>))<span class="op">,</span> <span class="op">-</span><span class="va">G</span><span class="op">*</span><span class="fl">0</span><span class="op">;</span></span>
<span id="cb64-519"><a href="#cb64-519" aria-hidden="true" tabindex="-1"></a>    <span class="va">eye</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">6</span>)<span class="op">,</span><span class="va">zeros</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">6</span>)<span class="op">;</span></span>
<span id="cb64-520"><a href="#cb64-520" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">6</span>)<span class="op">,</span><span class="va">eye</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">6</span>)]<span class="op">;</span></span>
<span id="cb64-521"><a href="#cb64-521" aria-hidden="true" tabindex="-1"></a><span class="va">OFC_sys_G0</span> <span class="op">=</span> <span class="va">ss</span>(<span class="va">Aofc_G0</span><span class="op">,</span>[]<span class="op">,</span><span class="va">Cofc_G0</span><span class="op">,</span>[])</span>
<span id="cb64-522"><a href="#cb64-522" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-523"><a href="#cb64-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-524"><a href="#cb64-524" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-525"><a href="#cb64-525" aria-hidden="true" tabindex="-1"></a><span class="va">OFC_sys_G0</span> <span class="op">=</span></span>
<span id="cb64-526"><a href="#cb64-526" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-527"><a href="#cb64-527" aria-hidden="true" tabindex="-1"></a>  <span class="va">A</span> <span class="op">=</span> </span>
<span id="cb64-528"><a href="#cb64-528" aria-hidden="true" tabindex="-1"></a>             <span class="va">x1</span>       <span class="va">x2</span>       <span class="va">x3</span>       <span class="va">x4</span>       <span class="va">x5</span>       <span class="va">x6</span>       <span class="va">x7</span>       <span class="va">x8</span>       <span class="va">x9</span>      <span class="va">x10</span>      <span class="va">x11</span>      <span class="va">x12</span></span>
<span id="cb64-529"><a href="#cb64-529" aria-hidden="true" tabindex="-1"></a>   <span class="va">x1</span>         <span class="fl">0</span>        <span class="fl">1</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-530"><a href="#cb64-530" aria-hidden="true" tabindex="-1"></a>   <span class="va">x2</span>         <span class="fl">0</span>       <span class="op">-</span><span class="fl">1</span>        <span class="fl">0</span>        <span class="fl">0</span>    <span class="op">-</span><span class="fl">9.81</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-531"><a href="#cb64-531" aria-hidden="true" tabindex="-1"></a>   <span class="va">x3</span>         <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">1</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-532"><a href="#cb64-532" aria-hidden="true" tabindex="-1"></a>   <span class="va">x4</span>         <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>       <span class="op">-</span><span class="fl">3</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-533"><a href="#cb64-533" aria-hidden="true" tabindex="-1"></a>   <span class="va">x5</span>         <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">1</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-534"><a href="#cb64-534" aria-hidden="true" tabindex="-1"></a>   <span class="va">x6</span>         <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>     <span class="op">-</span><span class="fl">1.6</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-535"><a href="#cb64-535" aria-hidden="true" tabindex="-1"></a>   <span class="va">x7</span>     <span class="fl">47.06</span>        <span class="fl">0</span>    <span class="fl">11.39</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">12.65</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">47.06</span>        <span class="fl">1</span>   <span class="op">-</span><span class="fl">11.39</span>        <span class="fl">0</span>    <span class="fl">12.65</span>        <span class="fl">0</span></span>
<span id="cb64-536"><a href="#cb64-536" aria-hidden="true" tabindex="-1"></a>   <span class="va">x8</span>     <span class="fl">59.19</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">53.12</span>        <span class="fl">0</span>    <span class="fl">13.25</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">59.19</span>       <span class="op">-</span><span class="fl">1</span>    <span class="fl">53.12</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">23.06</span>        <span class="fl">0</span></span>
<span id="cb64-537"><a href="#cb64-537" aria-hidden="true" tabindex="-1"></a>   <span class="va">x9</span>    <span class="op">-</span><span class="fl">6.596</span>        <span class="fl">0</span>    <span class="fl">78.71</span>        <span class="fl">0</span>    <span class="op">-</span><span class="fl">41.1</span>        <span class="fl">0</span>    <span class="fl">6.596</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">78.71</span>        <span class="fl">1</span>     <span class="fl">41.1</span>        <span class="fl">0</span></span>
<span id="cb64-538"><a href="#cb64-538" aria-hidden="true" tabindex="-1"></a>   <span class="va">x10</span>     <span class="fl">63.6</span>        <span class="fl">0</span>    <span class="fl">2.236</span>        <span class="fl">0</span>  <span class="op">-</span><span class="fl">0.7294</span>        <span class="fl">0</span>    <span class="op">-</span><span class="fl">63.6</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">2.236</span>       <span class="op">-</span><span class="fl">3</span>   <span class="fl">0.7294</span>        <span class="fl">0</span></span>
<span id="cb64-539"><a href="#cb64-539" aria-hidden="true" tabindex="-1"></a>   <span class="va">x11</span>   <span class="op">-</span><span class="fl">5.751</span>        <span class="fl">0</span>    <span class="fl">40.13</span>        <span class="fl">0</span>    <span class="fl">10.22</span>        <span class="fl">0</span>    <span class="fl">5.751</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">40.13</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">10.22</span>        <span class="fl">1</span></span>
<span id="cb64-540"><a href="#cb64-540" aria-hidden="true" tabindex="-1"></a>   <span class="va">x12</span>    <span class="fl">1.976</span>        <span class="fl">0</span>  <span class="op">-</span><span class="fl">0.8166</span>        <span class="fl">0</span>      <span class="fl">6.4</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">1.976</span>        <span class="fl">0</span>   <span class="fl">0.8166</span>        <span class="fl">0</span>     <span class="op">-</span><span class="fl">6.4</span>     <span class="op">-</span><span class="fl">1.6</span></span>
<span id="cb64-541"><a href="#cb64-541" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-542"><a href="#cb64-542" aria-hidden="true" tabindex="-1"></a>  <span class="va">B</span> <span class="op">=</span> </span>
<span id="cb64-543"><a href="#cb64-543" aria-hidden="true" tabindex="-1"></a>     <span class="va">Empty</span> <span class="va">matrix</span><span class="op">:</span> <span class="fl">12</span><span class="op">-</span><span class="va">by</span><span class="op">-</span><span class="fl">0</span></span>
<span id="cb64-544"><a href="#cb64-544" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-545"><a href="#cb64-545" aria-hidden="true" tabindex="-1"></a>  <span class="va">C</span> <span class="op">=</span> </span>
<span id="cb64-546"><a href="#cb64-546" aria-hidden="true" tabindex="-1"></a>         <span class="va">x1</span>   <span class="va">x2</span>   <span class="va">x3</span>   <span class="va">x4</span>   <span class="va">x5</span>   <span class="va">x6</span>   <span class="va">x7</span>   <span class="va">x8</span>   <span class="va">x9</span>  <span class="va">x10</span>  <span class="va">x11</span>  <span class="va">x12</span></span>
<span id="cb64-547"><a href="#cb64-547" aria-hidden="true" tabindex="-1"></a>   <span class="va">y1</span>     <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-548"><a href="#cb64-548" aria-hidden="true" tabindex="-1"></a>   <span class="va">y2</span>     <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-549"><a href="#cb64-549" aria-hidden="true" tabindex="-1"></a>   <span class="va">y3</span>     <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-550"><a href="#cb64-550" aria-hidden="true" tabindex="-1"></a>   <span class="va">y4</span>     <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-551"><a href="#cb64-551" aria-hidden="true" tabindex="-1"></a>   <span class="va">y5</span>     <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-552"><a href="#cb64-552" aria-hidden="true" tabindex="-1"></a>   <span class="va">y6</span>     <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span></span>
<span id="cb64-553"><a href="#cb64-553" aria-hidden="true" tabindex="-1"></a>   <span class="va">y7</span>     <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-554"><a href="#cb64-554" aria-hidden="true" tabindex="-1"></a>   <span class="va">y8</span>     <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-555"><a href="#cb64-555" aria-hidden="true" tabindex="-1"></a>   <span class="va">y9</span>     <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-556"><a href="#cb64-556" aria-hidden="true" tabindex="-1"></a>   <span class="va">y10</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-557"><a href="#cb64-557" aria-hidden="true" tabindex="-1"></a>   <span class="va">y11</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-558"><a href="#cb64-558" aria-hidden="true" tabindex="-1"></a>   <span class="va">y12</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-559"><a href="#cb64-559" aria-hidden="true" tabindex="-1"></a>   <span class="va">y13</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-560"><a href="#cb64-560" aria-hidden="true" tabindex="-1"></a>   <span class="va">y14</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-561"><a href="#cb64-561" aria-hidden="true" tabindex="-1"></a>   <span class="va">y15</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-562"><a href="#cb64-562" aria-hidden="true" tabindex="-1"></a>   <span class="va">y16</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-563"><a href="#cb64-563" aria-hidden="true" tabindex="-1"></a>   <span class="va">y17</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-564"><a href="#cb64-564" aria-hidden="true" tabindex="-1"></a>   <span class="va">y18</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span>    <span class="fl">0</span></span>
<span id="cb64-565"><a href="#cb64-565" aria-hidden="true" tabindex="-1"></a>   <span class="va">y19</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span>    <span class="fl">0</span></span>
<span id="cb64-566"><a href="#cb64-566" aria-hidden="true" tabindex="-1"></a>   <span class="va">y20</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">0</span>    <span class="fl">1</span></span>
<span id="cb64-567"><a href="#cb64-567" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-568"><a href="#cb64-568" aria-hidden="true" tabindex="-1"></a>  <span class="va">D</span> <span class="op">=</span> </span>
<span id="cb64-569"><a href="#cb64-569" aria-hidden="true" tabindex="-1"></a>     <span class="va">Empty</span> <span class="va">matrix</span><span class="op">:</span> <span class="fl">20</span><span class="op">-</span><span class="va">by</span><span class="op">-</span><span class="fl">0</span></span>
<span id="cb64-570"><a href="#cb64-570" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-571"><a href="#cb64-571" aria-hidden="true" tabindex="-1"></a><span class="va">Continuous</span><span class="op">-</span><span class="va">time</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">model</span>.</span>
<span id="cb64-572"><a href="#cb64-572" aria-hidden="true" tabindex="-1"></a><span class="va">Model</span> <span class="va">Properties</span></span>
<span id="cb64-573"><a href="#cb64-573" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-574"><a href="#cb64-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-575"><a href="#cb64-575" aria-hidden="true" tabindex="-1"></a><span class="va">Next</span><span class="op">,</span> <span class="va">we</span> <span class="va">must</span> <span class="va">generate</span> <span class="va">a</span> <span class="va">second</span> <span class="va">augmented</span> <span class="va">LTI</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">output</span><span class="op">-</span><span class="va">feedback</span> <span class="va">control</span> <span class="va">model</span> <span class="va">that</span> <span class="va">is</span> <span class="va">identical</span> <span class="va">to</span> <span class="va">the</span> <span class="va">first</span> <span class="va">model</span> <span class="va">except</span> <span class="va">that</span> <span class="va">the</span> <span class="va">state</span><span class="op">-</span><span class="va">feedback</span> <span class="va">control</span> <span class="va">gains</span> <span class="va">are</span> <span class="va">not</span> <span class="va">zero</span><span class="op">,</span> <span class="va">i</span>.<span class="va">e</span>. <span class="va">the</span> <span class="va">controller</span> <span class="va">is</span> <span class="va">enabled</span>. <span class="va">This</span> <span class="va">second</span> <span class="va">LTI</span> <span class="va">object</span> <span class="va">will</span> <span class="va">be</span> <span class="va">used</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">remainder</span> <span class="va">of</span> <span class="va">the</span> <span class="va">simulation</span>.</span>
<span id="cb64-576"><a href="#cb64-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-577"><a href="#cb64-577" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-578"><a href="#cb64-578" aria-hidden="true" tabindex="-1"></a><span class="va">Aofc</span> <span class="op">=</span> [<span class="va">Aol</span><span class="op">,</span> <span class="op">-</span><span class="va">Bol</span><span class="op">*</span><span class="va">G</span><span class="op">;</span></span>
<span id="cb64-579"><a href="#cb64-579" aria-hidden="true" tabindex="-1"></a>    <span class="va">K</span><span class="op">*</span><span class="va">Col</span><span class="op">,</span> <span class="va">Aol</span><span class="op">-</span><span class="va">K</span><span class="op">*</span><span class="va">Col</span><span class="op">-</span><span class="va">Bol</span><span class="op">*</span><span class="va">G</span>]<span class="op">;</span></span>
<span id="cb64-580"><a href="#cb64-580" aria-hidden="true" tabindex="-1"></a><span class="va">Cofc</span> <span class="op">=</span> [<span class="va">Col</span><span class="op">,</span> <span class="op">-</span><span class="va">Dol</span><span class="op">*</span><span class="va">G</span><span class="op">;</span></span>
<span id="cb64-581"><a href="#cb64-581" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="va">size</span>(<span class="va">Col</span>))<span class="op">,</span> <span class="va">Col</span><span class="op">-</span><span class="va">Dol</span><span class="op">*</span><span class="va">G</span><span class="op">;</span></span>
<span id="cb64-582"><a href="#cb64-582" aria-hidden="true" tabindex="-1"></a>    <span class="va">zeros</span>(<span class="va">size</span>(<span class="va">G</span>))<span class="op">,</span> <span class="op">-</span><span class="va">G</span>]<span class="op">;</span></span>
<span id="cb64-583"><a href="#cb64-583" aria-hidden="true" tabindex="-1"></a><span class="va">OFC_sys</span> <span class="op">=</span> <span class="va">ss</span>(<span class="va">Aofc</span><span class="op">,</span>[]<span class="op">,</span><span class="va">Cofc</span><span class="op">,</span>[])</span>
<span id="cb64-584"><a href="#cb64-584" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-585"><a href="#cb64-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-586"><a href="#cb64-586" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-587"><a href="#cb64-587" aria-hidden="true" tabindex="-1"></a><span class="va">OFC_sys</span> <span class="op">=</span></span>
<span id="cb64-588"><a href="#cb64-588" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-589"><a href="#cb64-589" aria-hidden="true" tabindex="-1"></a>  <span class="va">A</span> <span class="op">=</span> </span>
<span id="cb64-590"><a href="#cb64-590" aria-hidden="true" tabindex="-1"></a>             <span class="va">x1</span>       <span class="va">x2</span>       <span class="va">x3</span>       <span class="va">x4</span>       <span class="va">x5</span>       <span class="va">x6</span>       <span class="va">x7</span>       <span class="va">x8</span>       <span class="va">x9</span>      <span class="va">x10</span>      <span class="va">x11</span>      <span class="va">x12</span></span>
<span id="cb64-591"><a href="#cb64-591" aria-hidden="true" tabindex="-1"></a>   <span class="va">x1</span>         <span class="fl">0</span>        <span class="fl">1</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-592"><a href="#cb64-592" aria-hidden="true" tabindex="-1"></a>   <span class="va">x2</span>         <span class="fl">0</span>       <span class="op">-</span><span class="fl">1</span>        <span class="fl">0</span>        <span class="fl">0</span>    <span class="op">-</span><span class="fl">9.81</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-593"><a href="#cb64-593" aria-hidden="true" tabindex="-1"></a>   <span class="va">x3</span>         <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">1</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-594"><a href="#cb64-594" aria-hidden="true" tabindex="-1"></a>   <span class="va">x4</span>         <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>       <span class="op">-</span><span class="fl">3</span>        <span class="fl">0</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">127.3</span>   <span class="op">-</span><span class="fl">89.85</span>   <span class="op">-</span><span class="fl">48.45</span>   <span class="op">-</span><span class="fl">24.94</span>    <span class="fl">440.6</span>    <span class="fl">4.792</span></span>
<span id="cb64-595"><a href="#cb64-595" aria-hidden="true" tabindex="-1"></a>   <span class="va">x5</span>         <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">1</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span></span>
<span id="cb64-596"><a href="#cb64-596" aria-hidden="true" tabindex="-1"></a>   <span class="va">x6</span>         <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>        <span class="fl">0</span>     <span class="op">-</span><span class="fl">1.6</span>    <span class="fl">363.7</span>    <span class="fl">268.8</span>    <span class="fl">35.54</span>   <span class="op">-</span><span class="fl">2.918</span>    <span class="op">-</span><span class="fl">1340</span>   <span class="op">-</span><span class="fl">63.86</span></span>
<span id="cb64-597"><a href="#cb64-597" aria-hidden="true" tabindex="-1"></a>   <span class="va">x7</span>     <span class="fl">47.06</span>        <span class="fl">0</span>    <span class="fl">11.39</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">12.65</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">47.06</span>        <span class="fl">1</span>   <span class="op">-</span><span class="fl">11.39</span>        <span class="fl">0</span>    <span class="fl">12.65</span>        <span class="fl">0</span></span>
<span id="cb64-598"><a href="#cb64-598" aria-hidden="true" tabindex="-1"></a>   <span class="va">x8</span>     <span class="fl">59.19</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">53.12</span>        <span class="fl">0</span>    <span class="fl">13.25</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">59.19</span>       <span class="op">-</span><span class="fl">1</span>    <span class="fl">53.12</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">23.06</span>        <span class="fl">0</span></span>
<span id="cb64-599"><a href="#cb64-599" aria-hidden="true" tabindex="-1"></a>   <span class="va">x9</span>    <span class="op">-</span><span class="fl">6.596</span>        <span class="fl">0</span>    <span class="fl">78.71</span>        <span class="fl">0</span>    <span class="op">-</span><span class="fl">41.1</span>        <span class="fl">0</span>    <span class="fl">6.596</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">78.71</span>        <span class="fl">1</span>     <span class="fl">41.1</span>        <span class="fl">0</span></span>
<span id="cb64-600"><a href="#cb64-600" aria-hidden="true" tabindex="-1"></a>   <span class="va">x10</span>     <span class="fl">63.6</span>        <span class="fl">0</span>    <span class="fl">2.236</span>        <span class="fl">0</span>  <span class="op">-</span><span class="fl">0.7294</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">190.9</span>   <span class="op">-</span><span class="fl">89.85</span>   <span class="op">-</span><span class="fl">50.68</span>   <span class="op">-</span><span class="fl">27.94</span>    <span class="fl">441.3</span>    <span class="fl">4.792</span></span>
<span id="cb64-601"><a href="#cb64-601" aria-hidden="true" tabindex="-1"></a>   <span class="va">x11</span>   <span class="op">-</span><span class="fl">5.751</span>        <span class="fl">0</span>    <span class="fl">40.13</span>        <span class="fl">0</span>    <span class="fl">10.22</span>        <span class="fl">0</span>    <span class="fl">5.751</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">40.13</span>        <span class="fl">0</span>   <span class="op">-</span><span class="fl">10.22</span>        <span class="fl">1</span></span>
<span id="cb64-602"><a href="#cb64-602" aria-hidden="true" tabindex="-1"></a>   <span class="va">x12</span>    <span class="fl">1.976</span>        <span class="fl">0</span>  <span class="op">-</span><span class="fl">0.8166</span>        <span class="fl">0</span>      <span class="fl">6.4</span>        <span class="fl">0</span>    <span class="fl">361.7</span>    <span class="fl">268.8</span>    <span class="fl">36.36</span>   <span class="op">-</span><span class="fl">2.918</span>    <span class="op">-</span><span class="fl">1347</span>   <span class="op">-</span><span class="fl">65.46</span></span>
<span id="cb64-603"><a href="#cb64-603" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-604"><a href="#cb64-604" aria-hidden="true" tabindex="-1"></a>  <span class="va">B</span> <span class="op">=</span> </span>
<span id="cb64-605"><a href="#cb64-605" aria-hidden="true" tabindex="-1"></a>     <span class="va">Empty</span> <span class="va">matrix</span><span class="op">:</span> <span class="fl">12</span><span class="op">-</span><span class="va">by</span><span class="op">-</span><span class="fl">0</span></span>
<span id="cb64-606"><a href="#cb64-606" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-607"><a href="#cb64-607" aria-hidden="true" tabindex="-1"></a>  <span class="va">C</span> <span class="op">=</span> </span>
<span id="cb64-608"><a href="#cb64-608" aria-hidden="true" tabindex="-1"></a>           <span class="va">x1</span>      <span class="va">x2</span>      <span class="va">x3</span>      <span class="va">x4</span>      <span class="va">x5</span>      <span class="va">x6</span>      <span class="va">x7</span>      <span class="va">x8</span>      <span class="va">x9</span>     <span class="va">x10</span>     <span class="va">x11</span>     <span class="va">x12</span></span>
<span id="cb64-609"><a href="#cb64-609" aria-hidden="true" tabindex="-1"></a>   <span class="va">y1</span>       <span class="fl">1</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span></span>
<span id="cb64-610"><a href="#cb64-610" aria-hidden="true" tabindex="-1"></a>   <span class="va">y2</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">1</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span></span>
<span id="cb64-611"><a href="#cb64-611" aria-hidden="true" tabindex="-1"></a>   <span class="va">y3</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">1</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span></span>
<span id="cb64-612"><a href="#cb64-612" aria-hidden="true" tabindex="-1"></a>   <span class="va">y4</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">1</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span></span>
<span id="cb64-613"><a href="#cb64-613" aria-hidden="true" tabindex="-1"></a>   <span class="va">y5</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">1</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span></span>
<span id="cb64-614"><a href="#cb64-614" aria-hidden="true" tabindex="-1"></a>   <span class="va">y6</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">1</span>       <span class="fl">0</span></span>
<span id="cb64-615"><a href="#cb64-615" aria-hidden="true" tabindex="-1"></a>   <span class="va">y7</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>    <span class="fl">1133</span>   <span class="fl">855.1</span>   <span class="op">-</span><span class="fl">36.2</span>  <span class="op">-</span><span class="fl">115.1</span>   <span class="op">-</span><span class="fl">4293</span>  <span class="op">-</span><span class="fl">270.7</span></span>
<span id="cb64-616"><a href="#cb64-616" aria-hidden="true" tabindex="-1"></a>   <span class="va">y8</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>       <span class="fl">0</span>   <span class="op">-</span><span class="fl">2407</span>   <span class="op">-</span><span class="fl">1754</span>  <span class="op">-</span><span class="fl">448.3</span>  <span class="op">-</span><span class="fl">134.3</span>    <span class="fl">8699</span>   <span class="fl">318.6</span></span>
<span id="cb64-617"><a href="#cb64-617" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-618"><a href="#cb64-618" aria-hidden="true" tabindex="-1"></a>  <span class="va">D</span> <span class="op">=</span> </span>
<span id="cb64-619"><a href="#cb64-619" aria-hidden="true" tabindex="-1"></a>     <span class="va">Empty</span> <span class="va">matrix</span><span class="op">:</span> <span class="fl">8</span><span class="op">-</span><span class="va">by</span><span class="op">-</span><span class="fl">0</span></span>
<span id="cb64-620"><a href="#cb64-620" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb64-621"><a href="#cb64-621" aria-hidden="true" tabindex="-1"></a><span class="va">Continuous</span><span class="op">-</span><span class="va">time</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">model</span>.</span>
<span id="cb64-622"><a href="#cb64-622" aria-hidden="true" tabindex="-1"></a><span class="va">Model</span> <span class="va">Properties</span></span>
<span id="cb64-623"><a href="#cb64-623" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-624"><a href="#cb64-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-625"><a href="#cb64-625" aria-hidden="true" tabindex="-1"></a><span class="va">We</span> <span class="va">are</span> <span class="va">now</span> <span class="va">ready</span> <span class="va">to</span> <span class="va">simulate</span> <span class="va">the</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">response</span><span class="op">,</span> <span class="va">but</span> <span class="va">it</span> <span class="va">must</span> <span class="va">happen</span> <span class="va">in</span> <span class="va">two</span> <span class="va">separate</span> <span class="va">simulation</span> <span class="va">stages</span>. <span class="va">In</span> <span class="va">the</span> <span class="va">first</span> <span class="va">stage</span><span class="op">,</span> <span class="va">we</span> <span class="va">will</span> <span class="va">use</span> <span class="va">the</span> <span class="va">INITIAL</span> <span class="kw">function</span> <span class="va">to</span> <span class="va">simulate</span> <span class="kw">for</span> <span class="fl">200</span> <span class="va">milliseconds</span>. <span class="va">At</span> <span class="va">the</span> <span class="kw">end</span> <span class="va">of</span> <span class="va">this</span> <span class="va">first</span> <span class="va">simulation</span> <span class="va">stage</span><span class="op">,</span> <span class="va">we</span> <span class="va">must</span> <span class="va">capture</span> <span class="va">the</span> <span class="va">final</span> <span class="va">state</span> <span class="va">vector</span> <span class="va">and</span> <span class="va">use</span> <span class="va">it</span> <span class="va">as</span> <span class="va">the</span> <span class="va">initial</span> <span class="va">state</span> <span class="va">vector</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">second</span> <span class="va">simulation</span> <span class="va">stage</span>. <span class="va">The</span> <span class="va">total</span> <span class="va">simulation</span> <span class="va">duration</span> <span class="va">should</span> <span class="va">be</span> <span class="fl">4</span> <span class="va">seconds</span> <span class="va">like</span> <span class="va">above</span>.</span>
<span id="cb64-626"><a href="#cb64-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-627"><a href="#cb64-627" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-628"><a href="#cb64-628" aria-hidden="true" tabindex="-1"></a><span class="va">t_break</span> <span class="op">=</span> <span class="fl">200e-03</span><span class="op">;</span> <span class="co">% seconds</span></span>
<span id="cb64-629"><a href="#cb64-629" aria-hidden="true" tabindex="-1"></a><span class="va">t_final</span> <span class="op">=</span> <span class="fl">4</span><span class="op">;</span> <span class="co">% seconds</span></span>
<span id="cb64-630"><a href="#cb64-630" aria-hidden="true" tabindex="-1"></a><span class="va">dt</span> <span class="op">=</span> <span class="fl">0.01</span><span class="op">;</span></span>
<span id="cb64-631"><a href="#cb64-631" aria-hidden="true" tabindex="-1"></a><span class="va">t_1</span> <span class="op">=</span> (<span class="fl">0</span><span class="op">:</span><span class="va">dt</span><span class="op">:</span><span class="va">t_break</span>)<span class="op">;</span></span>
<span id="cb64-632"><a href="#cb64-632" aria-hidden="true" tabindex="-1"></a><span class="va">t_2</span> <span class="op">=</span> (<span class="va">t_break</span><span class="op">+</span><span class="va">dt</span>)<span class="op">:</span><span class="va">dt</span><span class="op">:</span><span class="va">t_final</span><span class="op">;</span></span>
<span id="cb64-633"><a href="#cb64-633" aria-hidden="true" tabindex="-1"></a>[<span class="va">y_1</span><span class="op">,</span><span class="va">t_1</span>] <span class="op">=</span> <span class="va">initial</span>(<span class="va">OFC_sys_G0</span><span class="op">,</span><span class="va">xinit_OFC</span><span class="op">,</span><span class="va">t_1</span>)<span class="op">;</span></span>
<span id="cb64-634"><a href="#cb64-634" aria-hidden="true" tabindex="-1"></a><span class="va">xinit_OFC_break</span> <span class="op">=</span> <span class="va">y_1</span>(<span class="va">size</span>(<span class="va">y_1</span><span class="op">,</span><span class="fl">1</span>)<span class="op">,</span><span class="fl">9</span><span class="op">:</span><span class="fl">20</span>)<span class="op">.';</span></span>
<span id="cb64-635"><a href="#cb64-635" aria-hidden="true" tabindex="-1"></a>[<span class="va">y_2</span><span class="op">,</span><span class="va">t_2</span>] <span class="op">=</span> <span class="va">initial</span>(<span class="va">OFC_sys</span><span class="op">,</span> <span class="va">xinit_OFC_break</span><span class="op">,</span><span class="va">t_2</span>)<span class="op">;</span></span>
<span id="cb64-636"><a href="#cb64-636" aria-hidden="true" tabindex="-1"></a><span class="va">y_ivr</span> <span class="op">=</span> [<span class="va">y_1</span>(<span class="op">:,</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>)<span class="op">;</span><span class="va">y_2</span>(<span class="op">:,</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>)]<span class="op">;</span></span>
<span id="cb64-637"><a href="#cb64-637" aria-hidden="true" tabindex="-1"></a><span class="va">t_ivr</span> <span class="op">=</span> [<span class="va">t_1</span><span class="op">;</span><span class="va">t_2</span>]<span class="op">;</span></span>
<span id="cb64-638"><a href="#cb64-638" aria-hidden="true" tabindex="-1"></a><span class="va">S</span> <span class="op">=</span> <span class="va">lsiminfo</span>(<span class="va">y_ivr</span><span class="op">,</span><span class="va">t_ivr</span><span class="op">,</span><span class="st">"SettlingTimeThreshold"</span><span class="op">,</span><span class="fl">0.05</span>)<span class="op">;</span></span>
<span id="cb64-639"><a href="#cb64-639" aria-hidden="true" tabindex="-1"></a><span class="va">S</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>).<span class="va">TransientTime</span></span>
<span id="cb64-640"><a href="#cb64-640" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-641"><a href="#cb64-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-642"><a href="#cb64-642" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-643"><a href="#cb64-643" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">2.5721</span></span>
<span id="cb64-644"><a href="#cb64-644" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">1.6099</span></span>
<span id="cb64-645"><a href="#cb64-645" aria-hidden="true" tabindex="-1"></a><span class="va">ans</span> <span class="op">=</span> <span class="fl">2.1822</span></span>
<span id="cb64-646"><a href="#cb64-646" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-647"><a href="#cb64-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-648"><a href="#cb64-648" aria-hidden="true" tabindex="-1"></a><span class="va">Generate</span> <span class="va">the</span> <span class="va">standard</span> <span class="va">annotated</span> <span class="va">plot</span> (<span class="va">three</span> <span class="va">output</span> <span class="va">subplots</span> <span class="va">on</span> <span class="va">the</span> <span class="va">left</span> <span class="va">and</span> <span class="va">two</span> <span class="va">control</span> <span class="va">signal</span> <span class="va">subplots</span> <span class="va">on</span> <span class="va">the</span> <span class="va">right</span>)<span class="op">,</span> <span class="va">with</span> <span class="va">appropriate</span> <span class="va">annotations</span><span class="op">;</span> <span class="va">but</span> <span class="va">we</span> <span class="va">must</span> <span class="va">also</span> <span class="va">plot</span> <span class="va">the</span> <span class="va">estimated</span> <span class="va">output</span> <span class="va">signals</span> <span class="va">on</span> <span class="va">top</span> <span class="va">of</span> <span class="va">the</span> <span class="va">associated</span> <span class="va">actual</span> <span class="va">output</span> <span class="va">signals</span>. <span class="va">It</span> <span class="va">must</span> <span class="va">be</span> <span class="va">clear</span> <span class="va">from</span> <span class="va">our</span> <span class="va">plots</span> <span class="va">that</span> <span class="va">the</span> <span class="va">estimated</span> <span class="va">outputs</span> <span class="va">all</span> <span class="va">start</span> <span class="va">from</span> <span class="va">zero</span> <span class="va">and</span> <span class="va">converge</span> <span class="va">to</span> <span class="va">the</span> <span class="va">actual</span> <span class="va">outputs</span> <span class="va">within</span> <span class="fl">200</span> <span class="va">milliseconds</span>. <span class="va">One</span> <span class="va">must</span> <span class="va">NOT</span> <span class="kw">try</span> <span class="va">to</span> <span class="va">get</span> <span class="va">the</span> <span class="va">observer</span> <span class="va">states</span> <span class="va">to</span> <span class="va">converge</span> <span class="va">too</span> <span class="va">fast</span> <span class="va">because</span> <span class="va">it</span> <span class="va">will</span> <span class="va">be</span> <span class="va">difficult</span> <span class="va">to</span> <span class="va">see</span> <span class="va">the</span> <span class="va">convergence</span> <span class="va">on</span> <span class="va">the</span> <span class="va">plots</span>. <span class="va">If</span> <span class="va">we</span> <span class="va">have</span> <span class="va">done</span> <span class="va">this</span> <span class="va">step</span> <span class="va">correctly</span><span class="op">,</span> <span class="va">we</span> <span class="va">should</span> <span class="va">see</span> <span class="fl">5</span><span class="co">% settling times that are comparable to the original design from CASE 2. The 5% settling times on the outputs must all be below 3 seconds, and we must not saturate either of the control signals.</span></span>
<span id="cb64-649"><a href="#cb64-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-650"><a href="#cb64-650" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-651"><a href="#cb64-651" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="va">figure</span>()<span class="op">;</span></span>
<span id="cb64-652"><a href="#cb64-652" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">1</span>)</span>
<span id="cb64-653"><a href="#cb64-653" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">,</span><span class="ss">'r'</span>)</span>
<span id="cb64-654"><a href="#cb64-654" aria-hidden="true" tabindex="-1"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb64-655"><a href="#cb64-655" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">4</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-656"><a href="#cb64-656" aria-hidden="true" tabindex="-1"></a><span class="va">xline</span>(<span class="va">S</span>(<span class="fl">1</span>).<span class="va">TransientTime</span><span class="op">,</span><span class="ss">'--r'</span>)</span>
<span id="cb64-657"><a href="#cb64-657" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb64-658"><a href="#cb64-658" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>({<span class="ss">'${x}$'</span><span class="op">,</span><span class="ss">'$\hat{x}$'</span>}<span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'latex'</span><span class="op">,</span><span class="ss">'Location'</span><span class="op">,</span><span class="ss">'best'</span>)</span>
<span id="cb64-659"><a href="#cb64-659" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'m'</span>)</span>
<span id="cb64-660"><a href="#cb64-660" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb64-661"><a href="#cb64-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-662"><a href="#cb64-662" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">3</span>)</span>
<span id="cb64-663"><a href="#cb64-663" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">2</span>)<span class="op">,</span><span class="ss">'g'</span>)</span>
<span id="cb64-664"><a href="#cb64-664" aria-hidden="true" tabindex="-1"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb64-665"><a href="#cb64-665" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">5</span>)<span class="op">,</span><span class="ss">'--black'</span>)</span>
<span id="cb64-666"><a href="#cb64-666" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb64-667"><a href="#cb64-667" aria-hidden="true" tabindex="-1"></a><span class="va">xline</span>(<span class="va">S</span>(<span class="fl">2</span>).<span class="va">TransientTime</span><span class="op">,</span><span class="ss">'--r'</span>)</span>
<span id="cb64-668"><a href="#cb64-668" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>({<span class="ss">'${y}$'</span><span class="op">,</span><span class="ss">'$\hat{y}$'</span>}<span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'latex'</span><span class="op">,</span><span class="ss">'Location'</span><span class="op">,</span><span class="ss">'best'</span>)</span>
<span id="cb64-669"><a href="#cb64-669" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'m'</span>)</span>
<span id="cb64-670"><a href="#cb64-670" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb64-671"><a href="#cb64-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-672"><a href="#cb64-672" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">5</span>)</span>
<span id="cb64-673"><a href="#cb64-673" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">3</span>)<span class="op">,</span><span class="ss">'m'</span>)</span>
<span id="cb64-674"><a href="#cb64-674" aria-hidden="true" tabindex="-1"></a><span class="va">hold</span> <span class="va">on</span></span>
<span id="cb64-675"><a href="#cb64-675" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">6</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-676"><a href="#cb64-676" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb64-677"><a href="#cb64-677" aria-hidden="true" tabindex="-1"></a><span class="va">xline</span>(<span class="va">S</span>(<span class="fl">3</span>).<span class="va">TransientTime</span><span class="op">,</span><span class="ss">'--r'</span>)</span>
<span id="cb64-678"><a href="#cb64-678" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>({<span class="ss">'${\theta}$'</span><span class="op">,</span><span class="ss">'$\hat{\theta}$'</span>}<span class="op">,</span><span class="ss">'Interpreter'</span><span class="op">,</span><span class="ss">'latex'</span><span class="op">,</span><span class="ss">'Location'</span><span class="op">,</span><span class="ss">'best'</span>)</span>
<span id="cb64-679"><a href="#cb64-679" aria-hidden="true" tabindex="-1"></a><span class="va">xlabel</span>(<span class="ss">'Time (s)'</span>)</span>
<span id="cb64-680"><a href="#cb64-680" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'rad'</span>)</span>
<span id="cb64-681"><a href="#cb64-681" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb64-682"><a href="#cb64-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-683"><a href="#cb64-683" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">2</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">2</span>)</span>
<span id="cb64-684"><a href="#cb64-684" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">7</span>)<span class="op">,</span><span class="ss">'r'</span>)</span>
<span id="cb64-685"><a href="#cb64-685" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="va">double</span>(<span class="va">u1_max</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-686"><a href="#cb64-686" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="va">double</span>(<span class="va">u1_min</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-687"><a href="#cb64-687" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb64-688"><a href="#cb64-688" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>(<span class="ss">'u_1'</span>)</span>
<span id="cb64-689"><a href="#cb64-689" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'N'</span>)</span>
<span id="cb64-690"><a href="#cb64-690" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb64-691"><a href="#cb64-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-692"><a href="#cb64-692" aria-hidden="true" tabindex="-1"></a><span class="va">subplot</span>(<span class="fl">2</span><span class="op">,</span><span class="fl">2</span><span class="op">,</span><span class="fl">4</span>)</span>
<span id="cb64-693"><a href="#cb64-693" aria-hidden="true" tabindex="-1"></a><span class="va">plot</span>(<span class="va">t_ivr</span><span class="op">,</span><span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">8</span>)<span class="op">,</span><span class="ss">'r'</span>)</span>
<span id="cb64-694"><a href="#cb64-694" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="va">double</span>(<span class="va">u2_max</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-695"><a href="#cb64-695" aria-hidden="true" tabindex="-1"></a><span class="va">yline</span>(<span class="va">double</span>(<span class="va">u2_min</span>)<span class="op">,</span><span class="ss">'--b'</span>)</span>
<span id="cb64-696"><a href="#cb64-696" aria-hidden="true" tabindex="-1"></a><span class="va">xlim</span>([<span class="fl">0</span><span class="op">,</span><span class="va">t_final</span>])</span>
<span id="cb64-697"><a href="#cb64-697" aria-hidden="true" tabindex="-1"></a><span class="va">legend</span>(<span class="ss">'u_2'</span>)</span>
<span id="cb64-698"><a href="#cb64-698" aria-hidden="true" tabindex="-1"></a><span class="va">ylabel</span>(<span class="ss">'N'</span>)</span>
<span id="cb64-699"><a href="#cb64-699" aria-hidden="true" tabindex="-1"></a><span class="va">xlabel</span>(<span class="ss">'Time (s)'</span>)</span>
<span id="cb64-700"><a href="#cb64-700" aria-hidden="true" tabindex="-1"></a><span class="va">grid</span> <span class="va">on</span></span>
<span id="cb64-701"><a href="#cb64-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-702"><a href="#cb64-702" aria-hidden="true" tabindex="-1"></a><span class="va">sgtitle</span>(<span class="ss">'Initial Response for Outputs (left) &amp; Inputs (right)'</span>)<span class="op">;</span></span>
<span id="cb64-703"><a href="#cb64-703" aria-hidden="true" tabindex="-1"></a><span class="va">set</span>(<span class="va">f</span><span class="op">,</span><span class="st">"Position"</span><span class="op">,</span> [<span class="fl">0</span> <span class="fl">0</span> <span class="fl">800</span> <span class="fl">800</span>])</span>
<span id="cb64-704"><a href="#cb64-704" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-705"><a href="#cb64-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-706"><a href="#cb64-706" aria-hidden="true" tabindex="-1"></a><span class="bn">![](Full_State_Feedback_Control_Design_media/figure_2.png)</span></span>
<span id="cb64-707"><a href="#cb64-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-708"><a href="#cb64-708" aria-hidden="true" tabindex="-1"></a><span class="va">In</span> <span class="va">addition</span> <span class="va">to</span> <span class="va">the</span> <span class="va">normal</span> <span class="va">five</span> <span class="va">subplot</span> <span class="va">figure</span><span class="op">,</span> <span class="va">I</span> <span class="va">have</span> <span class="va">also</span> <span class="va">included</span> <span class="va">the</span> <span class="va">animation</span> <span class="va">plot</span> <span class="va">in</span> <span class="va">the</span> <span class="va">LiveScript</span> <span class="va">as</span> <span class="va">documentation</span> <span class="va">of</span> <span class="va">the</span> <span class="va">performance</span>. <span class="va">The</span> `<span class="va">als_f23_animate</span>.<span class="va">p</span>` <span class="va">MATLAB</span> <span class="va">p</span><span class="op">-</span><span class="va">code</span> <span class="va">file</span> <span class="va">can</span> <span class="va">be</span> <span class="va">found</span> <span class="va">in</span> <span class="va">the</span> <span class="va">GitHub</span> <span class="va">repository</span> <span class="va">of</span> <span class="va">the</span> <span class="va">project</span>.</span>
<span id="cb64-709"><a href="#cb64-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-710"><a href="#cb64-710" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-711"><a href="#cb64-711" aria-hidden="true" tabindex="-1"></a><span class="va">als_f23_animate</span>( <span class="va">t_ivr</span><span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">1</span>)<span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">2</span>)<span class="op">,</span> <span class="va">y_ivr</span>(<span class="op">:,</span><span class="fl">3</span>))<span class="op">;</span></span>
<span id="cb64-712"><a href="#cb64-712" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-713"><a href="#cb64-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-714"><a href="#cb64-714" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">img</span> <span class="va">src</span><span class="op">=</span><span class="st">"Full_State_Feedback_Control_Design_media/Simulation_animation.gif"</span> <span class="va">alt</span><span class="op">=</span><span class="st">"Animated GIF"</span> <span class="va">width</span><span class="op">=</span><span class="st">"50%"</span><span class="op">/&gt;</span></span>
<span id="cb64-715"><a href="#cb64-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-716"><a href="#cb64-716" aria-hidden="true" tabindex="-1"></a>## <span class="va">For</span> <span class="va">cases</span> <span class="fl">6</span><span class="op">,</span> <span class="fl">7</span><span class="op">,</span> <span class="va">and</span> <span class="fl">8</span><span class="op">,</span> <span class="va">we</span> <span class="va">will</span> <span class="va">design</span> <span class="va">and</span> <span class="va">simulate</span> <span class="va">another</span> <span class="va">Output</span> <span class="va">Feedback</span> <span class="va">Controller</span> (<span class="va">i</span>.<span class="va">e</span>. <span class="va">a</span> <span class="va">state</span> <span class="va">estimator</span> <span class="va">with</span> <span class="va">full</span> <span class="va">state</span> <span class="va">feedback</span> <span class="va">control</span>)<span class="op">,</span> <span class="va">but</span> <span class="va">now</span> <span class="va">we</span> <span class="va">must</span> <span class="va">also</span> <span class="va">include</span> <span class="va">Integral</span> <span class="va">Control</span> <span class="kw">for</span> <span class="va">reference</span> <span class="va">tracking</span> <span class="va">as</span> <span class="va">defined</span> <span class="va">in</span> <span class="va">the</span> <span class="va">notes</span>.</span>
<span id="cb64-717"><a href="#cb64-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-718"><a href="#cb64-718" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">matlabheadingtwo</span>{<span class="va">This</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">simulation</span> <span class="va">will</span> <span class="va">require</span> <span class="va">we</span> <span class="va">to</span> <span class="va">redesign</span> <span class="va">the</span> <span class="va">state</span><span class="op">-</span><span class="va">feedback</span> <span class="va">control</span> <span class="va">gains</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">G</span>}$ (<span class="va">we</span> <span class="va">cannot</span> <span class="va">use</span> <span class="va">the</span> <span class="va">gains</span> <span class="va">from</span> <span class="va">CASE</span> <span class="fl">2</span><span class="bn">!); however, we should plan to use the same state estimator gains $\mathbf{K}$we designed in CASE 4.  we are welcome to redesign the state estimater gains (poles), but this is not recommended because it will add unnecessary time to our project completion.}</span></span>
<span id="cb64-719"><a href="#cb64-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-720"><a href="#cb64-720" aria-hidden="true" tabindex="-1"></a>## <span class="va">We</span> <span class="va">must</span> <span class="va">expect</span> <span class="va">to</span> <span class="va">iterate</span> <span class="va">on</span> <span class="va">CASES</span> <span class="fl">6</span><span class="op">,</span> <span class="fl">7</span><span class="op">,</span> <span class="va">and</span> <span class="fl">8</span> <span class="va">until</span> <span class="va">we</span> <span class="va">achieve</span> <span class="va">one</span> <span class="va">acceptable</span> <span class="va">design</span>.</span>
<span id="cb64-721"><a href="#cb64-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-722"><a href="#cb64-722" aria-hidden="true" tabindex="-1"></a># <span class="va">CASE</span> <span class="fl">6</span>. <span class="va">Design</span> <span class="va">an</span> <span class="va">LQI</span> <span class="va">compensator</span></span>
<span id="cb64-723"><a href="#cb64-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-724"><a href="#cb64-724" aria-hidden="true" tabindex="-1"></a><span class="va">We</span> <span class="va">must</span> <span class="va">use</span> <span class="va">LQR</span> <span class="va">optimal</span> <span class="va">control</span> <span class="va">to</span> <span class="va">design</span> <span class="va">the</span> <span class="va">state</span><span class="op">-</span><span class="va">feedback</span> <span class="va">gains</span> <span class="kw">for</span> <span class="va">this</span> <span class="va">simulation</span>. <span class="va">The</span> <span class="va">MathWorks</span> <span class="va">has</span> <span class="va">provided</span> <span class="va">a</span> <span class="va">separate</span> <span class="va">tool</span> <span class="va">called</span> `<span class="va">LQI</span>` <span class="kw">for</span> <span class="va">computing</span> <span class="va">the</span> <span class="va">state</span><span class="op">-</span><span class="va">feedback</span> <span class="va">gains</span> <span class="va">when</span> <span class="va">we</span> <span class="va">are</span> <span class="va">implementing</span> <span class="va">state</span> <span class="va">feedback</span> <span class="va">with</span> <span class="va">integral</span> <span class="va">control</span>. <span class="va">Note</span> <span class="va">that</span> `<span class="va">LQI</span>` <span class="va">is</span> <span class="va">identical</span> <span class="va">to</span> `<span class="va">LQR</span>` <span class="va">except</span> <span class="va">that</span> `<span class="va">LQI</span>` <span class="va">already</span> <span class="va">knows</span> <span class="va">that</span> <span class="va">we</span> <span class="va">are</span> <span class="va">designing</span> <span class="kw">for</span> <span class="va">reference</span> <span class="va">tracking</span> <span class="va">with</span> <span class="va">an</span> <span class="va">integral</span> <span class="va">controller</span>. <span class="va">We</span> <span class="va">can</span> <span class="va">NOT</span> <span class="va">use</span> `<span class="va">LQR</span>` <span class="kw">for</span> <span class="va">this</span> <span class="va">design</span><span class="op">,</span> <span class="va">and</span> <span class="va">we</span> <span class="va">must</span> <span class="va">use</span> `<span class="va">LQI</span><span class="bn">!` We must also use the LTI object for the open-loop system as input to the `LQI` function. Read the online help for `LQI` before starting this CASE!</span></span>
<span id="cb64-725"><a href="#cb64-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-726"><a href="#cb64-726" aria-hidden="true" tabindex="-1"></a><span class="va">First</span> <span class="va">define</span> <span class="va">the</span> <span class="va">LQI</span> <span class="va">cost</span> <span class="kw">function</span> <span class="va">weighting</span> <span class="va">matrices</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">Q</span>}$ <span class="va">and</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">R</span>}$. <span class="va">Note</span> <span class="va">that</span> `<span class="va">LQI</span>` <span class="va">also</span> <span class="va">accepts</span> <span class="va">a</span> <span class="va">weighting</span> <span class="va">matrix</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">N</span>}$<span class="op">,</span> <span class="va">which</span> <span class="va">allows</span> <span class="va">cross</span><span class="op">-</span><span class="va">weighting</span> <span class="va">between</span> <span class="va">states</span> <span class="va">and</span> <span class="va">controls</span><span class="op">,</span> <span class="va">but</span> <span class="va">we</span> <span class="va">should</span> <span class="va">NOT</span> <span class="va">use</span> <span class="va">this</span> <span class="va">weighting</span> <span class="va">matrix</span> <span class="kw">for</span> <span class="va">this</span> <span class="va">CASE</span><span class="bn">! Make sure we understand the dimensions of each of these weighting matrices.</span></span>
<span id="cb64-727"><a href="#cb64-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-728"><a href="#cb64-728" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-729"><a href="#cb64-729" aria-hidden="true" tabindex="-1"></a><span class="va">Q</span> <span class="op">=</span> <span class="va">diag</span>([<span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span> <span class="fl">1</span>])</span>
<span id="cb64-730"><a href="#cb64-730" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-731"><a href="#cb64-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-732"><a href="#cb64-732" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-733"><a href="#cb64-733" aria-hidden="true" tabindex="-1"></a><span class="va">Q</span> <span class="op">=</span> <span class="fl">9</span><span class="va">x9</span>    </span>
<span id="cb64-734"><a href="#cb64-734" aria-hidden="true" tabindex="-1"></a>     <span class="fl">1</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span></span>
<span id="cb64-735"><a href="#cb64-735" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">1</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span></span>
<span id="cb64-736"><a href="#cb64-736" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">1</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span></span>
<span id="cb64-737"><a href="#cb64-737" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">1</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span></span>
<span id="cb64-738"><a href="#cb64-738" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">1</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span></span>
<span id="cb64-739"><a href="#cb64-739" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">1</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span></span>
<span id="cb64-740"><a href="#cb64-740" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">1</span>     <span class="fl">0</span>     <span class="fl">0</span></span>
<span id="cb64-741"><a href="#cb64-741" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">1</span>     <span class="fl">0</span></span>
<span id="cb64-742"><a href="#cb64-742" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">0</span>     <span class="fl">1</span></span>
<span id="cb64-743"><a href="#cb64-743" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-744"><a href="#cb64-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-745"><a href="#cb64-745" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-746"><a href="#cb64-746" aria-hidden="true" tabindex="-1"></a><span class="va">R</span> <span class="op">=</span> <span class="va">diag</span>([<span class="fl">1</span> <span class="fl">2</span>])</span>
<span id="cb64-747"><a href="#cb64-747" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-748"><a href="#cb64-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-749"><a href="#cb64-749" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-750"><a href="#cb64-750" aria-hidden="true" tabindex="-1"></a><span class="va">R</span> <span class="op">=</span> <span class="fl">2</span><span class="va">x2</span>    </span>
<span id="cb64-751"><a href="#cb64-751" aria-hidden="true" tabindex="-1"></a>     <span class="fl">1</span>     <span class="fl">0</span></span>
<span id="cb64-752"><a href="#cb64-752" aria-hidden="true" tabindex="-1"></a>     <span class="fl">0</span>     <span class="fl">2</span></span>
<span id="cb64-753"><a href="#cb64-753" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-754"><a href="#cb64-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-755"><a href="#cb64-755" aria-hidden="true" tabindex="-1"></a><span class="va">Generate</span> <span class="va">and</span> <span class="va">display</span> <span class="va">the</span> <span class="va">optimal</span> <span class="va">control</span> <span class="va">gains</span> <span class="va">and</span> <span class="va">separate</span> <span class="va">them</span> <span class="va">into</span> ${<span class="op">\</span><span class="va">mathbf</span>{<span class="va">G</span>}}_<span class="fl">0</span>$ <span class="va">and</span> ${<span class="op">\</span><span class="va">mathbf</span>{<span class="va">G</span>}}_<span class="va">I</span>$ <span class="va">matrices</span>.</span>
<span id="cb64-756"><a href="#cb64-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-757"><a href="#cb64-757" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-758"><a href="#cb64-758" aria-hidden="true" tabindex="-1"></a><span class="va">OL_int_A</span> <span class="op">=</span> [<span class="va">Aol</span><span class="op">,</span> <span class="va">zeros</span>(<span class="fl">6</span><span class="op">,</span><span class="fl">3</span>)<span class="op">;</span></span>
<span id="cb64-759"><a href="#cb64-759" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="va">Col</span><span class="op">,</span> <span class="va">zeros</span>(<span class="fl">3</span><span class="op">,</span><span class="fl">3</span>)]<span class="op">;</span></span>
<span id="cb64-760"><a href="#cb64-760" aria-hidden="true" tabindex="-1"></a><span class="va">OL_int_B</span> <span class="op">=</span> [<span class="va">Bol</span><span class="op">;</span></span>
<span id="cb64-761"><a href="#cb64-761" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="va">Dol</span>]<span class="op">;</span></span>
<span id="cb64-762"><a href="#cb64-762" aria-hidden="true" tabindex="-1"></a><span class="va">OL_int_sys</span> <span class="op">=</span> <span class="va">ss</span>(<span class="va">OL_int_A</span><span class="op">,</span><span class="va">OL_int_B</span><span class="op">,</span>[]<span class="op">,</span>[])<span class="op">;</span></span>
<span id="cb64-763"><a href="#cb64-763" aria-hidden="true" tabindex="-1"></a>[<span class="va">G</span><span class="op">,</span><span class="va">S</span><span class="op">,</span><span class="va">e</span>]<span class="op">=</span><span class="va">lqi</span>(<span class="va">OL_int_sys</span><span class="op">,</span><span class="va">Q</span><span class="op">,</span><span class="va">R</span>)</span>
<span id="cb64-764"><a href="#cb64-764" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-765"><a href="#cb64-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-766"><a href="#cb64-766" aria-hidden="true" tabindex="-1"></a>``` <span class="va">text</span><span class="op">:</span><span class="va">output</span></span>
<span id="cb64-767"><a href="#cb64-767" aria-hidden="true" tabindex="-1"></a><span class="va">G</span> <span class="op">=</span> <span class="fl">2</span><span class="va">x9</span>    </span>
<span id="cb64-768"><a href="#cb64-768" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">3.2779</span>   <span class="op">-</span><span class="fl">2.4232</span>    <span class="fl">3.4413</span>    <span class="fl">1.1089</span>   <span class="fl">29.9386</span>   <span class="fl">11.5472</span>    <span class="fl">0.8981</span>   <span class="op">-</span><span class="fl">0.4397</span>    <span class="fl">0.0000</span></span>
<span id="cb64-769"><a href="#cb64-769" aria-hidden="true" tabindex="-1"></a>    <span class="fl">1.1514</span>    <span class="fl">0.8555</span>    <span class="fl">5.0041</span>    <span class="fl">1.6054</span>  <span class="op">-</span><span class="fl">11.7328</span>   <span class="op">-</span><span class="fl">4.7892</span>   <span class="op">-</span><span class="fl">0.3109</span>   <span class="op">-</span><span class="fl">0.6351</span>    <span class="fl">0.0000</span></span>
<span id="cb64-770"><a href="#cb64-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-771"><a href="#cb64-771" aria-hidden="true" tabindex="-1"></a><span class="va">S</span> <span class="op">=</span> <span class="fl">9</span><span class="va">x9</span>    </span>
<span id="cb64-772"><a href="#cb64-772" aria-hidden="true" tabindex="-1"></a><span class="fl">1.0e+08</span> <span class="op">*</span></span>
<span id="cb64-773"><a href="#cb64-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-774"><a href="#cb64-774" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0507</span>    <span class="fl">0.0507</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.4976</span></span>
<span id="cb64-775"><a href="#cb64-775" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0507</span>    <span class="fl">0.0507</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.4976</span></span>
<span id="cb64-776"><a href="#cb64-776" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>    <span class="fl">0.0000</span></span>
<span id="cb64-777"><a href="#cb64-777" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>    <span class="fl">0.0000</span></span>
<span id="cb64-778"><a href="#cb64-778" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span></span>
<span id="cb64-779"><a href="#cb64-779" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span></span>
<span id="cb64-780"><a href="#cb64-780" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span></span>
<span id="cb64-781"><a href="#cb64-781" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>   <span class="op">-</span><span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span></span>
<span id="cb64-782"><a href="#cb64-782" aria-hidden="true" tabindex="-1"></a>   <span class="op">-</span><span class="fl">0.4976</span>   <span class="op">-</span><span class="fl">0.4976</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">0.0000</span>    <span class="fl">4.8816</span></span>
<span id="cb64-783"><a href="#cb64-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-784"><a href="#cb64-784" aria-hidden="true" tabindex="-1"></a><span class="va">e</span> <span class="op">=</span> <span class="fl">9</span><span class="va">x1</span> <span class="va">complex</span>    </span>
<span id="cb64-785"><a href="#cb64-785" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">0.0000</span> <span class="op">+</span> <span class="fl">0.0000i</span></span>
<span id="cb64-786"><a href="#cb64-786" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">0.1348</span> <span class="op">+</span> <span class="fl">0.1327i</span></span>
<span id="cb64-787"><a href="#cb64-787" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">0.1348</span> <span class="op">-</span> <span class="fl">0.1327i</span></span>
<span id="cb64-788"><a href="#cb64-788" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">0.5013</span> <span class="op">+</span> <span class="fl">0.7953i</span></span>
<span id="cb64-789"><a href="#cb64-789" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">0.5013</span> <span class="op">-</span> <span class="fl">0.7953i</span></span>
<span id="cb64-790"><a href="#cb64-790" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">0.9185</span> <span class="op">+</span> <span class="fl">0.3250i</span></span>
<span id="cb64-791"><a href="#cb64-791" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">0.9185</span> <span class="op">-</span> <span class="fl">0.3250i</span></span>
<span id="cb64-792"><a href="#cb64-792" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">1.6934</span> <span class="op">+</span> <span class="fl">0.0000i</span></span>
<span id="cb64-793"><a href="#cb64-793" aria-hidden="true" tabindex="-1"></a>  <span class="op">-</span><span class="fl">3.0023</span> <span class="op">+</span> <span class="fl">0.0000i</span></span>
<span id="cb64-794"><a href="#cb64-794" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-795"><a href="#cb64-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-796"><a href="#cb64-796" aria-hidden="true" tabindex="-1"></a># <span class="va">CASE</span> <span class="fl">7</span>. <span class="va">Construct</span> <span class="va">the</span> <span class="va">OFC</span> <span class="va">with</span> <span class="va">Reference</span> <span class="va">Inputs</span></span>
<span id="cb64-797"><a href="#cb64-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-798"><a href="#cb64-798" aria-hidden="true" tabindex="-1"></a><span class="va">Generate</span> <span class="va">an</span> <span class="va">augmented</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">system</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">Output</span> <span class="va">Feedback</span> <span class="va">Controller</span> (<span class="va">state</span> <span class="va">feedback</span> <span class="va">with</span> <span class="va">estimated</span> <span class="va">states</span>) <span class="va">and</span> <span class="va">Reference</span> <span class="va">Tracking</span>. <span class="va">Our</span> <span class="va">complete</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">model</span> <span class="va">must</span> <span class="va">have</span><span class="op">:</span></span>
<span id="cb64-799"><a href="#cb64-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-800"><a href="#cb64-800" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">item</span></span>
<span id="cb64-801"><a href="#cb64-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-802"><a href="#cb64-802" aria-hidden="true" tabindex="-1"></a>{ <span class="va">State</span> <span class="va">vector</span> <span class="va">consisting</span> <span class="va">of</span><span class="op">:</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">x</span>}$<span class="op">,</span> $<span class="op">\</span><span class="va">hat</span>{<span class="op">\</span><span class="va">mathbf</span>{<span class="va">x</span>}}$<span class="op">,</span> <span class="va">and</span> ${<span class="op">\</span><span class="va">mathbf</span>{<span class="va">x</span>}}_<span class="va">I</span>$ }</span>
<span id="cb64-803"><a href="#cb64-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-804"><a href="#cb64-804" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">item</span></span>
<span id="cb64-805"><a href="#cb64-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-806"><a href="#cb64-806" aria-hidden="true" tabindex="-1"></a>{ <span class="va">Output</span> <span class="va">vector</span> <span class="va">consisting</span> <span class="va">of</span><span class="op">:</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">y</span>}$<span class="op">,</span> $<span class="op">\</span><span class="va">hat</span>{<span class="op">\</span><span class="va">mathit</span>{<span class="op">\</span><span class="va">mathbf</span>{<span class="va">y</span>}}}$<span class="op">,</span> <span class="va">and</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">u</span>}$ }</span>
<span id="cb64-807"><a href="#cb64-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-808"><a href="#cb64-808" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">item</span></span>
<span id="cb64-809"><a href="#cb64-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-810"><a href="#cb64-810" aria-hidden="true" tabindex="-1"></a>{ <span class="va">Input</span> <span class="va">vector</span> <span class="va">consisting</span> <span class="va">of</span><span class="op">:</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">r</span>}$ }</span>
<span id="cb64-811"><a href="#cb64-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-812"><a href="#cb64-812" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">item</span></span>
<span id="cb64-813"><a href="#cb64-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-814"><a href="#cb64-814" aria-hidden="true" tabindex="-1"></a>{ <span class="va">State</span> <span class="va">Feedback</span> <span class="va">Control</span> <span class="va">law</span><span class="op">:</span> $<span class="va">u</span><span class="op">=-\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">cc</span>} {<span class="op">\</span><span class="va">mathbf</span>{<span class="va">G</span>}}_<span class="fl">0</span> <span class="op">&amp;</span> {<span class="op">\</span><span class="va">mathbf</span>{<span class="va">G</span>}}_<span class="va">I</span> <span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span> <span class="op">\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="op">\</span><span class="va">begin</span>{<span class="va">array</span>}{<span class="va">c</span>} <span class="op">\</span><span class="va">hat</span>{<span class="op">\</span><span class="va">mathbf</span>{<span class="va">x</span>}} <span class="op">\\</span> {<span class="op">\</span><span class="va">mathbf</span>{<span class="va">x</span>}}_<span class="va">I</span> <span class="op">\</span><span class="kw">end</span>{<span class="va">array</span>}<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span>$ }</span>
<span id="cb64-815"><a href="#cb64-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-816"><a href="#cb64-816" aria-hidden="true" tabindex="-1"></a><span class="va">After</span> <span class="va">generating</span> <span class="va">the</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">output</span> <span class="va">feedback</span> <span class="va">control</span> <span class="va">state</span><span class="op">-</span><span class="va">space</span> <span class="va">model</span><span class="op">,</span> <span class="va">compute</span> <span class="va">and</span> <span class="va">display</span> <span class="va">the</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">eigenvalues</span>.</span>
<span id="cb64-817"><a href="#cb64-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-818"><a href="#cb64-818" aria-hidden="true" tabindex="-1"></a>```<span class="va">matlab</span></span>
<span id="cb64-819"><a href="#cb64-819" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb64-820"><a href="#cb64-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-821"><a href="#cb64-821" aria-hidden="true" tabindex="-1"></a># <span class="va">CASE</span> <span class="fl">8</span>. <span class="va">Simulate</span> <span class="va">the</span> <span class="va">Output</span> <span class="va">Feedback</span> <span class="va">Controller</span> <span class="va">with</span> <span class="va">Reference</span> <span class="va">Inputs</span></span>
<span id="cb64-822"><a href="#cb64-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-823"><a href="#cb64-823" aria-hidden="true" tabindex="-1"></a><span class="va">For</span> <span class="va">this</span> <span class="va">CASE</span><span class="op">,</span> <span class="va">we</span> <span class="va">will</span> <span class="va">simulate</span> <span class="va">the</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">response</span> <span class="va">of</span> <span class="va">our</span> <span class="va">control</span> <span class="va">system</span> <span class="va">using</span> `<span class="va">LSIM</span>()`<span class="op">;</span> <span class="va">however</span><span class="op">,</span> <span class="va">we</span> <span class="va">must</span> <span class="va">first</span> <span class="va">generate</span> <span class="va">a</span> <span class="va">suitable</span> <span class="va">reference</span> <span class="va">profile</span> <span class="va">as</span> <span class="va">an</span> <span class="va">input</span>. <span class="va">Before</span> <span class="va">we</span> <span class="va">can</span> <span class="va">generate</span> <span class="va">a</span> <span class="va">reference</span> <span class="va">profile</span><span class="op">,</span> <span class="va">we</span> <span class="va">need</span> <span class="va">to</span> <span class="va">understand</span> <span class="va">the</span> <span class="va">initial</span> <span class="va">position</span> <span class="va">and</span> <span class="va">the</span> <span class="va">final</span> <span class="va">desired</span> <span class="va">position</span> <span class="va">of</span> <span class="va">the</span> <span class="va">drone</span>. <span class="va">These</span> <span class="va">are</span> <span class="va">new</span> <span class="va">initial</span> <span class="va">conditions</span><span class="op">,</span> <span class="va">and</span> <span class="va">a</span> <span class="va">very</span> <span class="va">different</span> <span class="va">final</span> <span class="va">position</span> <span class="va">from</span> <span class="va">any</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">simulation</span> <span class="va">we</span> <span class="va">have</span> <span class="va">done</span> <span class="va">before</span>.</span>
<span id="cb64-824"><a href="#cb64-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-825"><a href="#cb64-825" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">Initial</span> <span class="va">Plant</span> <span class="va">Conditions</span><span class="op">:**</span> <span class="va">The</span> <span class="va">plant</span> (<span class="va">drone</span>) <span class="va">must</span> <span class="va">start</span> <span class="va">with</span> <span class="va">the</span> <span class="va">following</span> <span class="va">initial</span> <span class="va">states</span><span class="op">:</span></span>
<span id="cb64-826"><a href="#cb64-826" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb64-827"><a href="#cb64-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-828"><a href="#cb64-828" aria-hidden="true" tabindex="-1"></a>$<span class="va">x</span><span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=-</span><span class="fl">2</span>$ <span class="va">m</span><span class="op">,</span> $<span class="va">y</span><span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">1</span>$ <span class="va">m</span><span class="op">,</span> <span class="va">and</span> $<span class="op">\</span><span class="va">theta</span> <span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">0</span>$ <span class="va">rad</span>.</span>
<span id="cb64-829"><a href="#cb64-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-830"><a href="#cb64-830" aria-hidden="true" tabindex="-1"></a>$<span class="op">\</span><span class="va">dot</span>{<span class="va">x</span>} <span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">0</span>$ <span class="va">m</span><span class="op">/</span><span class="va">s</span><span class="op">,</span> $<span class="op">\</span><span class="va">dot</span>{<span class="va">y</span>} <span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">0</span>$ <span class="va">m</span><span class="op">/</span><span class="va">s</span><span class="op">,</span> <span class="va">and</span> $<span class="op">\</span><span class="va">dot</span>{<span class="op">\</span><span class="va">theta</span>} <span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">0</span>$ <span class="va">rad</span><span class="op">/</span><span class="va">s</span>.</span>
<span id="cb64-831"><a href="#cb64-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-832"><a href="#cb64-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-833"><a href="#cb64-833" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">Initial</span> <span class="va">Observer</span> <span class="va">Conditions</span><span class="op">:**</span> <span class="va">We</span> <span class="va">may</span> <span class="va">assume</span> <span class="va">that</span> <span class="va">the</span> <span class="va">initial</span> <span class="va">observer</span> <span class="va">states</span> <span class="va">are</span> <span class="va">identical</span> <span class="va">to</span> <span class="va">the</span> <span class="va">initial</span> <span class="va">plant</span> <span class="va">states</span>.</span>
<span id="cb64-834"><a href="#cb64-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-835"><a href="#cb64-835" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">Final</span> <span class="va">Plant</span> <span class="va">Conditions</span><span class="op">:**</span> <span class="va">The</span> <span class="va">plant</span> (<span class="va">drone</span>) <span class="va">must</span> <span class="va">reach</span> <span class="va">the</span> <span class="va">following</span> <span class="va">final</span> <span class="va">states</span><span class="op">:</span></span>
<span id="cb64-836"><a href="#cb64-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-837"><a href="#cb64-837" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb64-838"><a href="#cb64-838" aria-hidden="true" tabindex="-1"></a>$<span class="va">x</span><span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=+</span><span class="fl">2</span>$ <span class="va">m</span><span class="op">,</span> $<span class="va">y</span><span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">0</span>$ <span class="va">m</span><span class="op">,</span> <span class="va">and</span> $<span class="op">\</span><span class="va">theta</span> <span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">0</span>$ <span class="va">rad</span>.</span>
<span id="cb64-839"><a href="#cb64-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-840"><a href="#cb64-840" aria-hidden="true" tabindex="-1"></a>$<span class="op">\</span><span class="va">dot</span>{<span class="va">x</span>} <span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">0</span>$ <span class="va">m</span><span class="op">/</span><span class="va">s</span><span class="op">,</span> $<span class="op">\</span><span class="va">dot</span>{<span class="va">y</span>} <span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">0</span>$ <span class="va">m</span><span class="op">/</span><span class="va">s</span><span class="op">,</span> <span class="va">and</span> $<span class="op">\</span><span class="va">dot</span>{<span class="op">\</span><span class="va">theta</span>} <span class="op">\</span><span class="va">left</span>(<span class="fl">0</span><span class="op">\</span><span class="va">right</span>)<span class="op">=</span><span class="fl">0</span>$ <span class="va">rad</span><span class="op">/</span><span class="va">s</span>.</span>
<span id="cb64-841"><a href="#cb64-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-842"><a href="#cb64-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-843"><a href="#cb64-843" aria-hidden="true" tabindex="-1"></a><span class="op">**</span><span class="va">Evaluation</span> <span class="va">Criteria</span><span class="op">:**</span></span>
<span id="cb64-844"><a href="#cb64-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-845"><a href="#cb64-845" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>   <span class="va">Notice</span> <span class="va">that</span> <span class="va">the</span> <span class="va">final</span> <span class="va">state</span> <span class="va">is</span> <span class="va">on</span> <span class="va">the</span> <span class="va">opposite</span> <span class="va">side</span> <span class="va">of</span> <span class="va">the</span> <span class="fl">1.5</span><span class="va">m</span> <span class="va">high</span> <span class="va">red</span> <span class="va">wall</span> <span class="va">in</span> <span class="va">the</span> <span class="va">animation</span><span class="bn">! The drone is NOT allowed to make contact with the wall at any point during the simulation.\</span></span>
<span id="cb64-846"><a href="#cb64-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-847"><a href="#cb64-847" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>   <span class="va">The</span> <span class="va">drone</span> <span class="va">is</span> <span class="va">NOT</span> <span class="va">allowed</span> <span class="va">to</span> <span class="va">make</span> <span class="va">contact</span> <span class="va">with</span> <span class="va">the</span> <span class="va">ground</span> <span class="va">at</span> <span class="va">any</span> <span class="va">point</span> <span class="va">during</span> <span class="va">the</span> <span class="va">simulation</span> <span class="va">except</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">final</span> <span class="va">time</span> <span class="va">where</span> <span class="va">the</span> <span class="va">drone</span> <span class="va">must</span> <span class="va">sit</span> <span class="va">on</span> <span class="va">the</span> <span class="va">ground</span>.</span>
<span id="cb64-848"><a href="#cb64-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-849"><a href="#cb64-849" aria-hidden="true" tabindex="-1"></a>    <span class="op">\</span><span class="va">item</span></span>
<span id="cb64-850"><a href="#cb64-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-851"><a href="#cb64-851" aria-hidden="true" tabindex="-1"></a>    { <span class="va">The</span> <span class="va">drone</span> <span class="va">must</span> <span class="va">reach</span> <span class="va">the</span> <span class="va">final</span> <span class="va">state</span> <span class="va">by</span> <span class="fl">30</span> <span class="va">seconds</span> ($<span class="op">\</span><span class="va">textrm</span>{<span class="va">tfinal</span>}<span class="op">\</span><span class="va">le</span> <span class="fl">30</span><span class="va">s</span>$). }</span>
<span id="cb64-852"><a href="#cb64-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-853"><a href="#cb64-853" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>   <span class="va">The</span> <span class="va">control</span> <span class="va">signals</span> $<span class="va">u_1</span>$ <span class="va">and</span> $<span class="va">u_2</span>$ <span class="va">must</span> <span class="va">remain</span> <span class="va">within</span> <span class="va">the</span> <span class="va">saturation</span> <span class="va">bounds</span> <span class="va">established</span> <span class="va">in</span> <span class="va">the</span> <span class="va">Midterm</span> <span class="va">Project</span>.</span>
<span id="cb64-854"><a href="#cb64-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-855"><a href="#cb64-855" aria-hidden="true" tabindex="-1"></a>    <span class="op">\</span><span class="va">item</span></span>
<span id="cb64-856"><a href="#cb64-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-857"><a href="#cb64-857" aria-hidden="true" tabindex="-1"></a>    { <span class="va">There</span> <span class="va">is</span> <span class="va">NO</span> <span class="va">formal</span> <span class="va">settling</span> <span class="va">time</span> <span class="va">requirement</span><span class="op">;</span> <span class="va">however</span><span class="op">,</span> <span class="va">our</span> <span class="va">actual</span> <span class="va">output</span> <span class="va">responses</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">y</span>}$ <span class="va">must</span> <span class="va">track</span> <span class="va">the</span> <span class="va">reference</span> <span class="va">responses</span> $<span class="op">\</span><span class="va">mathbf</span>{<span class="va">r</span>}$<span class="va">reasonably</span> <span class="va">accurately</span>. <span class="va">For</span> <span class="va">example</span><span class="op">,</span> <span class="kw">if</span> <span class="va">our</span> <span class="va">reference</span> <span class="va">profiles</span> <span class="va">have</span> <span class="va">dwell</span> <span class="va">regions</span><span class="op">,</span> <span class="va">then</span> <span class="va">there</span> <span class="va">should</span> <span class="va">be</span> <span class="va">zero</span> <span class="va">steady</span><span class="op">-</span><span class="va">state</span> <span class="va">error</span> <span class="va">after</span> <span class="va">transients</span> <span class="va">have</span> <span class="va">subsided</span>. <span class="va">If</span> <span class="va">our</span> <span class="va">reference</span> <span class="va">profiles</span> <span class="va">have</span> <span class="va">ramp</span> <span class="va">regions</span><span class="op">,</span> <span class="va">then</span> <span class="va">we</span> <span class="va">should</span> <span class="va">expect</span> <span class="va">to</span> <span class="va">see</span> <span class="va">a</span> <span class="va">steady</span><span class="op">-</span><span class="va">state</span> <span class="va">error</span> <span class="va">during</span> <span class="va">the</span> <span class="va">ramp</span><span class="op">,</span> <span class="va">which</span> <span class="va">looks</span> <span class="va">like</span> <span class="va">a</span> <span class="va">delayed</span> <span class="va">response</span>. <span class="va">How</span> <span class="va">closely</span> <span class="va">we</span> <span class="va">track</span> <span class="va">the</span> <span class="va">references</span> <span class="va">will</span> <span class="va">depend</span> <span class="va">on</span> <span class="va">our</span> <span class="va">choice</span> <span class="va">of</span> <span class="va">weighting</span> <span class="va">coefficients</span> <span class="va">in</span> <span class="va">the</span> <span class="va">Q</span> <span class="va">matrix</span>. <span class="va">Note</span> <span class="va">that</span> <span class="va">a</span> <span class="va">steady</span><span class="op">-</span><span class="va">state</span> <span class="va">error</span> <span class="va">during</span> <span class="va">the</span> <span class="va">ramp</span> <span class="va">is</span> <span class="va">perfectly</span> <span class="va">acceptable</span> <span class="va">as</span> <span class="va">long</span> <span class="va">as</span> <span class="va">we</span> <span class="va">choose</span> <span class="va">the</span> <span class="va">reference</span> <span class="va">profile</span> <span class="va">such</span> <span class="va">that</span> <span class="va">the</span> <span class="va">drone</span> <span class="va">does</span> <span class="va">not</span> <span class="va">make</span> <span class="va">contact</span> <span class="va">with</span> <span class="va">the</span> <span class="va">wall</span><span class="bn">! }</span></span>
<span id="cb64-858"><a href="#cb64-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-859"><a href="#cb64-859" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>   <span class="va">For</span> <span class="va">this</span> <span class="va">simulation</span><span class="op">,</span> <span class="va">the</span> <span class="va">observer</span> <span class="va">and</span> <span class="va">the</span> <span class="va">controller</span> <span class="va">must</span> <span class="va">both</span> <span class="va">be</span> <span class="va">enabled</span> <span class="va">at</span> <span class="va">t</span><span class="op">=</span><span class="fl">0</span> (<span class="va">i</span>.<span class="va">e</span>. <span class="va">do</span> <span class="va">NOT</span> <span class="va">attempt</span> <span class="va">a</span> <span class="va">two</span><span class="op">-</span><span class="va">stage</span> <span class="va">simulation</span> <span class="va">like</span> <span class="va">CASE</span> <span class="fl">5</span>).</span>
<span id="cb64-860"><a href="#cb64-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-861"><a href="#cb64-861" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>   <span class="va">We</span> <span class="va">MUST</span> <span class="va">use</span> `<span class="va">LSIM</span>` <span class="va">to</span> <span class="va">simulate</span> <span class="va">the</span> <span class="va">closed</span><span class="op">-</span><span class="va">loop</span> <span class="va">time</span> <span class="va">response</span></span>
<span id="cb64-862"><a href="#cb64-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-863"><a href="#cb64-863" aria-hidden="true" tabindex="-1"></a>    <span class="op">\</span><span class="va">item</span></span>
<span id="cb64-864"><a href="#cb64-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-865"><a href="#cb64-865" aria-hidden="true" tabindex="-1"></a>    { <span class="va">Before</span> <span class="va">constructing</span> <span class="va">the</span> <span class="va">reference</span> <span class="va">profiles</span><span class="op">,</span> <span class="va">we</span> <span class="va">must</span> <span class="va">first</span> <span class="va">construct</span> <span class="va">a</span> <span class="va">time</span> <span class="va">vector</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">simulation</span>. <span class="va">I</span> <span class="va">recommend</span> <span class="va">choosing</span> <span class="va">a</span> <span class="va">uniform</span> <span class="va">step</span> <span class="va">size</span> <span class="va">of</span> $<span class="op">\</span><span class="va">textrm</span>{<span class="va">ts</span>}<span class="op">=</span><span class="fl">0</span><span class="op">\</span><span class="va">ldotp</span> <span class="fl">002</span>$ <span class="va">seconds</span><span class="op">:</span> }</span>
<span id="cb64-866"><a href="#cb64-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-867"><a href="#cb64-867" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-868"><a href="#cb64-868" aria-hidden="true" tabindex="-1"></a><span class="va">t</span><span class="op">=\</span><span class="va">textrm</span>{<span class="va">ts</span>}<span class="op">*\</span><span class="va">left</span><span class="op">\</span><span class="va">lbrack</span> <span class="fl">0</span><span class="op">:\</span><span class="va">textrm</span>{<span class="va">round</span>}<span class="op">\</span><span class="va">left</span>(<span class="op">\</span><span class="va">frac</span>{<span class="op">\</span><span class="va">textrm</span>{<span class="va">tfinal</span>}}{<span class="op">\</span><span class="va">left</span>.<span class="op">\</span><span class="va">textrm</span>{<span class="va">ts</span>}<span class="op">\</span><span class="va">right</span>)}<span class="op">\</span><span class="va">right</span>)<span class="op">\</span><span class="va">right</span><span class="op">\</span><span class="va">rbrack</span></span>
<span id="cb64-869"><a href="#cb64-869" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-870"><a href="#cb64-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-871"><a href="#cb64-871" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>   <span class="va">For</span> <span class="va">each</span> <span class="va">time</span> <span class="va">step</span> <span class="va">in</span> <span class="va">the</span> <span class="va">time</span> <span class="va">vector</span><span class="op">,</span> <span class="va">we</span> <span class="va">must</span> <span class="va">generate</span> <span class="va">a</span> <span class="va">reference</span> <span class="va">vector</span> <span class="kw">for</span> <span class="va">each</span> <span class="va">of</span> <span class="va">the</span> <span class="va">outputs</span>. <span class="va">We</span> <span class="va">will</span> <span class="va">need</span> <span class="va">to</span> <span class="va">generate</span> <span class="va">a</span> <span class="va">particular</span> <span class="va">path</span> <span class="va">vs</span>. <span class="va">time</span> <span class="va">profile</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">desired</span> <span class="va">x</span> <span class="va">and</span> <span class="va">y</span> <span class="va">position</span><span class="op">;</span> <span class="va">however</span><span class="op">,</span> <span class="va">I</span> <span class="va">recommend</span> <span class="va">choosing</span> <span class="va">the</span> <span class="va">following</span> <span class="va">reference</span> <span class="va">profile</span> <span class="kw">for</span> <span class="va">the</span> <span class="va">angular</span> <span class="va">position</span><span class="op">:</span></span>
<span id="cb64-872"><a href="#cb64-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-873"><a href="#cb64-873" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-874"><a href="#cb64-874" aria-hidden="true" tabindex="-1"></a><span class="op">\</span><span class="va">theta_</span>{<span class="op">\</span><span class="va">textrm</span>{<span class="va">ref</span>}} <span class="op">=\</span><span class="va">textrm</span>{<span class="va">zeros</span>}<span class="op">\</span><span class="va">left</span>(<span class="op">\</span><span class="va">textrm</span>{<span class="va">size</span>}<span class="op">\</span><span class="va">left</span>(<span class="va">t</span><span class="op">\</span><span class="va">right</span>)<span class="op">\</span><span class="va">right</span>)</span>
<span id="cb64-875"><a href="#cb64-875" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb64-876"><a href="#cb64-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-877"><a href="#cb64-877" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>   <span class="va">I</span> <span class="va">have</span> <span class="va">used</span> <span class="va">the</span> <span class="va">same</span> <span class="va">plot</span> <span class="va">structure</span> <span class="va">as</span> <span class="va">before</span> <span class="va">except</span> <span class="va">that</span> <span class="va">new</span> <span class="va">signals</span> <span class="va">that</span> <span class="va">must</span> <span class="va">be</span> <span class="va">added</span>. <span class="va">Each</span> <span class="va">of</span> <span class="va">the</span> <span class="va">three</span> <span class="va">output</span> <span class="va">subplots</span> <span class="va">on</span> <span class="va">the</span> <span class="va">left</span> <span class="va">include</span> <span class="va">the</span> <span class="va">reference</span> <span class="va">profile</span><span class="op">,</span> <span class="va">the</span> <span class="va">actual</span> <span class="va">output</span><span class="op">,</span> <span class="va">and</span> <span class="va">the</span> <span class="va">estimated</span> <span class="va">output</span> <span class="va">on</span> <span class="va">the</span> <span class="va">same</span> <span class="va">axis</span>.</span>
<span id="cb64-878"><a href="#cb64-878" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>   <span class="va">Our</span> <span class="va">main</span> <span class="va">goal</span> <span class="va">should</span> <span class="va">be</span> <span class="va">able</span> <span class="va">to</span> <span class="va">reach</span> <span class="va">the</span> <span class="va">final</span> <span class="va">state</span> <span class="va">in</span> <span class="va">a</span> <span class="va">minimum</span> <span class="va">time</span>.</span>
<span id="cb64-879"><a href="#cb64-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-880"><a href="#cb64-880" aria-hidden="true" tabindex="-1"></a>## <span class="va">SIMULATION</span> <span class="va">RESULT</span></span>
<span id="cb64-881"><a href="#cb64-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-882"><a href="#cb64-882" aria-hidden="true" tabindex="-1"></a><span class="op">&lt;</span><span class="va">img</span> <span class="va">src</span><span class="op">=</span><span class="st">"Simulation_animation.gif"</span> <span class="va">style</span><span class="op">=</span><span class="st">"display: block; margin: 0 auto;"</span> <span class="va">alt</span><span class="op">=</span><span class="st">"Animated GIF"</span> <span class="va">loop</span> <span class="va">width</span><span class="op">=</span><span class="st">"50%"</span> <span class="va">height</span><span class="op">=</span><span class="st">"100%"</span><span class="op">&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Powered by <a href="https://quarto.org">Quarto</a></div>   
    <div class="nav-footer-center">Â© 2024, Nishant Bharali<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/NishantBharali/Blog/blob/main/Control Systems/Full_State_Feedback_Control_Design.qmd" class="toc-action">View source</a></p></div></div><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">License: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY NC SA 4.0</a>.</div>
  </div>
</footer>
<script type="text/javascript">
const dateElements = document.querySelectorAll("p.date, div.listing-date");
dateElements.forEach((el) => {
  el.innerHTML = el.innerHTML.replace(
    /(\d+)(rd|st|th)/g,
    "$1<sup style='font-size:0.5em;font-style:italic;'>$2</sup>"
  );
});
</script>



</body></html>