<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Portfolio</title>
<link>https://www.nishantkb.info/control_systems.html</link>
<atom:link href="https://www.nishantkb.info/control_systems.xml" rel="self" type="application/rss+xml"/>
<description>We develop a 2D model for a drone package delivery system, applying state space LTI and feedback control techniques. Our simulation in MATLAB (Control System Toolbox and Simulink) focuses on Optimal LQR control for precise drone landing, strategically placing poles for accuracy, and includes bode plot analysis.</description>
<image>
<url>https://www.nishantkb.info/images/Controls_gif.gif</url>
<title>Portfolio</title>
<link>https://www.nishantkb.info/control_systems.html</link>
</image>
<generator>quarto-1.3.450</generator>
<lastBuildDate>Mon, 12 Feb 2024 04:14:57 GMT</lastBuildDate>
<item>
  <title>Bode Inverse Estimation</title>
  <link>https://www.nishantkb.info/Control Systems/Bode_freqresp.html</link>
  <description><![CDATA[ 



<section id="analysis-on-frequency-responses-using-transfer-functions-of-a-given-system" class="level1">
<h1><span style="color:rgb(213,80,0)">Analysis on Frequency Responses using Transfer Functions of a given System</span></h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clear</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clc</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'defaultlinelinewidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'s'</span>)</span></code></pre></div>
<pre class="textoutput"><code>s =
 
  s
 
Continuous-time transfer function.
Model Properties</code></pre>
</section>
<section id="review-of-transfer-functions-and-frequency-responses" class="level1">
<h1>Review of Transfer Functions and Frequency Responses</h1>
<p>In a classical feedback control, we should know how to sketch a Bode diagram given a Laplace-domain transfer function. One of the first steps in the sketching procedure was to factor the transfer function into first-order and second-order building blocks. The list below shows the standard seven building blocks in normalized form (normalized is not the only form, but these seven are the only building blocks). Any transfer function can be factored into products of these seven terms.</p>
<p>Gain: <img src="https://latex.codecogs.com/png.latex?K"></p>
<p>First-order Pole at Origin: <img src="https://latex.codecogs.com/png.latex?%5Cleft(%5Cfrac%7B1%7D%7Bs%7D%5Cright)"> First-order Zero at Origin: <img src="https://latex.codecogs.com/png.latex?%5Cleft(%5Cfrac%7Bs%7D%7B1%7D%5Cright)"></p>
<p>First-order Real Pole: <img src="https://latex.codecogs.com/png.latex?%5Cleft(%5Cfrac%7Bp%7D%7Bs+p%7D%5Cright)"> First-order Real Zero: <img src="https://latex.codecogs.com/png.latex?%5Cleft(%5Cfrac%7Bs+z%7D%7Bz%7D%5Cright)"></p>
<p>Second-order Pole: <img src="https://latex.codecogs.com/png.latex?%5Cleft(%5Cfrac%7B%5Comega_p%5E2%20%7D%7Bs%5E2%20+2%5Czeta_p%20%5Comega_p%20+%5Comega_p%5E2%20%7D%5Cright)"> Second-order Zero: <img src="https://latex.codecogs.com/png.latex?%5Cleft(%5Cfrac%7Bs%5E2%20+2%5Czeta_z%20%5Comega_z%20+%5Comega_z%5E2%20%7D%7B%5Comega_z%5E2%20%7D%5Cright)"></p>
<p>If one understands how to sketch a Bode diagram for a transfer function, they should also understand how to do the inverse problem of estimating a mathematical transfer function from a given Bode diagram (for relatively simple systems).</p>
<p>Thus, here we are applying our knowledge of sketching Bode diagrams to <strong>accurately estimate</strong> the Laplace-domain transfer functions associated with each frequency response below.</p>
<p>Note: The term “accurately estimate” means that we are expected to extract numerical information from the frequency response plots (e.g.&nbsp;slopes, frequencies, gains) to determine numerical values for the transfer function parameters based on the normalized building blocks above. After we have generated our estimated transfer function, we must compute and plot the frequency response in a properly annotated figure (like the ones provided below). Thus in this verification process, our plots should have the same grid lines, ranges, labels, etc, as the provided plots initially.</p>
</section>
<section id="case-1" class="level1">
<h1>Case 1</h1>
<section id="desired-magnitude-and-phase" class="level4">
<h4 class="anchored" data-anchor-id="desired-magnitude-and-phase">Desired Magnitude and Phase</h4>
<p><img src="https://www.nishantkb.info/Control Systems/HW1_media/image_0.png" alt="image_0.png" width="562"></p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb3-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bodeoptions</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">FreqUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hz'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% or 'rad/second', 'rpm', etc.</span></span>
<span id="cb3-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MagScale</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'linear'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MagLowerLimMode</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'manual'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MagLowerLim</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">XLimMode</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'manual'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">XLim</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Grid</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'on'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-11"></span>
<span id="cb3-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pole</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3e2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-14"></span>
<span id="cb3-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pole</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bode</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>)</span></code></pre></div>
</section>
<section id="output" class="level3">
<h3 class="anchored" data-anchor-id="output">Output:</h3>
<p><img src="https://www.nishantkb.info/Control Systems/HW1_media/figure_0.png" alt="figure_0.png" width="562"></p>
</section>
</section>
<section id="case-2" class="level1">
<h1>Case 2</h1>
<section id="desired-magnitude-and-phase-1" class="level4">
<h4 class="anchored" data-anchor-id="desired-magnitude-and-phase-1">Desired Magnitude and Phase</h4>
<p><img src="https://www.nishantkb.info/Control Systems/HW1_media/image_1.png" alt="image_1.png" width="562"></p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb4-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bodeoptions</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">FreqUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hz'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% or 'rad/second', 'rpm', etc.</span></span>
<span id="cb4-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MagScale</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'linear'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">XLimMode</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'manual'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">XLim</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Grid</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'on'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zero</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">900</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zero</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zero</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb4-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bode</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>)</span></code></pre></div>
</section>
<section id="output-1" class="level3">
<h3 class="anchored" data-anchor-id="output-1">Output:</h3>
<p><img src="https://www.nishantkb.info/Control Systems/HW1_media/figure_1.png" alt="figure_1.png" width="562"></p>
</section>
</section>
<section id="case-3" class="level1">
<h1>Case 3</h1>
<section id="desired-magnitude-and-phase-2" class="level4">
<h4 class="anchored" data-anchor-id="desired-magnitude-and-phase-2">Desired Magnitude and Phase</h4>
<p><img src="https://www.nishantkb.info/Control Systems/HW1_media/image_2.png" alt="image_2.png" width="562"></p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb5-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bodeoptions</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">FreqUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hz'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% or 'rad/second', 'rpm', etc.</span></span>
<span id="cb5-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MagScale</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'linear'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">XLimMode</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'manual'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">XLim</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Grid</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'on'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-8"></span>
<span id="cb5-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zero</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pole</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3e2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-13"></span>
<span id="cb5-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zero</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pole</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bode</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>)</span></code></pre></div>
</section>
<section id="output-2" class="level3">
<h3 class="anchored" data-anchor-id="output-2">Output:</h3>
<p><img src="https://www.nishantkb.info/Control Systems/HW1_media/figure_2.png" alt="figure_2.png" width="562"></p>
</section>
</section>
<section id="case-4" class="level1">
<h1>Case 4</h1>
<section id="desired-magnitude-and-phase-3" class="level4">
<h4 class="anchored" data-anchor-id="desired-magnitude-and-phase-3">Desired Magnitude and Phase</h4>
<p><img src="https://www.nishantkb.info/Control Systems/HW1_media/image_3.png" alt="image_3.png" width="562"></p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb6-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bodeoptions</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">FreqUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Hz'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% or 'rad/second', 'rpm', etc.</span></span>
<span id="cb6-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MagScale</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'linear'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MagLowerLimMode</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'manual'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MagLowerLim</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">XLimMode</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'manual'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">XLim</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Grid</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'on'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">GridColor</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb6-11"></span>
<span id="cb6-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pole</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4e3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zero</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2e5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-14"></span>
<span id="cb6-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">QdB</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">QdB</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-18"></span>
<span id="cb6-19"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-20"></span>
<span id="cb6-21"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pole</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pole</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pole</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zero</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zero</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb6-22"></span>
<span id="cb6-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">bode</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">tf</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">options</span>)</span></code></pre></div>
</section>
<section id="output-3" class="level3">
<h3 class="anchored" data-anchor-id="output-3">Output:</h3>
<p><img src="https://www.nishantkb.info/Control Systems/HW1_media/figure_3.png" alt="figure_3.png" width="562"></p>


<!-- -->

</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>Control</category>
  <guid>https://www.nishantkb.info/Control Systems/Bode_freqresp.html</guid>
  <pubDate>Mon, 12 Feb 2024 04:14:57 GMT</pubDate>
  <media:content url="https://www.nishantkb.info/Control Systems/Bode_gif.gif" medium="image" type="image/gif"/>
</item>
<item>
  <title>Full State Feedback Control Design</title>
  <link>https://www.nishantkb.info/Control Systems/Full_State_Feedback_Control_Design.html</link>
  <description><![CDATA[ 



<section id="me5554aoe5754ece5754-applied-linear-systems---project-ii" class="level1">
<h1><span style="color:rgb(213,80,0)">ME5554/AOE5754/ECE5754 Applied Linear Systems - Project II</span></h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clear</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'defaultlinelinewidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">format</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">short</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sympref</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'FloatingPointOutput'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">true</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
</section>
<section id="case-1.-prepare-the-open-loop-plant" class="level1">
<h1>CASE 1. Prepare the Open-Loop Plant</h1>
<p>The state-space LTI object we developed in the Project I for the open-loop plant should have been saved in a .mat file.</p>
<p><br></p>
<p>Note: Before we proceed with the implementation, one should be responsible for correcting any errors they have in their open-loop plant! In this case, the plant is provided in my GitHub. One should NOT regenerate the open-loop LTI state-space plant in this LiveScript!!! The open-loop plant MUST be loaded from a .mat file (created in ME5554/AOE5754/ECE5754 Applied Linear Systems - Project I - Linearized LTI Modeling Feedback Control) to avoid discrepancies.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">load</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MP_nishant_ss_model.mat"</span>)</span></code></pre></div>
<p>After loading the .mat file, display the open-loop numerical state-space model. This model MUST display appropriately chosen statenames, inputnames (ok to use defaults here), and outputnames.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb3-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_sys</span></span></code></pre></div>
<pre class="text:output"><code>OL_sys =
 
  A = 
                   X Position    X Velocity    Y Position    Y Velocity  Angular Posi  Angular Velo
   X Position               0             1             0             0             0             0
   X Velocity               0            -1             0             0         -9.81             0
   Y Position               0             0             0             1             0             0
   Y Velocity               0             0             0            -3             0             0
   Angular Posi             0             0             0             0             0             1
   Angular Velo             0             0             0             0             0          -1.6
 
  B = 
                 Varitional F  Varitional F
   X Position               0             0
   X Velocity               0             0
   Y Position               0             0
   Y Velocity             0.1           0.1
   Angular Posi             0             0
   Angular Velo        0.1302       -0.0898
 
  C = 
                   X Position    X Velocity    Y Position    Y Velocity  Angular Posi  Angular Velo
   X Position               1             0             0             0             0             0
   Y Position               0             0             1             0             0             0
   Angular Posi             0             0             0             0             1             0
 
  D = 
                 Varitional F  Varitional F
   X Position               0             0
   Y Position               0             0
   Angular Posi             0             0
 
Continuous-time state-space model.
Model Properties</code></pre>
<p>Next, extract the Aol, Bol, Col, and Dol matrices, but do not display these results (because we already displayed them in the previous step).</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb5-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Bol</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">B</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">C</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb5-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Dol</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">D</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p>Compute the open-loop eigenvalues (ol_poles), and the system dimensions (N, M, P). Assign these quantities to variables for use later in the LiveScript, but do not display them here.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb6-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ol_poles</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eig</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span>)</span></code></pre></div>
<pre class="text:output"><code>ol_poles = 6x1    
         0
   -1.0000
         0
   -3.0000
         0
   -1.6000</code></pre>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb8-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">N</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<pre class="text:output"><code>N = 6</code></pre>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb10-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">M</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Bol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<pre class="text:output"><code>M = 2</code></pre>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb12-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">P</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<pre class="text:output"><code>P = 3</code></pre>
</section>
<section id="case-2.-simulate-closed-loop-control" class="level1">
<h1>CASE 2. Simulate Closed-Loop Control</h1>
<p>We are given the following set of desired closed-loop poles which are known to result in 5% settling times (transient times) that are less than 3 seconds without saturating any of the control signals.</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb14-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cl_poles</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb14-2">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15i</span></span>
<span id="cb14-3">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">15i</span></span>
<span id="cb14-4">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0i</span></span>
<span id="cb14-5">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.76i</span></span>
<span id="cb14-6">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.76i</span></span>
<span id="cb14-7">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0i</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p>Use the <code>PLACE</code> function to compute the full state feedback control gain matrix, and display our result.</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb15-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">place</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Bol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cl_poles</span>)</span></code></pre></div>
<pre class="text:output"><code>G = 2x6    
1.0e+03 *

   -1.1332   -0.8551    0.0362    0.1151    4.2932    0.2707
    2.4067    1.7537    0.4483    0.1343   -8.6992   -0.3186</code></pre>
<p>Assume that the actual plant starts with the following initial conditions (NOTE: These are NEW IC’s!!!):</p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb17-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% meters</span></span>
<span id="cb17-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x0dot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% meters/sec</span></span>
<span id="cb17-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% meters</span></span>
<span id="cb17-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y0dot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% meters/sec</span></span>
<span id="cb17-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% radians</span></span>
<span id="cb17-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta0dot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% radians/sec</span></span></code></pre></div>
<p>Assume that we have access to the full state vector, then construct a closed-loop state-space LTI object using the feedback gains from above.</p>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb18-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Acl</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Bol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span></span></code></pre></div>
<pre class="text:output"><code>Acl = 6x6    
1.0e+03 *

         0    0.0010         0         0         0         0
         0   -0.0010         0         0   -0.0098         0
         0         0         0    0.0010         0         0
   -0.1273   -0.0899   -0.0484   -0.0279    0.4406    0.0048
         0         0         0         0         0    0.0010
    0.3637    0.2688    0.0355   -0.0029   -1.3402   -0.0655</code></pre>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb20-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ccl</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Dol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span></span></code></pre></div>
<pre class="text:output"><code>Ccl = 3x6    
     1     0     0     0     0     0
     0     0     1     0     0     0
     0     0     0     0     1     0</code></pre>
<p>We must augment the output equation to output the original outputs as well as the control signals.</p>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb22-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ccl</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ccl</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span>]</span></code></pre></div>
<pre class="text:output"><code>Ccl = 5x6    
1.0e+03 *

    0.0010         0         0         0         0         0
         0         0    0.0010         0         0         0
         0         0         0         0    0.0010         0
    1.1332    0.8551   -0.0362   -0.1151   -4.2932   -0.2707
   -2.4067   -1.7537   -0.4483   -0.1343    8.6992    0.3186</code></pre>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb24-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CL_sys</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ss</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Acl</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ccl</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p>Simulate the initial value response using <code>INITIAL</code>. Choose a final simulation time of 4 seconds for this simulation.</p>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb25-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% seconds</span></span>
<span id="cb25-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xinit</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x0dot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y0dot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">theta0dot</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb25-3">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">initial</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">CL_sys</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xinit</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p>Estimate the 5% settling times for each output.</p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb26-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lsiminfo</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SettlingTimeThreshold"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>).<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TransientTime</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Settling times in seconds</span></span></code></pre></div>
<pre class="text:output"><code>ans = 2.4134
ans = 2.6797
ans = 0.9707</code></pre>
<p>Generate a plot like what was required for the Midterm Project with the three outputs on the left-hand side (separate axes for each output), and the control signals on the right-hand side of the figure (separate axes for each control signal). Annotate each plot with some kind of marker for the 5% settling times, the min and max allowable control signals, grid lines, axis labels, and units.</p>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb28-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-2"></span>
<span id="cb28-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_min</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2039</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_max</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1959</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_min</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2057.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_max</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1940.9</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputNames</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'\theta'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'u1'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'u2'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'rad'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputNames</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'u1'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'u2'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-11"></span>
<span id="cb28-12"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb28-13">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% odd numbers for left side</span></span>
<span id="cb28-14">  </span>
<span id="cb28-15">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-16">    </span>
<span id="cb28-17">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">find</span>((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>).<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TransientTime</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-18">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb28-19">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--r'</span>)</span>
<span id="cb28-20">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb28-21">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clear</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span></span>
<span id="cb28-22"></span>
<span id="cb28-23">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">title</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputNames</span>{<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-24">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (s)'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-25">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputUnits</span>{<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-26">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb28-27"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb28-28"></span>
<span id="cb28-29"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb28-30">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% even numbers for right side</span></span>
<span id="cb28-31">    </span>
<span id="cb28-32">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% 4 and 5 for u1 and u2</span></span>
<span id="cb28-33">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylim</span>([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2500</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2500</span>])</span>
<span id="cb28-34">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb28-35">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_max</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb28-36">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_min</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb28-37">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb28-38">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb28-39">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_max</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb28-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_min</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb28-41">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb28-42"></span>
<span id="cb28-43">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">title</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputNames</span>{(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-44">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (s)'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-45">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputUnits</span>{(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-46">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb28-47">    </span>
<span id="cb28-48"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb28-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Adjust the overall plot title</span></span>
<span id="cb28-50"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sgtitle</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Initial Response for Outputs (left) &amp; Inputs (right)'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-51"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Position"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>])</span></code></pre></div>
<p><img src="https://www.nishantkb.info/Control Systems/Full_State_Feedback_Control_Design_media/figure_0.png" class="img-fluid"></p>
<p>In addition to the normal five subplot figure, we must also include the animation plot in the LiveScript as documentation of the performance.</p>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb29-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">als_f23_animate</span>( <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
</section>
<section id="case-3.-evaluate-observability" class="level1">
<h1>CASE 3. Evaluate Observability</h1>
<p>First show that this system is completely observable using all three outputs.</p>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb30-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ob</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obsv</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ob</span>)</span></code></pre></div>
<pre class="text:output"><code>ans = 6</code></pre>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb32-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">N</span></span></code></pre></div>
<pre class="text:output"><code>N = 6</code></pre>
<p>Rank of observability matrix is equal to number of states.</p>
<p>Then we determine whether this system is completely observable using any subset of outputs and justify our answers.</p>
<p>For individual outputs</p>
<div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb34-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obsv</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,:</span>)))</span></code></pre></div>
<pre class="text:output"><code>ans = 4</code></pre>
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb36-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obsv</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,:</span>)))</span></code></pre></div>
<pre class="text:output"><code>ans = 2</code></pre>
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb38-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obsv</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,:</span>)))</span></code></pre></div>
<pre class="text:output"><code>ans = 2</code></pre>
<p>None of the individual outputs obs matrices are full rank</p>
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb40-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obsv</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,:</span>)))</span></code></pre></div>
<pre class="text:output"><code>ans = 6</code></pre>
<div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb42-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obsv</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,:</span>)))</span></code></pre></div>
<pre class="text:output"><code>ans = 4</code></pre>
<div class="sourceCode" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb44-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obsv</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,:</span>)))</span></code></pre></div>
<pre class="text:output"><code>ans = 4</code></pre>
<p>We can see that the combination of ouput 1 &amp; 2 (x &amp; y), has a obs matrix which is full rank meaning the system is obervable using just there 2 outputs.</p>
</section>
<section id="case-4.-design-a-full-order-luenberger-observer" class="level1">
<h1>CASE 4. Design a Full-Order Luenberger Observer</h1>
<p>In this CASE, we will compute the gains for a state estimator using all three outputs. We must first choose appropriate pole locations for the state estimator (observer), and then compute and display the associated feedback gain matrix using the <code>PLACE</code> function.</p>
<div class="sourceCode" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb46-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">alpha</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb46-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obs_poles</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">alpha</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cl_poles</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% alpha &gt; 1 is faster observer than controller</span></span>
<span id="cb46-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">K</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">place</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.',</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.',</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obs_poles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.'</span></span></code></pre></div>
<pre class="text:output"><code>K = 6x3    
   47.0621   11.3921  -12.6548
   59.1867  -53.1150   13.2504
   -6.5959   78.7139  -41.1033
   63.5968    2.2363   -0.7294
   -5.7511   40.1340   10.2240
    1.9765   -0.8166    6.4001</code></pre>
<p>To document our design, we must generate a plot that includes the open-loop poles from CASE 1, the closed-loop poles from CASE 2, and observer poles from this CASE. Use common markers for each set of poles (i.e.&nbsp;all open-loop poles must use the same marker, etc.) so that it is easy to distinguish the poles on the figure. Include a legend that only has three entries in it (open-loop, closed-loop, observer), corresponding to the three sets of poles. We must use the <code>SGRID</code> function (read the Matlab help!!) to generate appropriate grid lines. We will also annotate our plot with axis labels. Making sure our legend does not cover up any of the poles!</p>
<div class="sourceCode" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb48-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-2"></span>
<span id="cb48-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wmax</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">round</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cl_poles</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ol_poles</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obs_poles</span>])))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sgrid</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wmax</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wmax</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"new"</span>)</span>
<span id="cb48-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">h1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">real</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ol_poles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">imag</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ol_poles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'bx'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'markersize'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'linewidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hold</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb48-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">h2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">real</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cl_poles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">imag</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">cl_poles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'gs'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'markersize'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'linewidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">h3</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">real</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obs_poles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">imag</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">obs_poles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'rd'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'markersize'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'linewidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Real (s)'</span>)</span>
<span id="cb48-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Imag (s)'</span>)</span>
<span id="cb48-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xline</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'linewidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb48-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'linewidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb48-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">legend</span>([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">h1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">h2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">h3</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'open loop'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'closed loop'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'estimator'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb48-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Position"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>])</span>
<span id="cb48-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gca</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'yaxislocation'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'right'</span>)</span>
<span id="cb48-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">axis</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">equal</span></span></code></pre></div>
<p><img src="https://www.nishantkb.info/Control Systems/Full_State_Feedback_Control_Design_media/figure_1.png" class="img-fluid"></p>
</section>
<section id="case-5.-simulate-output-feedback-control" class="level1">
<h1>CASE 5. Simulate Output Feedback Control</h1>
<p>For this CASE, we must simulate the complete output feedback control system, which will include the state estimator and full state feedback using the estimated states.</p>
<p>Using the equations for obersever followed by controller we can find, (L14/S29)</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%0A%5Cdot%7Bx%7D%20%5C%5C%0A%5Cdot%7B%5Chat%7Bx%7D%20%7D%0A%5Cend%7Barray%7D%5Cright%5Crbrack%20=%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bcc%7D%0AA%20&amp;%20-B%5C;G%5C%5C%0AK%5C;C%20&amp;%20%5Chat%7BA%7D%20-K%5Chat%7BC%7D%20-%5Chat%7BB%5C;%7D%20G-K%5Cleft(D-%5Chat%7BD%7D%20%5Cright)G%0A%5Cend%7Barray%7D%5Cright%5Crbrack%20%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%0Ax%5C%5C%0A%5Chat%7Bx%7D%0A%5Cend%7Barray%7D%5Cright%5Crbrack%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%0Ay%5C%5C%0A%5Chat%7By%7D%0A%5Cend%7Barray%7D%5Cright%5Crbrack%20=%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bcc%7D%0AC%20&amp;%20-D%5C;G%5C%5C%0A0%20&amp;%20%5Chat%7BC%7D%20-%5Chat%7BD%7D%20%5C;G%0A%5Cend%7Barray%7D%5Cright%5Crbrack%20%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%0Ax%5C%5C%0A%5Chat%7Bx%7D%0A%5Cend%7Barray%7D%5Cright%5Crbrack%0A"></p>
<p>Assumuing,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BA%7D%20=A%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5Chat%7BB%7D%20=B%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5Chat%7BC%7D%20=C%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5C;%5Chat%7BD%7D%20=D%0A"></p>
<p>We can simplify as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%0A%5Cdot%7Bx%7D%20%5C%5C%0A%5Cdot%7B%5Chat%7Bx%7D%20%7D%0A%5Cend%7Barray%7D%5Cright%5Crbrack%20=%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bcc%7D%0AA%20&amp;%20-B%5C;G%5C%5C%0AK%5C;C%20&amp;%20A-K%5C;C-B%5C;G%0A%5Cend%7Barray%7D%5Cright%5Crbrack%20%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%0Ax%5C%5C%0A%5Chat%7Bx%7D%0A%5Cend%7Barray%7D%5Cright%5Crbrack%0A"></p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%0Ay%5C%5C%0A%5Chat%7By%7D%0A%5Cend%7Barray%7D%5Cright%5Crbrack%20=%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bcc%7D%0AC%20&amp;%20-D%5C;G%5C%5C%0A0%20&amp;%20C-D%5C;G%0A%5Cend%7Barray%7D%5Cright%5Crbrack%20%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%0Ax%5C%5C%0A%5Chat%7Bx%7D%0A%5Cend%7Barray%7D%5Cright%5Crbrack%0A"></p>
<p>Augmenting to get back u to plot,</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Bbmatrix%7D%0Ay%20%5C%5C%0A%5Chat%7By%7D%20%5C%5C%0Au%0A%5Cend%7Bbmatrix%7D%0A=%0A%5Cbegin%7Bbmatrix%7D%0AC%20&amp;%20-DG%20%5C%5C%0A0%20&amp;%20C-DG%20%5C%5C%0A0%20&amp;%20-G%0A%5Cend%7Bbmatrix%7D%0A%5Cbegin%7Bbmatrix%7D%0Ax%20%5C%5C%0A%5Chat%7Bx%7D%0A%5Cend%7Bbmatrix%7D%0A"></p>
<p>In order to insure that the estimated states <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmathbf%7Bx%7D%7D"> (and outputs <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmathbf%7By%7D%7D">) have converged before control is enabled, we will first need to generate an augmented LTI closed-loop output-feedback control model with the state feedback gain <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BG%7D"> set to zero (it is easier to just use <img src="https://latex.codecogs.com/png.latex?%5Cleft(0*%5Cmathbf%7BG%7D%5Cright)"> in the matrices). This first LTI object will be used for the first <strong>200 milliseconds</strong> of the response. We must use the same initial states on the plant as defined in CASE 2 above, but the initial observer states must be zero. Our closed-loop state-space output equation must also be augmented to output the following three vectors: <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D">, <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmathbf%7By%7D%7D">, and <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bu%7D">.</p>
<div class="sourceCode" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb49-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xinit_OFC</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xinit</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xinit</span>))]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-2"></span>
<span id="cb49-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aofc_G0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Bol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">K</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">K</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Bol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Cofc_G0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Dol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-6">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Dol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-7">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-8">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eye</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-9">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eye</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb49-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OFC_sys_G0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ss</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aofc_G0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Cofc_G0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[])</span></code></pre></div>
<pre class="text:output"><code>OFC_sys_G0 =
 
  A = 
             x1       x2       x3       x4       x5       x6       x7       x8       x9      x10      x11      x12
   x1         0        1        0        0        0        0        0        0        0        0        0        0
   x2         0       -1        0        0    -9.81        0        0        0        0        0        0        0
   x3         0        0        0        1        0        0        0        0        0        0        0        0
   x4         0        0        0       -3        0        0        0        0        0        0        0        0
   x5         0        0        0        0        0        1        0        0        0        0        0        0
   x6         0        0        0        0        0     -1.6        0        0        0        0        0        0
   x7     47.06        0    11.39        0   -12.65        0   -47.06        1   -11.39        0    12.65        0
   x8     59.19        0   -53.12        0    13.25        0   -59.19       -1    53.12        0   -23.06        0
   x9    -6.596        0    78.71        0    -41.1        0    6.596        0   -78.71        1     41.1        0
   x10     63.6        0    2.236        0  -0.7294        0    -63.6        0   -2.236       -3   0.7294        0
   x11   -5.751        0    40.13        0    10.22        0    5.751        0   -40.13        0   -10.22        1
   x12    1.976        0  -0.8166        0      6.4        0   -1.976        0   0.8166        0     -6.4     -1.6
 
  B = 
     Empty matrix: 12-by-0
 
  C = 
         x1   x2   x3   x4   x5   x6   x7   x8   x9  x10  x11  x12
   y1     1    0    0    0    0    0    0    0    0    0    0    0
   y2     0    0    1    0    0    0    0    0    0    0    0    0
   y3     0    0    0    0    1    0    0    0    0    0    0    0
   y4     0    0    0    0    0    0    1    0    0    0    0    0
   y5     0    0    0    0    0    0    0    0    1    0    0    0
   y6     0    0    0    0    0    0    0    0    0    0    1    0
   y7     0    0    0    0    0    0    0    0    0    0    0    0
   y8     0    0    0    0    0    0    0    0    0    0    0    0
   y9     1    0    0    0    0    0    0    0    0    0    0    0
   y10    0    1    0    0    0    0    0    0    0    0    0    0
   y11    0    0    1    0    0    0    0    0    0    0    0    0
   y12    0    0    0    1    0    0    0    0    0    0    0    0
   y13    0    0    0    0    1    0    0    0    0    0    0    0
   y14    0    0    0    0    0    1    0    0    0    0    0    0
   y15    0    0    0    0    0    0    1    0    0    0    0    0
   y16    0    0    0    0    0    0    0    1    0    0    0    0
   y17    0    0    0    0    0    0    0    0    1    0    0    0
   y18    0    0    0    0    0    0    0    0    0    1    0    0
   y19    0    0    0    0    0    0    0    0    0    0    1    0
   y20    0    0    0    0    0    0    0    0    0    0    0    1
 
  D = 
     Empty matrix: 20-by-0
 
Continuous-time state-space model.
Model Properties</code></pre>
<p>Next, we must generate a second augmented LTI closed-loop output-feedback control model that is identical to the first model except that the state-feedback control gains are not zero, i.e.&nbsp;the controller is enabled. This second LTI object will be used for the remainder of the simulation.</p>
<div class="sourceCode" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb51-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aofc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Bol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb51-2">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">K</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">K</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Bol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb51-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Cofc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Dol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb51-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Dol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb51-5">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb51-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OFC_sys</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ss</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aofc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Cofc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[])</span></code></pre></div>
<pre class="text:output"><code>OFC_sys =
 
  A = 
             x1       x2       x3       x4       x5       x6       x7       x8       x9      x10      x11      x12
   x1         0        1        0        0        0        0        0        0        0        0        0        0
   x2         0       -1        0        0    -9.81        0        0        0        0        0        0        0
   x3         0        0        0        1        0        0        0        0        0        0        0        0
   x4         0        0        0       -3        0        0   -127.3   -89.85   -48.45   -24.94    440.6    4.792
   x5         0        0        0        0        0        1        0        0        0        0        0        0
   x6         0        0        0        0        0     -1.6    363.7    268.8    35.54   -2.918    -1340   -63.86
   x7     47.06        0    11.39        0   -12.65        0   -47.06        1   -11.39        0    12.65        0
   x8     59.19        0   -53.12        0    13.25        0   -59.19       -1    53.12        0   -23.06        0
   x9    -6.596        0    78.71        0    -41.1        0    6.596        0   -78.71        1     41.1        0
   x10     63.6        0    2.236        0  -0.7294        0   -190.9   -89.85   -50.68   -27.94    441.3    4.792
   x11   -5.751        0    40.13        0    10.22        0    5.751        0   -40.13        0   -10.22        1
   x12    1.976        0  -0.8166        0      6.4        0    361.7    268.8    36.36   -2.918    -1347   -65.46
 
  B = 
     Empty matrix: 12-by-0
 
  C = 
           x1      x2      x3      x4      x5      x6      x7      x8      x9     x10     x11     x12
   y1       1       0       0       0       0       0       0       0       0       0       0       0
   y2       0       0       1       0       0       0       0       0       0       0       0       0
   y3       0       0       0       0       1       0       0       0       0       0       0       0
   y4       0       0       0       0       0       0       1       0       0       0       0       0
   y5       0       0       0       0       0       0       0       0       1       0       0       0
   y6       0       0       0       0       0       0       0       0       0       0       1       0
   y7       0       0       0       0       0       0    1133   855.1   -36.2  -115.1   -4293  -270.7
   y8       0       0       0       0       0       0   -2407   -1754  -448.3  -134.3    8699   318.6
 
  D = 
     Empty matrix: 8-by-0
 
Continuous-time state-space model.
Model Properties</code></pre>
<p>We are now ready to simulate the closed-loop response, but it must happen in two separate simulation stages. In the first stage, we will use the INITIAL function to simulate for 200 milliseconds. At the end of this first simulation stage, we must capture the final state vector and use it as the initial state vector for the second simulation stage. The total simulation duration should be 4 seconds like above.</p>
<div class="sourceCode" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb53-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_break</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">200e-03</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% seconds</span></span>
<span id="cb53-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% seconds</span></span>
<span id="cb53-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dt</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dt</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_break</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_break</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dt</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">dt</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-6">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">initial</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OFC_sys_G0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xinit_OFC</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xinit_OFC_break</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_1</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.';</span></span>
<span id="cb53-8">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">initial</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OFC_sys</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xinit_OFC_break</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_1</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_2</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lsiminfo</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SettlingTimeThreshold"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb53-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>).<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TransientTime</span></span></code></pre></div>
<pre class="text:output"><code>ans = 2.5721
ans = 1.6099
ans = 2.1822</code></pre>
<p>Generate the standard annotated plot (three output subplots on the left and two control signal subplots on the right), with appropriate annotations; but we must also plot the estimated output signals on top of the associated actual output signals. It must be clear from our plots that the estimated outputs all start from zero and converge to the actual outputs within 200 milliseconds. One must NOT try to get the observer states to converge too fast because it will be difficult to see the convergence on the plots. If we have done this step correctly, we should see 5% settling times that are comparable to the original design from CASE 2. The 5% settling times on the outputs must all be below 3 seconds, and we must not saturate either of the control signals.</p>
<div class="sourceCode" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb55-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb55-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb55-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>)</span>
<span id="cb55-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hold</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb55-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb55-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TransientTime</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--r'</span>)</span>
<span id="cb55-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlim</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span>])</span>
<span id="cb55-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">legend</span>({<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'${x}$'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'$\hat{x}$'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Interpreter'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'latex'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Location'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'best'</span>)</span>
<span id="cb55-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span>)</span>
<span id="cb55-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb55-11"></span>
<span id="cb55-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb55-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'g'</span>)</span>
<span id="cb55-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hold</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb55-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--black'</span>)</span>
<span id="cb55-16"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlim</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span>])</span>
<span id="cb55-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TransientTime</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--r'</span>)</span>
<span id="cb55-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">legend</span>({<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'${y}$'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'$\hat{y}$'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Interpreter'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'latex'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Location'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'best'</span>)</span>
<span id="cb55-19"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span>)</span>
<span id="cb55-20"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb55-21"></span>
<span id="cb55-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb55-23"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span>)</span>
<span id="cb55-24"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">hold</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb55-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb55-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlim</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span>])</span>
<span id="cb55-27"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>).<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TransientTime</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--r'</span>)</span>
<span id="cb55-28"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">legend</span>({<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'${\theta}$'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'$\hat{\theta}$'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Interpreter'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'latex'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Location'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'best'</span>)</span>
<span id="cb55-29"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (s)'</span>)</span>
<span id="cb55-30"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'rad'</span>)</span>
<span id="cb55-31"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb55-32"></span>
<span id="cb55-33"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb55-34"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>)</span>
<span id="cb55-35"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_max</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb55-36"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_min</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb55-37"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlim</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span>])</span>
<span id="cb55-38"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">legend</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'u_1'</span>)</span>
<span id="cb55-39"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span>)</span>
<span id="cb55-40"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb55-41"></span>
<span id="cb55-42"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb55-43"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>)</span>
<span id="cb55-44"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_max</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb55-45"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_min</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb55-46"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlim</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span>])</span>
<span id="cb55-47"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">legend</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'u_2'</span>)</span>
<span id="cb55-48"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span>)</span>
<span id="cb55-49"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (s)'</span>)</span>
<span id="cb55-50"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb55-51"></span>
<span id="cb55-52"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sgtitle</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Initial Response for Outputs (left) &amp; Inputs (right)'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb55-53"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Position"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>])</span></code></pre></div>
<p><img src="https://www.nishantkb.info/Control Systems/Full_State_Feedback_Control_Design_media/figure_2.png" class="img-fluid"></p>
<p>In addition to the normal five subplot figure, I have also included the animation plot in the LiveScript as documentation of the performance. The <code>als_f23_animate.p</code> MATLAB p-code file can be found in the GitHub repository of the project.</p>
<div class="sourceCode" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb56-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">als_f23_animate</span>( <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p><img src="https://www.nishantkb.info/Control Systems/Full_State_Feedback_Control_Design_media/Simulation_animation.gif" alt="Animated GIF" width="50%"></p>
<section id="for-cases-6-7-and-8-we-will-design-and-simulate-another-output-feedback-controller-i.e.-a-state-estimator-with-full-state-feedback-control-but-now-we-must-also-include-integral-control-for-reference-tracking-as-defined-in-the-notes." class="level2">
<h2 class="anchored" data-anchor-id="for-cases-6-7-and-8-we-will-design-and-simulate-another-output-feedback-controller-i.e.-a-state-estimator-with-full-state-feedback-control-but-now-we-must-also-include-integral-control-for-reference-tracking-as-defined-in-the-notes.">For cases 6, 7, and 8, we will design and simulate another Output Feedback Controller (i.e.&nbsp;a state estimator with full state feedback control), but now we must also include Integral Control for reference tracking as defined in the notes.</h2>

</section>
<section id="we-must-expect-to-iterate-on-cases-6-7-and-8-until-we-achieve-one-acceptable-design." class="level2">
<h2 class="anchored" data-anchor-id="we-must-expect-to-iterate-on-cases-6-7-and-8-until-we-achieve-one-acceptable-design.">We must expect to iterate on CASES 6, 7, and 8 until we achieve one acceptable design.</h2>
</section>
</section>
<section id="case-6.-design-an-lqi-compensator" class="level1">
<h1>CASE 6. Design an LQI compensator</h1>
<p>We must use LQR optimal control to design the state-feedback gains for this simulation. The MathWorks has provided a separate tool called <code>LQI</code> for computing the state-feedback gains when we are implementing state feedback with integral control. Note that <code>LQI</code> is identical to <code>LQR</code> except that <code>LQI</code> already knows that we are designing for reference tracking with an integral controller. We can NOT use <code>LQR</code> for this design, and we must use <code>LQI!</code> We must also use the LTI object for the open-loop system as input to the <code>LQI</code> function. Read the online help for <code>LQI</code> before starting this CASE!</p>
<p>First define the LQI cost function weighting matrices <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BQ%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BR%7D">. Note that <code>LQI</code> also accepts a weighting matrix <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BN%7D">, which allows cross-weighting between states and controls, but we should NOT use this weighting matrix for this CASE! Make sure we understand the dimensions of each of these weighting matrices.</p>
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb57-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">diag</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span></code></pre></div>
<pre class="text:output"><code>Q = 9x9    
     1     0     0     0     0     0     0     0     0
     0     1     0     0     0     0     0     0     0
     0     0     1     0     0     0     0     0     0
     0     0     0     1     0     0     0     0     0
     0     0     0     0     1     0     0     0     0
     0     0     0     0     0     1     0     0     0
     0     0     0     0     0     0     1     0     0
     0     0     0     0     0     0     0     1     0
     0     0     0     0     0     0     0     0     1</code></pre>
<div class="sourceCode" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb59-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">diag</span>([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span></code></pre></div>
<pre class="text:output"><code>R = 2x2    
     1     0
     0     2</code></pre>
<p>Generate and display the optimal control gains and separate them into <img src="https://latex.codecogs.com/png.latex?%7B%5Cmathbf%7BG%7D%7D_0"> and <img src="https://latex.codecogs.com/png.latex?%7B%5Cmathbf%7BG%7D%7D_I"> matrices.</p>
<div class="sourceCode" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb61-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_int_A</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Aol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb61-2">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Col</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb61-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_int_B</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Bol</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb61-4">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Dol</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb61-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_int_sys</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ss</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_int_A</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_int_B</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb61-6">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">e</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lqi</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OL_int_sys</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Q</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">R</span>)</span></code></pre></div>
<pre class="text:output"><code>G = 2x9    
   -3.2779   -2.4232    3.4413    1.1089   29.9386   11.5472    0.8981   -0.4397    0.0000
    1.1514    0.8555    5.0041    1.6054  -11.7328   -4.7892   -0.3109   -0.6351    0.0000

S = 9x9    
1.0e+08 *

    0.0507    0.0507    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.4976
    0.0507    0.0507    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000   -0.4976
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000
    0.0000    0.0000    0.0000    0.0000   -0.0000   -0.0000   -0.0000   -0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.0000   -0.0000   -0.0000   -0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -0.4976   -0.4976    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000    4.8816

e = 9x1 complex    
  -0.0000 + 0.0000i
  -0.1348 + 0.1327i
  -0.1348 - 0.1327i
  -0.5013 + 0.7953i
  -0.5013 - 0.7953i
  -0.9185 + 0.3250i
  -0.9185 - 0.3250i
  -1.6934 + 0.0000i
  -3.0023 + 0.0000i</code></pre>
</section>
<section id="case-7.-construct-the-ofc-with-reference-inputs" class="level1">
<h1>CASE 7. Construct the OFC with Reference Inputs</h1>
<p>Generate an augmented state-space system for the closed-loop Output Feedback Controller (state feedback with estimated states) and Reference Tracking. Our complete closed-loop state-space model must have:</p>
<p>{ State vector consisting of: <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bx%7D">, <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmathbf%7Bx%7D%7D">, and <img src="https://latex.codecogs.com/png.latex?%7B%5Cmathbf%7Bx%7D%7D_I"> }</p>
<p>{ Output vector consisting of: <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D">, <img src="https://latex.codecogs.com/png.latex?%5Chat%7B%5Cmathit%7B%5Cmathbf%7By%7D%7D%7D">, and <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Bu%7D"> }</p>
<p>{ Input vector consisting of: <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Br%7D"> }</p>
<p>{ State Feedback Control law: <img src="https://latex.codecogs.com/png.latex?u=-%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bcc%7D%20%7B%5Cmathbf%7BG%7D%7D_0%20&amp;%20%7B%5Cmathbf%7BG%7D%7D_I%20%5Cend%7Barray%7D%5Cright%5Crbrack%20%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%20%5Chat%7B%5Cmathbf%7Bx%7D%7D%20%5C%5C%20%7B%5Cmathbf%7Bx%7D%7D_I%20%5Cend%7Barray%7D%5Cright%5Crbrack"> }</p>
<p>After generating the closed-loop output feedback control state-space model, compute and display the closed-loop eigenvalues.</p>
<div class="sourceCode" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"></code></pre></div>
</section>
<section id="case-8.-simulate-the-output-feedback-controller-with-reference-inputs" class="level1">
<h1>CASE 8. Simulate the Output Feedback Controller with Reference Inputs</h1>
<p>For this CASE, we will simulate the closed-loop response of our control system using <code>LSIM()</code>; however, we must first generate a suitable reference profile as an input. Before we can generate a reference profile, we need to understand the initial position and the final desired position of the drone. These are new initial conditions, and a very different final position from any closed-loop simulation we have done before.</p>
<p><strong>Initial Plant Conditions:</strong> The plant (drone) must start with the following initial states:</p>
<p><img src="https://latex.codecogs.com/png.latex?x%5Cleft(0%5Cright)=-2"> m, <img src="https://latex.codecogs.com/png.latex?y%5Cleft(0%5Cright)=1"> m, and <img src="https://latex.codecogs.com/png.latex?%5Ctheta%20%5Cleft(0%5Cright)=0"> rad.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cdot%7Bx%7D%20%5Cleft(0%5Cright)=0"> m/s, <img src="https://latex.codecogs.com/png.latex?%5Cdot%7By%7D%20%5Cleft(0%5Cright)=0"> m/s, and <img src="https://latex.codecogs.com/png.latex?%5Cdot%7B%5Ctheta%7D%20%5Cleft(0%5Cright)=0"> rad/s.</p>
<p><strong>Initial Observer Conditions:</strong> We may assume that the initial observer states are identical to the initial plant states.</p>
<p><strong>Final Plant Conditions:</strong> The plant (drone) must reach the following final states:</p>
<p><img src="https://latex.codecogs.com/png.latex?x%5Cleft(0%5Cright)=+2"> m, <img src="https://latex.codecogs.com/png.latex?y%5Cleft(0%5Cright)=0"> m, and <img src="https://latex.codecogs.com/png.latex?%5Ctheta%20%5Cleft(0%5Cright)=0"> rad.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cdot%7Bx%7D%20%5Cleft(0%5Cright)=0"> m/s, <img src="https://latex.codecogs.com/png.latex?%5Cdot%7By%7D%20%5Cleft(0%5Cright)=0"> m/s, and <img src="https://latex.codecogs.com/png.latex?%5Cdot%7B%5Ctheta%7D%20%5Cleft(0%5Cright)=0"> rad/s.</p>
<p><strong>Evaluation Criteria:</strong></p>
<ul>
<li><p>Notice that the final state is on the opposite side of the 1.5m high red wall in the animation! The drone is NOT allowed to make contact with the wall at any point during the simulation.<br>
</p></li>
<li><p>The drone is NOT allowed to make contact with the ground at any point during the simulation except for the final time where the drone must sit on the ground.</p>
<p>{ The drone must reach the final state by 30 seconds (<img src="https://latex.codecogs.com/png.latex?%5Ctextrm%7Btfinal%7D%5Cle%2030s">). }</p></li>
<li><p>The control signals <img src="https://latex.codecogs.com/png.latex?u_1"> and <img src="https://latex.codecogs.com/png.latex?u_2"> must remain within the saturation bounds established in the Midterm Project.</p>
<p>{ There is NO formal settling time requirement; however, our actual output responses <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7By%7D"> must track the reference responses <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7Br%7D">reasonably accurately. For example, if our reference profiles have dwell regions, then there should be zero steady-state error after transients have subsided. If our reference profiles have ramp regions, then we should expect to see a steady-state error during the ramp, which looks like a delayed response. How closely we track the references will depend on our choice of weighting coefficients in the Q matrix. Note that a steady-state error during the ramp is perfectly acceptable as long as we choose the reference profile such that the drone does not make contact with the wall! }</p></li>
<li><p>For this simulation, the observer and the controller must both be enabled at t=0 (i.e.&nbsp;do NOT attempt a two-stage simulation like CASE 5).</p></li>
<li><p>We MUST use <code>LSIM</code> to simulate the closed-loop time response</p>
<p>{ Before constructing the reference profiles, we must first construct a time vector for the simulation. I recommend choosing a uniform step size of <img src="https://latex.codecogs.com/png.latex?%5Ctextrm%7Bts%7D=0%5Cldotp%20002"> seconds: }</p></li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0At=%5Ctextrm%7Bts%7D*%5Cleft%5Clbrack%200:%5Ctextrm%7Bround%7D%5Cleft(%5Cfrac%7B%5Ctextrm%7Btfinal%7D%7D%7B%5Cleft.%5Ctextrm%7Bts%7D%5Cright)%7D%5Cright)%5Cright%5Crbrack%0A"></p>
<ul>
<li>For each time step in the time vector, we must generate a reference vector for each of the outputs. We will need to generate a particular path vs.&nbsp;time profile for the desired x and y position; however, I recommend choosing the following reference profile for the angular position:</li>
</ul>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ctheta_%7B%5Ctextrm%7Bref%7D%7D%20=%5Ctextrm%7Bzeros%7D%5Cleft(%5Ctextrm%7Bsize%7D%5Cleft(t%5Cright)%5Cright)%0A"></p>
<ul>
<li>I have used the same plot structure as before except that new signals that must be added. Each of the three output subplots on the left include the reference profile, the actual output, and the estimated output on the same axis.</li>
<li>Our main goal should be able to reach the final state in a minimum time.</li>
</ul>
<section id="simulation-result" class="level2">
<h2 class="anchored" data-anchor-id="simulation-result">SIMULATION RESULT</h2>
<p><img src="https://www.nishantkb.info/Control Systems/Simulation_animation.gif" style="display: block; margin: 0 auto;" alt="Animated GIF" loop="" width="50%" height="100%"></p>


<!-- -->

</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>Control</category>
  <guid>https://www.nishantkb.info/Control Systems/Full_State_Feedback_Control_Design.html</guid>
  <pubDate>Mon, 12 Feb 2024 04:14:57 GMT</pubDate>
  <media:content url="https://www.nishantkb.info/Control Systems/Simulation_animation.gif" medium="image" type="image/gif"/>
</item>
<item>
  <title>Linearized LTI Modeling Feedback Control</title>
  <link>https://www.nishantkb.info/Control Systems/Linearized_LTI_Modeling_Feedback_Control.html</link>
  <description><![CDATA[ 



<section id="me5554aoe5754ece5754-applied-linear-systems---project-i" class="level1">
<h1><span style="color:rgb(213,80,0)">ME5554/AOE5754/ECE5754 Applied Linear Systems - Project I</span></h1>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clear</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'defaultlinelinewidth'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">format</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">short</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sympref</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'FloatingPointOutput'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">true</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
</section>
<section id="linearized-modeling-and-feedback-control-of-aplanar-drone-delivery-prototype" class="level1">
<h1><u><strong>Linearized Modeling and Feedback Control of aPlanar Drone Delivery Prototype</strong></u></h1>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>A small startup company is exploring an aerial concept for delivering packages (Payload). This concept uses an open-top bin (gray) supported by drone motors and propellors (blue-forward and green-aft).</p>
<p>Prior to developing a full 3D prototype, they have commissioned we to develop and validate a full state feedback control system for a 2D (i.e.&nbsp;planar) version as shown in Figure 1.</p>
<p><img src="https://www.nishantkb.info/Control Systems/Linearized_LTI_Modeling_Feedback_Control_media/image_0.png" alt="image_0.png" width="604"></p>
<p><strong>Figure 1. 2D-Coordinate System Definition for Prototype Aerial Package Delivery System</strong></p>
<p>The following definitions refer to Figure 1:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="https://latex.codecogs.com/png.latex?%20%5Cbegin%7Barray%7D%7Bl%7D%20%5Ctextrm%7BCG%7D=%5Ctextrm%7Bcenter%7D%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bgravity%7D%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bsystem%7D%5C;%5Ctextrm%7Bwith%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bcurrent%7D%5C;%5Ctextrm%7Bpayload%7D%5C;%5Ctextrm%7Bposition%7D%5C%5C%20O=%5Ctextrm%7Borigin%7D%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bworld%7D%5C;%5Ctextrm%7Bcoordinate%7D%5C;%5Ctextrm%7Bsystem%7D%5C%5C%20x%5Cleft(t%5Cright)=%5Ctextrm%7Bhorizontal%7D%5C;%5Ctextrm%7Bposition%7D%5C;%5Cleft%5Clbrack%20m%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7BCG%7D%5C;%5Ctextrm%7Bin%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bworld%7D%5C;%5Ctextrm%7Bcoordinate%7D%5C;%5Ctextrm%7Bsystem%7D%5C%5C%20y%5Cleft(t%5Cright)=%5Ctextrm%7Bvertical%7D%5C;%5Ctextrm%7Bposition%7D%5C;%5Cleft%5Clbrack%20m%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7BCG%7D%5C;%5Ctextrm%7Bin%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bworld%7D%5C;%5Ctextrm%7Bcoordinate%7D%5C;%5Ctextrm%7Bsystem%7D%5C%5C%20%5Ctheta%20%5Cleft(t%5Cright)=%5Ctextrm%7Bangular%7D%5C;%5Ctextrm%7Brotation%7D%5C;%5Cleft%5Clbrack%20%5Ctextrm%7Brad%7D%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bopen%7D-%5Ctextrm%7Btop%7D%5C;%5Ctextrm%7Bbin%7D%5C%5C%20F_1%20%5Cleft(t%5Cright)=%5Ctextrm%7Bbipolar%7D%5C;%5Ctextrm%7Bcontrol%7D%5C;%5Ctextrm%7Bthrust%7D%5C;%5Ctextrm%7Bforce%7D%5C;%5Cleft%5Clbrack%20N%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bat%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bfront%7D%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bbin%7D%5C%5C%20F_2%20%5Cleft(t%5Cright)=%5Ctextrm%7Bbipolar%7D%5C;%5Ctextrm%7Bcontrol%7D%5C;%5Ctextrm%7Bthrust%7D%5C;%5Ctextrm%7Bforce%7D%5C;%5Cleft%5Clbrack%20N%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bat%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Brear%7D%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bbin%7D%20%5Cend%7Barray%7D%20"></p>
<p>The equations of motion for this system are non-linear; however, the following linearized equations are a reasonable approximation for the purposes of this project:</p>
<ol type="1">
<li>Force balance, y-direction: <img src="https://latex.codecogs.com/png.latex?M%5Cddot%7B%5Cmathrm%7By%7D%7D%20%5Cleft(t%5Cright)=F_1%20%5Cleft(t%5Cright)+F_2%20%5Cleft(t%5Cright)-%5Calpha%20%5Cdot%7By%7D%20%5Cleft(t%5Cright)-M%5C;g%5C;"></li>
<li>Moment balance about CG: <img src="https://latex.codecogs.com/png.latex?J%5Cddot%7B%5Ctheta%7D%20%5Cleft(t%5Cright)=d_1%20F_1%20%5Cleft(t%5Cright)-d_2%20F_2%20%5Cleft(t%5Cright)-%5Cbeta%20%5Cdot%7B%5Ctheta%7D%20%5Cleft(t%5Cright)"></li>
<li>Force balance, x-direction: <img src="https://latex.codecogs.com/png.latex?M%5Cddot%7Bx%7D%20%5Cleft(t%5Cright)=-%5Cleft(%7B%5Cbar%7BF%7D%20%7D_1%20+%7B%5Cbar%7BF%7D%20%7D_2%20%5Cright)%5Ctheta%20%5Cleft(t%5Cright)-%5Cgamma%20%5Cdot%7Bx%7D%20%5Cleft(t%5Cright)"></li>
</ol>
<p>The parameters associated with these dynamic equations are defined as:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="https://latex.codecogs.com/png.latex?%20%5Cbegin%7Barray%7D%7Bl%7D%20g=%5Ctextrm%7Bgravity%7D%5C;%5Cleft%5Clbrack%20%5Cfrac%7Bm%7D%7Bs%5E2%20%7D%5Cright%5Crbrack%20%5C%5C%20M=%5Ctextrm%7Btotal%7D%5C;%5Ctextrm%7Bmass%7D%5C;%5Cleft%5Clbrack%20%5Ctextrm%7Bkg%7D%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bsystem%7D%5C;%5Ctextrm%7Bwith%7D%5C;%5Ctextrm%7Bpayload%7D%5C%5C%20J=%5Ctextrm%7Btotal%7D%5C;%5Ctextrm%7Brotational%7D%5C;%5Ctextrm%7Bmoment%7D%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Binertia%7D%5C;%5Cleft%5Clbrack%20%5Ctextrm%7Bkg%7D%5Ccdot%20m%5E2%20%5Cright%5Crbrack%20%5C;%5Ctextrm%7Babout%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7BCG%7D%5C;%5Ctextrm%7Bof%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bsystem%7D%5C;%5Ctextrm%7Bwith%7D%5C;%5Ctextrm%7Bpayload%7D%5C%5C%20%5Calpha%20=%5Ctextrm%7Bvertical%7D%5C;%5Ctextrm%7Baerodynamic%7D%5C;%5Ctextrm%7Bdamping%7D%5C;%5Ctextrm%7Bcoefficient%7D%5C;%5C;%5Cleft%5Clbrack%20%5Cfrac%7BN%5Ccdot%20s%7D%7B%5C;m%7D%5Cright%5Crbrack%20%5C%5C%20%5Cbeta%20=%5Ctextrm%7Brotational%7D%5C;%5Ctextrm%7Baerodynamic%7D%5C;%5Ctextrm%7Bdamping%7D%5C;%5Ctextrm%7Bcoefficient%7D%5C;%5Cleft(%5Cfrac%7BN%5Ccdot%20m%5Ccdot%20s%7D%7B%5Ctextrm%7Brad%7D%7D%5Cright)%5C%5C%20%5Cgamma%20=%5Ctextrm%7Bhorizontal%7D%5C;%5Ctextrm%7Baerodynamic%7D%5C;%5Ctextrm%7Bdamping%7D%5C;%5Ctextrm%7Bcoefficient%7D%5C;%5Cleft(%5Cfrac%7BN%5Ccdot%20s%7D%7Bm%7D%5Cright)%5C%5C%20d_1%20=%5Ctextrm%7Bdistance%7D%5C;%5Cleft%5Clbrack%20m%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bfrom%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7BCG%7D%5C;%5Ctextrm%7Bto%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bfront%7D%5C;%5Ctextrm%7Bcontrol%7D%5C;%5Ctextrm%7Bthrust%7D%5C%5C%20d_2%20=%5Ctextrm%7Bdistance%7D%5C;%5Cleft%5Clbrack%20m%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bfrom%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7BCG%7D%5C;%5Ctextrm%7Bto%7D%5C;%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Brear%7D%5C;%5Ctextrm%7Bcontrol%7D%5C;%5Ctextrm%7Bthrust%7D%20%5Cend%7Barray%7D%20"></p>
</section>
</section>
<section id="problem-1.-equilibrium-thrust-forces" class="level1">
<h1>Problem 1. Equilibrium Thrust Forces</h1>
<p>Notice from the x-direction force balance equation that two variables were introduced. These variables are defined as:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="https://latex.codecogs.com/png.latex?%20%5Cbegin%7Barray%7D%7Bl%7D%20%7B%5Cbar%7BF%7D%20%7D_1%20=%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bnominal%7D%5C;%5Ctextrm%7Bor%7D%5C;%5Ctextrm%7Bsteady%7D-%5Ctextrm%7Bstate%7D%5C;%5Ctextrm%7Bnonzero%7D%5C;%5Ctextrm%7Bfront%7D%5C;%5Ctextrm%7Bthrust%7D%5C;%5Cleft%5Clbrack%20N%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bto%7D%5C;%5Ctextrm%7Bmaintain%7D%5C;%5Ctextrm%7Ban%7D%5C;%5Ctextrm%7Bequilibrium%7D%5C;%5Ctextrm%7Bhover%7D%5C;%5Ctextrm%7Bcondition%7D%5C%5C%20%7B%5Cbar%7BF%7D%20%7D_2%20=%5Ctextrm%7Bthe%7D%5C;%5Ctextrm%7Bnominal%7D%5C;%5Ctextrm%7Bor%7D%5C;%5Ctextrm%7Bsteady%7D-%5Ctextrm%7Bstate%7D%5C;%5Ctextrm%7Bnonzero%7D%5C;%5Ctextrm%7Brear%7D%5C;%5Ctextrm%7Bthrust%7D%5C;%5Cleft%5Clbrack%20N%5Cright%5Crbrack%20%5C;%5Ctextrm%7Bto%7D%5C;%5Ctextrm%7Bmaintain%7D%5C;%5Ctextrm%7Ban%7D%5C;%5Ctextrm%7Bequilibrium%7D%5C;%5Ctextrm%7Bhover%7D%5C;%5Ctextrm%7Bcondition%7D%20%5Cend%7Barray%7D%20"></p>
<p>Derive an analytic formula (i.e.&nbsp;an equation without specific numerical parameter values) relating these two nominal <strong>equilibrium</strong> thrust values to the system parameters.</p>
<p>Hint: When the system is in Equilibrium, all derivatives in the ODE’s must be zero!</p>
<p>Given,</p>
<ol type="1">
<li><img src="https://latex.codecogs.com/png.latex?M%5Cddot%7B%5Cmathrm%7By%7D%7D%20%5Cleft(t%5Cright)=F_1%20%5Cleft(t%5Cright)+F_2%20%5Cleft(t%5Cright)-%5Calpha%20%5Cdot%7By%7D%20%5Cleft(t%5Cright)-M%5C;g%5C;"></li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5CRightarrow%20F_1%20%5Cleft(t%5Cright)+F_2%20%5Cleft(t%5Cright)=M%5C;g"> (1.1)</p>
<ol start="2" type="1">
<li><img src="https://latex.codecogs.com/png.latex?J%5Cddot%7B%5Ctheta%7D%20%5Cleft(t%5Cright)=d_1%20F_1%20%5Cleft(t%5Cright)-d_2%20F_2%20%5Cleft(t%5Cright)-%5Cbeta%20%5Cdot%7B%5Ctheta%7D%20%5Cleft(t%5Cright)"></li>
</ol>
<p><img src="https://latex.codecogs.com/png.latex?%5CRightarrow%20d_1%20F_1%20%5Cleft(t%5Cright)=d_2%20F_2%20%5Cleft(t%5Cright)%5C;"> (1.2)</p>
<ol start="3" type="1">
<li><img src="https://latex.codecogs.com/png.latex?M%5Cddot%7Bx%7D%20%5Cleft(t%5Cright)=-%5Cleft(%7B%5Cbar%7BF%7D%20%7D_1%20+%7B%5Cbar%7BF%7D%20%7D_2%20%5Cright)%5Ctheta%20%5Cleft(t%5Cright)-%5Cgamma%20%5Cdot%7Bx%7D%20%5Cleft(t%5Cright)"></li>
</ol>
<p>At equilibrium, <img src="https://latex.codecogs.com/png.latex?%5Cddot%7Bx%7D%20%5Cleft(t%5Cright)=%5Cdot%7Bx%7D%20%5Cleft(t%5Cright)=0"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cbegin%7Barray%7D%7Bl%7D%20%5CRightarrow%20%5Cleft(%7B%5Cbar%7BF%7D%20%7D_1%20+%7B%5Cbar%7BF%7D%20%7D_2%20%5Cright)%5Ctheta%20%5Cleft(t%5Cright)=0%5C%5C%20%5CRightarrow%20%5Ctheta%20%5Cleft(t%5Cright)=0%5C;%5C;%5Ctextrm%7BOR%7D%5C;%5C;%7B%5Cbar%7BF%7D%20%7D_1%20=-%7B%5Cbar%7BF%7D%20%7D_2%20%5Cend%7Barray%7D"> (1.3)</p>
<p>At equilibrium, <img src="https://latex.codecogs.com/png.latex?%5Ctheta%20%5Cleft(t%5Cright)=0"> , thus we can discard (1.3)</p>
<p>We are left with (1.1) and (1.2)</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">syms</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">M</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g</span></span>
<span id="cb2-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eqn1_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">M</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g</span></span></code></pre></div>
<p>eqn1_1 = <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20F_1%20+F_2%20=M%5C,g"></p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb3-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eqn1_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span>)</span></code></pre></div>
<p>eqn1_2 = $F_1 ,d_1 =F_2 ,d_2 $</p>
</section>
<section id="problem-2.-equations-of-motion-around-the-operating-point" class="level1">
<h1>Problem 2. Equations of Motion around the Operating Point</h1>
<p>We now want to eliminate the equilibrium forces <img src="https://latex.codecogs.com/png.latex?%7B%5Cbar%7BF%7D%20%7D_1"> and <img src="https://latex.codecogs.com/png.latex?%7B%5Cbar%7BF%7D%20%7D_2"> from the equations of motion. To do this, we can introduce what are known as “variational forces”, which are simply zero-mean forces <img src="https://latex.codecogs.com/png.latex?u_1"> and <img src="https://latex.codecogs.com/png.latex?u_2"> which are added to the equilibrium forces to get the total forces:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; <img src="https://latex.codecogs.com/png.latex?%20F_1%20%5Cleft(t%5Cright)=%7B%5Cbar%7BF%7D%20%7D_1%20+u_1%20%5Cleft(t%5Cright)%20"></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; <img src="https://latex.codecogs.com/png.latex?%20F_2%20%5Cleft(t%5Cright)=%7B%5Cbar%7BF%7D%20%7D_2%20+u_2%20%5Cleft(t%5Cright)%20"></p>
<p>Substitute these definitions into the equations of motion and eliminate the equilibrium forces. Our new equations of motion must not have any equilibrium forces remaining and must only include the variational force inputs.</p>
<p>Using (1.1)</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5Cbegin%7Barray%7D%7Bl%7D%20F_1%20%5Cleft(t%5Cright)+F_2%20%5Cleft(t%5Cright)=M%5C;g%5C%5C%20%5CRightarrow%20%7B%5Cbar%7BF%7D%20%7D_1%20+u_1%20%5Cleft(t%5Cright)+F_2%20%5Cleft(t%5Cright)+%7B%5Cbar%7BF%7D%20%7D_2%20+u_2%20%5Cleft(t%5Cright)=M%5C;g%20%5Cend%7Barray%7D%20"></p>
<p>Using (1.2)</p>
<p><img src="https://latex.codecogs.com/png.latex?%20%5Cbegin%7Barray%7D%7Bl%7D%20d_1%20F_1%20%5Cleft(t%5Cright)=d_2%20F_2%20%5Cleft(t%5Cright)%5C;%5C%5C%20%5CRightarrow%20d_%7B1%5C;%7D%20%5Cleft(%7B%5Cbar%7BF%7D%20%7D_1%20+u_1%20%5Cleft(t%5Cright)%5Cright)=d_2%20%5Cleft(%7B%5Cbar%7BF%7D%20%7D_2%20+u_2%20%5Cleft(t%5Cright)%5Cright)%20%5Cend%7Barray%7D%20"></p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb4-1">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">solve</span>([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eqn1_1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eqn1_2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span>])</span></code></pre></div>
<p>F_bar_1 = <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7BM%5C,d_2%20%5C,g%7D%7Bd_1%20+d_2%20%7D"></p>
<p>F_bar_2 = <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cfrac%7BM%5C,d_1%20%5C,g%7D%7Bd_1%20+d_2%20%7D"></p>
</section>
<section id="problem-3.-analytic-state-space-model" class="level1">
<h1>Problem 3. Analytic State-Space Model</h1>
<p>Using the equations of motion from Problem 2, choose appropriate state variables and define a complete state-space representation for this system.</p>
<p>We must assume that the outputs are <img src="https://latex.codecogs.com/png.latex?%5Cleft(x,y,%5Ctheta%20%5Cright)"> because these can be measured with a GPS sensor, and the inputs must be <img src="https://latex.codecogs.com/png.latex?%5Cleft(u_1%20,u_2%20%5Cright)"> .</p>
<p>Definining the State Variables:</p>
<p>X = <img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%20x%5C%5C%20%5Cdot%7Bx%7D%20%5C%5C%20y%5C%5C%20%5Cdot%7By%7D%20%5C%5C%20%5Ctheta%20%5C%5C%20%5Cdot%7B%5Ctheta%7D%20%5Cend%7Barray%7D%5Cright%5Crbrack"> <img src="https://latex.codecogs.com/png.latex?U=%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%20u_1%20%5C%5C%20u_2%20%5Cend%7Barray%7D%5Cright%5Crbrack"> <img src="https://latex.codecogs.com/png.latex?Y=%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bc%7D%20x%5C%5C%20y%5C%5C%20%5Ctheta%20%5C%5C%20u_1%20%5C%5C%20u_2%20%5Cend%7Barray%7D%5Cright%5Crbrack"></p>
<p><img src="https://latex.codecogs.com/png.latex?%20M%5Cddot%7B%5Cmathrm%7By%7D%7D%20%5Cleft(t%5Cright)=F_1%20%5Cleft(t%5Cright)+F_2%20%5Cleft(t%5Cright)-%5Calpha%20%5Cdot%7By%7D%20%5Cleft(t%5Cright)-M%5C;g%5C;%20"></p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb5-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">syms</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">s</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">J</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">alpha</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">beta</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gamma</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Substituting F_1 and F_2</span></span>
<span id="cb5-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">simplify</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1</span>)</span></code></pre></div>
<p>F_1 = <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20u_1%20+%5Cfrac%7BM%5C,d_2%20%5C,g%7D%7Bd_1%20+d_2%20%7D"></p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb6-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">simplify</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2</span>)</span></code></pre></div>
<p>F_2 = <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20u_2%20+%5Cfrac%7BM%5C,d_1%20%5C,g%7D%7Bd_1%20+d_2%20%7D"></p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Defining symbolic vectors for x, x_dot and y</span></span>
<span id="cb7-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sym</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sym</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'x_dot'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-6"></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% From the definitions, we can see that:</span></span>
<span id="cb7-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Using the equations of motions to find </span></span>
<span id="cb7-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% remaining x_dot as a function of x and u</span></span></code></pre></div>
<p><img src="https://latex.codecogs.com/png.latex?%20M%5Cddot%7B%5Cmathrm%7By%7D%7D%20%5Cleft(t%5Cright)=F_1%20%5Cleft(t%5Cright)+F_2%20%5Cleft(t%5Cright)-%5Calpha%20%5Cdot%7By%7D%20%5Cleft(t%5Cright)-M%5C;g%20"></p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb8-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">alpha</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">M</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">M</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p><img src="https://latex.codecogs.com/png.latex?%20J%5Cddot%7B%5Ctheta%7D%20%5Cleft(t%5Cright)=d_1%20F_1%20%5Cleft(t%5Cright)-d_2%20F_2%20%5Cleft(t%5Cright)-%5Cbeta%20%5Cdot%7B%5Ctheta%7D%20%5Cleft(t%5Cright)%20"></p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb9-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">beta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">J</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p><img src="https://latex.codecogs.com/png.latex?%20M%5Cddot%7Bx%7D%20%5Cleft(t%5Cright)=-%5Cleft(%7B%5Cbar%7BF%7D%20%7D_1%20+%7B%5Cbar%7BF%7D%20%7D_2%20%5Cright)%5Ctheta%20%5Cleft(t%5Cright)-%5Cgamma%20%5Cdot%7Bx%7D%20%5Cleft(t%5Cright)%20"></p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb10-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gamma</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">M</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p><img src="https://latex.codecogs.com/png.latex?%20%5Cbegin%7Barray%7D%7Bl%7D%20%5Cdot%7BX%7D%20=AX+BU%5C%5C%20Y=%5Ctextrm%7BCX%7D+%5Ctextrm%7BDU%7D%20%5Cend%7Barray%7D%20"></p>
<p>A = <img src="https://latex.codecogs.com/png.latex?%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bcccccc%7D%200%20&amp;%201%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%200%20&amp;%20-%5Cfrac%7B%5Cgamma%20%7D%7BM%7D%20&amp;%200%20&amp;%200%20&amp;%20-g%20&amp;%200%5C%5C%200%20&amp;%200%20&amp;%200%20&amp;%201%20&amp;%200%20&amp;%200%5C%5C%200%20&amp;%200%20&amp;%200%20&amp;%20-%5Cfrac%7B%5Calpha%20%7D%7BM%7D%20&amp;%200%20&amp;%200%5C%5C%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%201%5C%5C%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%20-%5Cfrac%7B%5Cbeta%20%7D%7BJ%7D%20%5Cend%7Barray%7D%5Cright%5Crbrack"> <img src="https://latex.codecogs.com/png.latex?B=%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bcc%7D%200%20&amp;%200%5C%5C%200%20&amp;%200%5C%5C%200%20&amp;%200%5C%5C%20%5Cfrac%7B1%7D%7BM%7D%20&amp;%20%5Cfrac%7B1%7D%7BM%7D%5C%5C%200%20&amp;%200%5C%5C%20%5Cfrac%7Bd_1%20%7D%7BJ%7D%20&amp;%20-%5Cfrac%7Bd_2%20%7D%7BJ%7D%20%5Cend%7Barray%7D%5Cright%5Crbrack"></p>
<p><img src="https://latex.codecogs.com/png.latex?%20C=%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bcccccc%7D%201%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%200%20&amp;%200%20&amp;%201%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%201%20&amp;%200%5C%5C%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%5C%5C%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%20&amp;%200%20%5Cend%7Barray%7D%5Cright%5Crbrack%20"> <img src="https://latex.codecogs.com/png.latex?%20D=%5Cleft%5Clbrack%20%5Cbegin%7Barray%7D%7Bcc%7D%200%20&amp;%200%5C%5C%200%20&amp;%200%5C%5C%200%20&amp;%200%5C%5C%201%20&amp;%200%5C%5C%200%20&amp;%201%20%5Cend%7Barray%7D%5Cright%5Crbrack%20"> # Problem 4. Define system parameters as Matlab variables</p>
<p>Up to this point, we have only used algebraic symbols to describe parameters in the state-space model. It is now time to substitute numerical values for these parameters. Define variables in Matlab for the following parameters:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="https://latex.codecogs.com/png.latex?%20%5Cbegin%7Barray%7D%7Bl%7D%20g=9%5Cldotp%2081%5C;%5Cleft(m/s%5E2%20%5Cright)%5C%5C%20M=10%5C;%5Cleft(%5Ctextrm%7Bkg%7D%5Cright)%5C;%5C%5C%20J=5%5C;%5Cleft(%5Ctextrm%7Bkg%7D%5C;%7B%5C;m%7D%5E2%20%5Cright)%5C;%5C%5C%20%5Calpha%20=30%5C;%5Cleft(N%5C;s/m%5Cright)%5C%5C%20%5Cbeta%20=8%5C;%5Cleft(N%5C;m%5C;s/%5Ctextrm%7Brad%7D%5Cright)%5C%5C%20%5Cgamma%20=10%5C;%5Cleft(N%5C;s/m%5Cright)%5C%5C%20d_1%20=0%5Cldotp%20651%5C;%5Cleft(%5Ctextrm%7Bmeters%7D%5Cright)%5C;%5C%5C%20d_2%20=0%5Cldotp%20449%5C;%5Cleft(%5Ctextrm%7Bmeters%7D%5Cright)%5C;%5C%5C%20F_%7B%5Cmax%20%7D%20=%5Cpm%202000%5C;%5Cleft(N%5Cright)%5C;%5C;%5C;%5C;%5C;%5Ctextrm%7Bmaximum%7D%5C;%5Ctextrm%7Bavailable%7D%5C;%5Ctextrm%7Bthrust%7D%5C;%5Ctextrm%7Bon%7D%5C;%5Ctextrm%7Beither%7D%5C;F_1%20%5C;%5Ctextrm%7Bor%7D%5C;F_2%20%20%5Cend%7Barray%7D%20"></p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb11-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">g</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.81</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">M</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">J</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">alpha</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">beta</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">gamma</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.651</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">d2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.449</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p>Compute the nominal equlibrium thrust forces and the maximum variational forces.</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb12-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_1</span>)</span></code></pre></div>
<p>F_bar_1 = <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%2040.0426"></p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb13-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_bar_2</span>)</span></code></pre></div>
<p>F_bar_2 = <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%2058.0574"></p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb14-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-3"></span>
<span id="cb14-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Finding max and min values for the variational forces u1 and u2</span></span>
<span id="cb14-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_min</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">solve</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_max</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">solve</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_min</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">solve</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_max</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">solve</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">F_2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-9"></span>
<span id="cb14-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">disp</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">string</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_min</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">' N &lt; u1(t) &lt; '</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">string</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_max</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">' N'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">newline</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">...</span></span>
<span id="cb14-11">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">string</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_min</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">' N &lt; u2(t) &lt; '</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">string</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_max</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">' N'</span>)</span></code></pre></div>
<pre class="textoutput"><code>-2039 N &lt; u1(t) &lt; 1959 N
-2057.1 N &lt; u2(t) &lt; 1940.9 N</code></pre>
</section>
<section id="problem-5.-numerical-state-space-model-with-state-input-and-output-names" class="level1">
<h1>Problem 5. Numerical State-space model with state, input, and output names</h1>
<p>Construct an LTI State-Space object in Matlab using the defined variables from Problem 4.</p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb16-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">expand</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span>)</span></code></pre></div>
<p>ans = <img src="https://latex.codecogs.com/png.latex?%5Cdisplaystyle%20%5Cleft(%5Cbegin%7Barray%7D%7Bc%7D%20x_2%20%5C%5C%20-%5Cfrac%7B%5Cgamma%20%5C,x_2%20%7D%7BM%7D-%5Cfrac%7Bd_1%20%5C,g%5C,x_5%20%7D%7Bd_1%20+d_2%20%7D-%5Cfrac%7Bd_2%20%5C,g%5C,x_5%20%7D%7Bd_1%20+d_2%20%7D%5C%5C%20x_4%20%5C%5C%20%5Cfrac%7Bu_1%20%7D%7BM%7D-g+%5Cfrac%7Bu_2%20%7D%7BM%7D+%5Cfrac%7Bd_1%20%5C,g%7D%7Bd_1%20+d_2%20%7D+%5Cfrac%7Bd_2%20%5C,g%7D%7Bd_1%20+d_2%20%7D-%5Cfrac%7B%5Calpha%20%5C,x_4%20%7D%7BM%7D%5C%5C%20x_6%20%5C%5C%20%5Cfrac%7Bd_1%20%5C,u_1%20%7D%7BJ%7D-%5Cfrac%7Bd_2%20%5C,u_2%20%7D%7BJ%7D-%5Cfrac%7B%5Cbeta%20%5C,x_6%20%7D%7BJ%7D%20%5Cend%7Barray%7D%5Cright)"></p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb17-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">jacobian</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">B</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">jacobian</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x_dot</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">C</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">jacobian</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">D</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">jacobian</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ss</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">B</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">C</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">D</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p>We must define the ‘StateName’, ‘InputName’, and ‘OutputName’ properties of our LTI state-space object with strings that are representative of the actual states, inputs, and outputs. We may also want to define the StateUnit, InputUnit, and OutputUnit properties as well.</p>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb18-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stateNames</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'X Position'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'X Velocity'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Y Position'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Y Velocity'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Angular Position'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Angular Velocity'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputNames</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Varitional Force 1'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Varitional Force 2'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputNames</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'X Position'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Y Position'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Angular Position'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Varitional Force 1'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Varitional Force 2'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-4"></span>
<span id="cb18-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stateUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m/s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m/s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'rad'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'rad/s'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'m'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'rad'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'N'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-8"></span>
<span id="cb18-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">StateName</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stateNames</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">InputName</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputNames</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OutputName</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputNames</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">StateUnit</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">stateUnits</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">InputUnit</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputUnits</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">OutputUnit</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputUnits</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<p>Then we display our final numerical state-space model to the LiveScript and save it to a .mat file for use in the <code>Final Project</code>.</p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb19-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span></span></code></pre></div>
<pre class="textoutput"><code>sys =
 
  A = 
                   X Position    X Velocity    Y Position    Y Velocity  Angular Posi  Angular Velo
   X Position               0             1             0             0             0             0
   X Velocity               0            -1             0             0         -9.81             0
   Y Position               0             0             0             1             0             0
   Y Velocity               0             0             0            -3             0             0
   Angular Posi             0             0             0             0             0             1
   Angular Velo             0             0             0             0             0          -1.6
 
  B = 
                 Varitional F  Varitional F
   X Position               0             0
   X Velocity               0             0
   Y Position               0             0
   Y Velocity             0.1           0.1
   Angular Posi             0             0
   Angular Velo        0.1302       -0.0898
 
  C = 
                   X Position    X Velocity    Y Position    Y Velocity  Angular Posi  Angular Velo
   X Position               1             0             0             0             0             0
   Y Position               0             0             1             0             0             0
   Angular Posi             0             0             0             0             1             0
   Varitional F             0             0             0             0             0             0
   Varitional F             0             0             0             0             0             0
 
  D = 
                 Varitional F  Varitional F
   X Position               0             0
   Y Position               0             0
   Angular Posi             0             0
   Varitional F             1             0
   Varitional F             0             1
 
Continuous-time state-space model.
Model Properties</code></pre>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb21-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'MP_nishant_ss_model.mat'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb21-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">save</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">filename</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'sys'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
</section>
<section id="problem-6.-check-for-minimum-realization" class="level1">
<h1>Problem 6. Check for minimum realization</h1>
<p>Use the <samp>MINREAL()</samp> function to demonstrate that our system is a minimum realization.</p>
<p>Hint: We have to compare the number of states of our original system to the number of states in the minimum realization.</p>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb22-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">min_sys</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">minreal</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">min_sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span>) </span>
<span id="cb22-3">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">disp</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'System is minimum realization'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> </span>
<span id="cb22-5">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">disp</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'System is not minimum realization'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span> </span></code></pre></div>
<pre class="textoutput"><code>System is minimum realization</code></pre>
</section>
<section id="problem-7.-controllability-test" class="level1">
<h1>Problem 7. Controllability test</h1>
<p>Demonstrate that the open-loop system is completely controllable and explain our result.</p>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Check controllability of the State-Space model</span></span>
<span id="cb24-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ctrb_matrix</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ctrb</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">B</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb24-3"></span>
<span id="cb24-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Determine the rank of the controllability matrix</span></span>
<span id="cb24-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank_ctrb</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ctrb_matrix</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb24-6"></span>
<span id="cb24-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank_ctrb</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb24-8">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'The system is controllable.\n'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb24-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span></span>
<span id="cb24-10">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'The system is not controllable.\n'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb24-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span></code></pre></div>
<pre class="textoutput"><code>The system is controllable.</code></pre>
<p>Determine if the system is controllable with only one actuator (we must check both!).</p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% We can slice off the other columns of B to check for one input at a time</span></span>
<span id="cb26-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% and then calculate the controllability with respect to the chosen input.</span></span>
<span id="cb26-3"></span>
<span id="cb26-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_to_check</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">B</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb26-5">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ctrb_matrix</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ctrb</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">B</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_to_check</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-6">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank_ctrb</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ctrb_matrix</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-7"></span>
<span id="cb26-8">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">rank_ctrb</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb26-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'The system is controllable with respect to input %d.\n'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_to_check</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span></span>
<span id="cb26-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'The system is not controllable with respect to input %d.\n'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">input_to_check</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb26-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb26-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span> </span></code></pre></div>
<pre class="textoutput"><code>The system is not controllable with respect to input 1.
The system is not controllable with respect to input 2.</code></pre>
</section>
<section id="problem-8.-open-loop-poles-natural-frequencies" class="level1">
<h1>Problem 8. Open-loop poles &amp; natural frequencies</h1>
<p>Compute the open-loop eigenvalues, damping ratios, time constants, and natural frequencies in Hz. Construct a table using the Matlab <samp>TABLE()</samp> function, then display a formatted table with appropriate column and row headings in the LiveScript.</p>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Compute the open-loop eigenvalues</span></span>
<span id="cb28-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eigenvalues</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eig</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-3"></span>
<span id="cb28-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Calculate the damping ratios, time constant and natural frequencies in Hz</span></span>
<span id="cb28-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">damping_ratios</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">real</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eigenvalues</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">./</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eigenvalues</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">natural_frequencies_Hz</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">abs</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eigenvalues</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">time_constants</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">./-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">real</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eigenvalues</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-8"></span>
<span id="cb28-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Table</span></span>
<span id="cb28-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">variable_names</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Eigenvalues'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Damping Ratios'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time Constants'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Natural Frequencies (Hz)'</span>}<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">table_results</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">table</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eigenvalues</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">damping_ratios</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">time_constants</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">natural_frequencies_Hz</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'VariableNames'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">variable_names</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">disp</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">table_results</span>)</span></code></pre></div>
<pre class="textoutput"><code>    Eigenvalues    Damping Ratios    Time Constants    Natural Frequencies (Hz)
    ___________    ______________    ______________    ________________________
          0             NaN                -Inf                      0         
         -1               1                   1                0.15915         
          0             NaN                -Inf                      0         
         -3               1             0.33333                0.47746         
          0             NaN                -Inf                      0         
       -1.6               1               0.625                0.25465         </code></pre>
</section>
<section id="problem-9.-open-loop-initial-value-response-simulation" class="level1">
<h1>Problem 9. Open-Loop Initial Value response simulation</h1>
<p>Assume that the system starts with the following initial positions and velocities:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="https://latex.codecogs.com/png.latex?x%5Cleft(0%5Cright)=-2"> m, <img src="https://latex.codecogs.com/png.latex?y%5Cleft(0%5Cright)=1"> m, and <img src="https://latex.codecogs.com/png.latex?%5Ctheta%20%5Cleft(0%5Cright)=0%5Cldotp%205"> rad.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="https://latex.codecogs.com/png.latex?%5Cdot%7Bx%7D%20%5Cleft(0%5Cright)=10"> m/s, <img src="https://latex.codecogs.com/png.latex?%5Cdot%7By%7D%20%5Cleft(0%5Cright)=-1%5Cldotp%205"> m/s, and <img src="https://latex.codecogs.com/png.latex?%5Cdot%7B%5Ctheta%7D%20%5Cleft(0%5Cright)=-0%5Cldotp%205"> rad/s.</p>
<p>Use the Matlab <samp>INITIAL</samp> function to compute the initial value response. Choose a final time that is four times the largest open-loop finite time constant.</p>
<p>Plot the initial value response. There must be three subplots on the left of the figure, one for each of the outputs, and two subplots on the right, one for each control signal. Note that the control signals for the open-loop system must be zero!</p>
<p>All subplots must be properly annotated with axis labels, units, and grid lines.</p>
<p>The control output plots must also show the upper and lower saturation constraints for the signals.</p>
<p>Use the LSIMINFO function to estimate the 5% settling time for each OUTPUT, and place a marker on each output plot at the location of its 5% settling time.</p>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Setting up initial conditions, new values</span></span>
<span id="cb30-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb30-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Calculating Initival Value Response for open loop system</span></span>
<span id="cb30-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Choosing final time 4x of maximum time constant</span></span>
<span id="cb30-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">./-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">real</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eigenvalues</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span></code></pre></div>
<pre class="textoutput"><code>t_final = 4</code></pre>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb32-1">[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">initial</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb32-2"></span>
<span id="cb32-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lsiminfo</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SettlingTimeThreshold"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)</span></code></pre></div>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 20%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Fields</th>
<th style="text-align: center;">TransientTime</th>
<th style="text-align: center;">SettlingTime</th>
<th style="text-align: center;">Min</th>
<th style="text-align: center;">MinTime</th>
<th style="text-align: center;">Max</th>
<th style="text-align: center;">MaxTime</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">3.8735</td>
<td style="text-align: center;">3.8626</td>
<td style="text-align: center;">-11.3930</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">-0.9009</td>
<td style="text-align: center;">0.6000</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.9986</td>
<td style="text-align: center;">0.9986</td>
<td style="text-align: center;">0.5000</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">1.8532</td>
<td style="text-align: center;">0.6533</td>
<td style="text-align: center;">0.4376</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.5000</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb33-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-2"></span>
<span id="cb33-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb33-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% odd numbers for left side</span></span>
<span id="cb33-5">  </span>
<span id="cb33-6">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-7">    </span>
<span id="cb33-8">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">find</span>((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>).<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TransientTime</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb33-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--r'</span>)</span>
<span id="cb33-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb33-12">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clear</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span></span>
<span id="cb33-13"></span>
<span id="cb33-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">title</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputNames</span>{<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-15">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (s)'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-16">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputUnits</span>{<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-17">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb33-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb33-19"></span>
<span id="cb33-20"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb33-21">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% even numbers for right side</span></span>
<span id="cb33-22">    </span>
<span id="cb33-23">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% 4 and 5 for u1 and u2</span></span>
<span id="cb33-24">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylim</span>([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2500</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2500</span>])</span>
<span id="cb33-25">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb33-26">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_max</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb33-27">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_min</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb33-28">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb33-29">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb33-30">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_max</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb33-31">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_min</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb33-32">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb33-33"></span>
<span id="cb33-34">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">title</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputNames</span>{(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-35">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (s)'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-36">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputUnits</span>{(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-37">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb33-38">    </span>
<span id="cb33-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb33-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Adjust the overall plot title</span></span>
<span id="cb33-41"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sgtitle</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Initial Response for Outputs (left) &amp; Inputs (right)'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb33-42"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Position"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">800</span>])</span></code></pre></div>
<p><img src="https://www.nishantkb.info/Control Systems/Linearized_LTI_Modeling_Feedback_Control_media/figure_0.png" alt="figure_0.png" width="604"></p>
<p><strong>Provide a physical explanation for the open-loop response.</strong></p>
<p>In problem 1, we derived the equilibrium forces for a special equilibrium where all the accelerations and velocity terms are zero. We found that there is a constant nominal force of <img src="https://latex.codecogs.com/png.latex?%5Cbar%7BF_%7B1%5C;%7D%20%7D%20=40%5C;N%5C;%5C&amp;%5C;%5Cbar%7BF_2%20%7D%20=58%5C;N"> on the system. So when <img src="https://latex.codecogs.com/png.latex?u_1%20=u_%7B2%5C;%7D%20=0"> , we still have a thrust force <img src="https://latex.codecogs.com/png.latex?F_1%20=%5Cbar%7BF_%7B1%5C;%7D%20%7D%20=40%5C;N%5C;%5C&amp;%5C;F_2%20=%5Cbar%7BF_2%20%7D%20=58%5C;N"> actint on the payload.</p>
<p>A body attains equilibrium in the steady state when the forces on it on are balanced, i.e.&nbsp;accelerations are zero or velocities are constant. In the open-loop response, we can see that the systems attains equilibrium at a non-zero value of <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> , stable position in y and a constant velocity in the negative x direction.</p>
<p><strong>Why does the steady-state response look the way it does?</strong></p>
<p>We have our nominal forces acting in the y direction balancing out the force due to gravity. Initially we see a deceleration due to the vertical aerodynamic damping and the velocity in y reduces to zero.</p>
<p>In the rotational plane, the thrust forces <img src="https://latex.codecogs.com/png.latex?d_1%20F_1%20=d_2%20F_2"> , balance each other, and due to the roational aerodynamic damping the rotational velocity becomes zero.</p>
<p>In the x plane, as <img src="https://latex.codecogs.com/png.latex?%5Ctheta"> is not zero, for the forces to be balanced, the components <img src="https://latex.codecogs.com/png.latex?%5Cleft(%7B%5Cbar%7BF%7D%20%7D_1%20+%7B%5Cbar%7BF%7D%20%7D_2%20%5Cright)%5Ctheta%20%5Cleft(t%5Cright)=-%5Cgamma%20%5Cdot%7Bx%7D%20%5Cleft(t%5Cright)"> . This results in the body having a constant negative velocity, whose damping force is balancing the thrust force component in the x direction. If <img src="https://latex.codecogs.com/png.latex?%5Ctheta%20%5Cleft(t%5Cright)=0"> or sum of nominal components is zero, only then we can have a zero velocity at equilibrium for the payload.</p>
</section>
<section id="problem-10.-closed-loop-design-case-study" class="level1">
<h1>Problem 10. Closed-Loop Design Case Study</h1>
<p>Document five unique sets of closed-loop pole locations for full state feedback.</p>
<p>The target design requirements are:</p>
<ul>
<li>The 5% settling times for all of the outputs must be less than 3 seconds</li>
<li>The peak absolute variational control signal must not exceed the saturation limits as defined above</li>
</ul>
<p>For each design, document the following:</p>
<ul>
<li>5% settling times on each of the output responses</li>
<li>Peak absolute control for each of the control signals</li>
<li>Does either of our closed-loop control signals exceed the saturation limits?</li>
<li>Why did we choose this set of pole locations for the design?</li>
</ul>
<p>We must use the <samp>PLACE</samp> function for each of our designs to compute the state feedback gains. After computing the state feedback gains, display a table of the closed-loop poles to demonstrate that we successfully placed the poles at the design locations.</p>
<p>Develop a closed-loop LTI model that augments the open-loop output vector with the two control signals, so our closed-loop output equation will have five outputs for plotting.</p>
<p>Use the Matlab <samp>INITIAL</samp> function to compute the initial value response with the same initial condition vector that was used in the open-loop evaluation.</p>
<p>Choose a final time that is fifteen times the largest open-loop time constant. % Annocement says plot at least 4s, prof used 10s</p>
<p>Plot the initial value response. There must be three subplots on the left of the figure, one for each of the outputs, and two subplots on the right, one for each control signal. All subplots must be properly annotated with axis labels, units, and grid lines. The control output plots must also show the upper and lower saturation constraints for the signals.</p>
<p>Use the <samp>LSIMINFO</samp> function to estimate the 5% settling time for each OUTPUT, and place a marker on each output plot at the location of its 5% settling time.</p>
<div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb34-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Select positions for closed loop poles</span></span>
<span id="cb34-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">designcase</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>    </span>
<span id="cb34-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">switch</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">designcase</span></span>
<span id="cb34-4">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">case</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb34-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n Design Case %d: Linearly spaced real poles \n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">designcase</span>)</span>
<span id="cb34-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">linspace</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-7">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">case</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb34-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n Design Case %d: Poles with same real part and linearly spaced imaginary part \n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">designcase</span>)</span>
<span id="cb34-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.75</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5j</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">case</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb34-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n Design Case %d: Poles with same natural frequency and varying damping ratios \n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">designcase</span>)</span>
<span id="cb34-12">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta_values</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-14">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">length</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb34-15">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta_values</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-16">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-17">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">length</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-18">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb34-19">        </span>
<span id="cb34-20">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">case</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb34-21">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n Design Case %d: Poles with same damping ratio and varying natural frequencies \n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">designcase</span>)</span>
<span id="cb34-22">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.65</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-23">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn_values</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-24">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">length</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb34-25">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn_values</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-26">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-27">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">length</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">z</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-28">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb34-29">        </span>
<span id="cb34-30">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">case</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb34-31">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"\n Design Case %d: Poles with same imaginary part and linearly spaced real part \n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">designcase</span>)</span>
<span id="cb34-32">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1j</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-33">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb34-34"></span>
<span id="cb34-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Finding gains of the full state feedback</span></span>
<span id="cb34-36">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">place</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">B</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clpoles</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% set up the closed-loop simulation</span></span>
<span id="cb34-38"></span>
<span id="cb34-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Caclulcate A for closed loop system</span></span>
<span id="cb34-40">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ac</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">A</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">B</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-41">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Cc</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">C</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">D</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">G</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-42">    </span>
<span id="cb34-43">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Rebuild the SS for closed loop</span></span>
<span id="cb34-44">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">syscl</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ss</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Ac</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">B</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">Cc</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeros</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sys</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">D</span>)))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-45">    [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">damp</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">syscl</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-46">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">array2table</span>([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">wn</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">./</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">pi</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">zeta</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">p</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'VariableNames'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span>{<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Natural Freq (Hz)'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Damping Ratio'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Poles'</span>})</span>
<span id="cb34-47">    </span>
<span id="cb34-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% run the closed-loop initial value response simulation</span></span>
<span id="cb34-49">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% Using the initial values to calculate response for closed loop</span></span>
<span id="cb34-50">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% choosing a time that is 10 times the largest open-loop time constant</span></span>
<span id="cb34-51">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">max</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">./-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">real</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">eigenvalues</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-52">    [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">initial</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">syscl</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">x0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_final</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-53">    </span>
<span id="cb34-54">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">lsiminfo</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SettlingTimeThreshold"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-55">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% plot the results</span></span>
<span id="cb34-56">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">figure</span>()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-57">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">set</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">f</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Position"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">700</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-58">    </span>
<span id="cb34-59">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb34-60">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-61">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-62"></span>
<span id="cb34-63">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">find</span>((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>).<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TransientTime</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-64">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb34-65">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--r'</span>)</span>
<span id="cb34-66">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb34-67">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clear</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span></span>
<span id="cb34-68">    </span>
<span id="cb34-69">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">title</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputNames</span>{<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-70">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (s)'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-71">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputUnits</span>{<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-72">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb34-73">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb34-74">    </span>
<span id="cb34-75">    </span>
<span id="cb34-76">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb34-77">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">subplot</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-78">        </span>
<span id="cb34-79">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">plot</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">y_ivr</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-80">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylim</span>([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2500</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2500</span>])</span>
<span id="cb34-81">    </span>
<span id="cb34-82">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb34-83">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_max</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb34-84">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u1_min</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb34-85">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb34-86">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb34-87">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_max</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb34-88">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">yline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">double</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">u2_min</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--b'</span>)</span>
<span id="cb34-89">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb34-90"></span>
<span id="cb34-91">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">find</span>((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>).<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">TransientTime</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-92">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">size</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb34-93">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xline</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">t_ivr</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'--r'</span>)</span>
<span id="cb34-94">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb34-95">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">clear</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">index</span></span>
<span id="cb34-96"></span>
<span id="cb34-97">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">title</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputNames</span>{(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-98">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">xlabel</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (s)'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-99">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ylabel</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'%s'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">inputUnits</span>{(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">i</span>)}))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-100">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">grid</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">on</span></span>
<span id="cb34-101">        </span>
<span id="cb34-102">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span>
<span id="cb34-103">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sgtitle</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'DesignCase %d : Initial Response for Outputs (left) &amp; Inputs (right)'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">designcase</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-104">    </span>
<span id="cb34-105">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">fprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Design Case %d: Performance Metrics \n"</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">designcase</span>)</span>
<span id="cb34-106">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% generate a table of performance metrics</span></span>
<span id="cb34-107">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">T</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">struct2table</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">S</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb34-108">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">T</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputNames</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputNames</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">';</span></span>
<span id="cb34-109">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">T</span>.<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputUnits</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">outputUnits</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">';</span></span>
<span id="cb34-110">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">T</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:,</span>{<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'outputNames'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'TransientTime'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Max'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'Min'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">,</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'outputUnits'</span>})</span>
<span id="cb34-111"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">end</span></span></code></pre></div>
<pre class="textoutput"><code> Design Case 1: Linearly spaced real poles </code></pre>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Natural&nbsp;Freq&nbsp;(Hz)</th>
<th style="text-align: center;">Damping&nbsp;Ratio</th>
<th style="text-align: center;">Poles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.3183</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-2</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.3565</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-2.2400</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.3947</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-2.4800</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.4329</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-2.7200</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.4711</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-2.9600</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.5093</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-3.2000</td>
</tr>
</tbody>
</table>
<p><img src="https://www.nishantkb.info/Control Systems/Linearized_LTI_Modeling_Feedback_Control_media/figure_1.png" alt="figure_1.png" width="604"></p>
<pre class="textoutput"><code>Design Case 1: Performance Metrics </code></pre>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 29%">
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">outputNames</th>
<th style="text-align: center;">TransientTime</th>
<th style="text-align: center;">Max</th>
<th style="text-align: center;">Min</th>
<th style="text-align: center;">outputUnits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">‘X Position’</td>
<td style="text-align: center;">2.3204</td>
<td style="text-align: center;">-0</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">‘Y Position’</td>
<td style="text-align: center;">2.8049</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-0.4977</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">‘Angular Position’</td>
<td style="text-align: center;">0.8766</td>
<td style="text-align: center;">0.5000</td>
<td style="text-align: center;">-0.0065</td>
<td style="text-align: center;">‘rad’</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">‘Varitional Force 1’</td>
<td style="text-align: center;">1.3550</td>
<td style="text-align: center;">9.5769</td>
<td style="text-align: center;">-121.7398</td>
<td style="text-align: center;">‘N’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">‘Varitional Force 2’</td>
<td style="text-align: center;">1.7867</td>
<td style="text-align: center;">9.3795</td>
<td style="text-align: center;">-86.4857</td>
<td style="text-align: center;">‘N’</td>
</tr>
</tbody>
</table>
<pre class="textoutput"><code> Design Case 2: Poles with same real part and linearly spaced imaginary part </code></pre>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Natural&nbsp;Freq&nbsp;(Hz)</th>
<th style="text-align: center;">Damping&nbsp;Ratio</th>
<th style="text-align: center;">Poles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.2897</td>
<td style="text-align: center;">0.9615</td>
<td style="text-align: center;">-1.7500 + 0.5000i</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.2897</td>
<td style="text-align: center;">0.9615</td>
<td style="text-align: center;">-1.7500 - 0.5000i</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.3208</td>
<td style="text-align: center;">0.8682</td>
<td style="text-align: center;">-1.7500 + 1.0000i</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.3208</td>
<td style="text-align: center;">0.8682</td>
<td style="text-align: center;">-1.7500 - 1.0000i</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.3668</td>
<td style="text-align: center;">0.7593</td>
<td style="text-align: center;">-1.7500 + 1.5000i</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.3668</td>
<td style="text-align: center;">0.7593</td>
<td style="text-align: center;">-1.7500 - 1.5000i</td>
</tr>
</tbody>
</table>
<p><img src="https://www.nishantkb.info/Control Systems/Linearized_LTI_Modeling_Feedback_Control_media/figure_2.png" alt="figure_2.png" width="604"></p>
<pre class="textoutput"><code>Design Case 2: Performance Metrics </code></pre>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 30%">
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">outputNames</th>
<th style="text-align: center;">TransientTime</th>
<th style="text-align: center;">Max</th>
<th style="text-align: center;">Min</th>
<th style="text-align: center;">outputUnits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">‘X Position’</td>
<td style="text-align: center;">2.7911</td>
<td style="text-align: center;">0.0002</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">‘Y Position’</td>
<td style="text-align: center;">2.0540</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-0.0676</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">‘Angular Position’</td>
<td style="text-align: center;">1.9466</td>
<td style="text-align: center;">0.5000</td>
<td style="text-align: center;">-0.0434</td>
<td style="text-align: center;">‘rad’</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">‘Varitional Force 1’</td>
<td style="text-align: center;">1.5816</td>
<td style="text-align: center;">2.4078</td>
<td style="text-align: center;">-40.3949</td>
<td style="text-align: center;">‘N’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">‘Varitional Force 2’</td>
<td style="text-align: center;">2.6339</td>
<td style="text-align: center;">0.8480</td>
<td style="text-align: center;">-10.2505</td>
<td style="text-align: center;">‘N’</td>
</tr>
</tbody>
</table>
<pre class="textoutput"><code> Design Case 3: Poles with same natural frequency and varying damping ratios </code></pre>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Natural&nbsp;Freq&nbsp;(Hz)</th>
<th style="text-align: center;">Damping&nbsp;Ratio</th>
<th style="text-align: center;">Poles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.3979</td>
<td style="text-align: center;">0.5000</td>
<td style="text-align: center;">-1.2500 + 2.1651i</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.3979</td>
<td style="text-align: center;">0.5000</td>
<td style="text-align: center;">-1.2500 - 2.1651i</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.3979</td>
<td style="text-align: center;">0.9000</td>
<td style="text-align: center;">-2.2500 + 1.0897i</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.3979</td>
<td style="text-align: center;">0.9000</td>
<td style="text-align: center;">-2.2500 - 1.0897i</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.3979</td>
<td style="text-align: center;">0.7000</td>
<td style="text-align: center;">-1.7500 + 1.7854i</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.3979</td>
<td style="text-align: center;">0.7000</td>
<td style="text-align: center;">-1.7500 - 1.7854i</td>
</tr>
</tbody>
</table>
<p><img src="https://www.nishantkb.info/Control Systems/Linearized_LTI_Modeling_Feedback_Control_media/figure_3.png" alt="figure_3.png" width="604"></p>
<pre class="textoutput"><code>Design Case 3: Performance Metrics </code></pre>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 30%">
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">outputNames</th>
<th style="text-align: center;">TransientTime</th>
<th style="text-align: center;">Max</th>
<th style="text-align: center;">Min</th>
<th style="text-align: center;">outputUnits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">‘X Position’</td>
<td style="text-align: center;">1.7176</td>
<td style="text-align: center;">0.0447</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">‘Y Position’</td>
<td style="text-align: center;">1.7270</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-0.0573</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">‘Angular Position’</td>
<td style="text-align: center;">2.5860</td>
<td style="text-align: center;">0.5000</td>
<td style="text-align: center;">-0.0436</td>
<td style="text-align: center;">‘rad’</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">‘Varitional Force 1’</td>
<td style="text-align: center;">1.4681</td>
<td style="text-align: center;">4.0556</td>
<td style="text-align: center;">-47.1059</td>
<td style="text-align: center;">‘N’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">‘Varitional Force 2’</td>
<td style="text-align: center;">2.6781</td>
<td style="text-align: center;">1.8044</td>
<td style="text-align: center;">-8.9311</td>
<td style="text-align: center;">‘N’</td>
</tr>
</tbody>
</table>
<pre class="textoutput"><code> Design Case 4: Poles with same damping ratio and varying natural frequencies </code></pre>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Natural&nbsp;Freq&nbsp;(Hz)</th>
<th style="text-align: center;">Damping&nbsp;Ratio</th>
<th style="text-align: center;">Poles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.3183</td>
<td style="text-align: center;">0.6500</td>
<td style="text-align: center;">-1.3000 + 1.5199i</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.3183</td>
<td style="text-align: center;">0.6500</td>
<td style="text-align: center;">-1.3000 - 1.5199i</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.3979</td>
<td style="text-align: center;">0.6500</td>
<td style="text-align: center;">-1.6250 + 1.8998i</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.3979</td>
<td style="text-align: center;">0.6500</td>
<td style="text-align: center;">-1.6250 - 1.8998i</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.4775</td>
<td style="text-align: center;">0.6500</td>
<td style="text-align: center;">-1.9500 + 2.2798i</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.4775</td>
<td style="text-align: center;">0.6500</td>
<td style="text-align: center;">-1.9500 - 2.2798i</td>
</tr>
</tbody>
</table>
<p><img src="https://www.nishantkb.info/Control Systems/Linearized_LTI_Modeling_Feedback_Control_media/figure_4.png" alt="figure_4.png" width="604"></p>
<pre class="textoutput"><code>Design Case 4: Performance Metrics </code></pre>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 30%">
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">outputNames</th>
<th style="text-align: center;">TransientTime</th>
<th style="text-align: center;">Max</th>
<th style="text-align: center;">Min</th>
<th style="text-align: center;">outputUnits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">‘X Position’</td>
<td style="text-align: center;">2.5867</td>
<td style="text-align: center;">0.1215</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">‘Y Position’</td>
<td style="text-align: center;">1.9147</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-0.0994</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">‘Angular Position’</td>
<td style="text-align: center;">2.6082</td>
<td style="text-align: center;">0.5000</td>
<td style="text-align: center;">-0.0454</td>
<td style="text-align: center;">‘rad’</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">‘Varitional Force 1’</td>
<td style="text-align: center;">1.4231</td>
<td style="text-align: center;">5.7033</td>
<td style="text-align: center;">-55.2240</td>
<td style="text-align: center;">‘N’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">‘Varitional Force 2’</td>
<td style="text-align: center;">2.4931</td>
<td style="text-align: center;">3.3209</td>
<td style="text-align: center;">-11.9674</td>
<td style="text-align: center;">‘N’</td>
</tr>
</tbody>
</table>
<pre class="textoutput"><code> Design Case 5: Poles with same imaginary part and linearly spaced real part </code></pre>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Natural&nbsp;Freq&nbsp;(Hz)</th>
<th style="text-align: center;">Damping&nbsp;Ratio</th>
<th style="text-align: center;">Poles</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0.3277</td>
<td style="text-align: center;">0.8742</td>
<td style="text-align: center;">-1.8000 + 1.0000i</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.3277</td>
<td style="text-align: center;">0.8742</td>
<td style="text-align: center;">-1.8000 - 1.0000i</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0.3559</td>
<td style="text-align: center;">0.8944</td>
<td style="text-align: center;">-2.0000 + 1.0000i</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.3559</td>
<td style="text-align: center;">0.8944</td>
<td style="text-align: center;">-2.0000 - 1.0000i</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">0.3846</td>
<td style="text-align: center;">0.9104</td>
<td style="text-align: center;">-2.2000 + 1.0000i</td>
</tr>
<tr class="even">
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.3846</td>
<td style="text-align: center;">0.9104</td>
<td style="text-align: center;">-2.2000 - 1.0000i</td>
</tr>
</tbody>
</table>
<p><img src="https://www.nishantkb.info/Control Systems/Linearized_LTI_Modeling_Feedback_Control_media/figure_5.png" alt="figure_5.png" width="604"></p>
<pre class="textoutput"><code>Design Case 5: Performance Metrics </code></pre>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 30%">
<col style="width: 20%">
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">outputNames</th>
<th style="text-align: center;">TransientTime</th>
<th style="text-align: center;">Max</th>
<th style="text-align: center;">Min</th>
<th style="text-align: center;">outputUnits</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">‘X Position’</td>
<td style="text-align: center;">2.5293</td>
<td style="text-align: center;">0.0013</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">‘Y Position’</td>
<td style="text-align: center;">2.3318</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-0.0640</td>
<td style="text-align: center;">‘m’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">‘Angular Position’</td>
<td style="text-align: center;">1.6071</td>
<td style="text-align: center;">0.5000</td>
<td style="text-align: center;">-0.0295</td>
<td style="text-align: center;">‘rad’</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">‘Varitional Force 1’</td>
<td style="text-align: center;">0.7877</td>
<td style="text-align: center;">1.2177</td>
<td style="text-align: center;">-36.4021</td>
<td style="text-align: center;">‘N’</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">‘Varitional Force 2’</td>
<td style="text-align: center;">2.9893</td>
<td style="text-align: center;">8.6989</td>
<td style="text-align: center;">-9.5865</td>
<td style="text-align: center;">‘N’</td>
</tr>
</tbody>
</table>


<!-- -->

</section>

<a onclick="window.scrollTo(0, 0); return false;" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a> ]]></description>
  <category>Control</category>
  <guid>https://www.nishantkb.info/Control Systems/Linearized_LTI_Modeling_Feedback_Control.html</guid>
  <pubDate>Mon, 12 Feb 2024 04:14:57 GMT</pubDate>
  <media:content url="https://www.nishantkb.info/Control Systems/Drone_gif.gif" medium="image" type="image/gif"/>
</item>
</channel>
</rss>
